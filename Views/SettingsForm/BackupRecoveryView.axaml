<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:MTM_WIP_Application_Avalonia.ViewModels.SettingsForm"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
             x:Class="MTM_WIP_Application_Avalonia.Views.SettingsForm.BackupRecoveryView"
             x:DataType="vm:BackupRecoveryViewModel">

    <!-- Backup &amp; Recovery Panel -->
    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
        <StackPanel Spacing="16">
            
            <!-- Header Section -->
            <Border Background="#2196F3"
                    CornerRadius="8"
                    Padding="16">
                <StackPanel>
                    <TextBlock Text="💾 Backup &amp; Recovery"
                               FontSize="20"
                               FontWeight="Bold"
                               Foreground="#FFFFFF"
                               HorizontalAlignment="Center"/>
                    <TextBlock Text="Protect your data with automated backups and recovery options"
                               FontSize="14"
                               Foreground="#FFFFFF"
                               HorizontalAlignment="Center"
                               Margin="0,4,0,0"/>
                </StackPanel>
            </Border>

            <!-- Quick Actions Section -->
            <Border Background="#FFFFFF"
                    BorderBrush="#E0E0E0"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                
                <Grid RowDefinitions="Auto,Auto">
                    <TextBlock Grid.Row="0"
                               Text="⚡ Quick Actions"
                               FontSize="16"
                               FontWeight="SemiBold"
                               Foreground="#212121"
                               Margin="0,0,0,16"/>
                    
                    <UniformGrid Grid.Row="1" Columns="2" Rows="2">
                        <!-- Create Backup -->
                        <Button Grid.Column="0" Grid.Row="0"
                                Classes="mtm-primary"
                                Command="{Binding CreateBackupCommand}"
                                IsEnabled="{Binding !IsBackupInProgress}"
                                Height="60"
                                Margin="4">
                            <StackPanel Spacing="4">
                                <TextBlock Text="💾" FontSize="20" HorizontalAlignment="Center"/>
                                <TextBlock Text="Create Backup" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        
                        <!-- Restore Backup -->
                        <Button Grid.Column="1" Grid.Row="0"
                                Classes="mtm-secondary"
                                Command="{Binding RestoreBackupCommand}"
                                IsEnabled="{Binding !IsBackupInProgress}"
                                Height="60"
                                Margin="4">
                            <StackPanel Spacing="4">
                                <TextBlock Text="🔄" FontSize="20" HorizontalAlignment="Center"/>
                                <TextBlock Text="Restore Backup" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        
                        <!-- Export Settings -->
                        <Button Grid.Column="0" Grid.Row="1"
                                Classes="mtm-secondary"
                                Command="{Binding ExportSettingsCommand}"
                                IsEnabled="{Binding !IsBackupInProgress}"
                                Height="60"
                                Margin="4">
                            <StackPanel Spacing="4">
                                <TextBlock Text="📤" FontSize="20" HorizontalAlignment="Center"/>
                                <TextBlock Text="Export Settings" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        
                        <!-- Import Settings -->
                        <Button Grid.Column="1" Grid.Row="1"
                                Classes="mtm-secondary"
                                Command="{Binding ImportSettingsCommand}"
                                IsEnabled="{Binding !IsBackupInProgress}"
                                Height="60"
                                Margin="4">
                            <StackPanel Spacing="4">
                                <TextBlock Text="📥" FontSize="20" HorizontalAlignment="Center"/>
                                <TextBlock Text="Import Settings" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                    </UniformGrid>
                </Grid>
            </Border>

            <!-- Backup Status -->
            <Border Background="#FFFFFF"
                    BorderBrush="#E0E0E0"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                
                <Grid RowDefinitions="Auto,Auto,Auto">
                    <TextBlock Grid.Row="0"
                               Text="📊 Backup Status"
                               FontSize="16"
                               FontWeight="SemiBold"
                               Foreground="#212121"
                               Margin="0,0,0,12"/>
                    
                    <Grid Grid.Row="1" ColumnDefinitions="*,*" Margin="0,0,0,12">
                        <StackPanel Grid.Column="0" Spacing="4">
                            <TextBlock Text="🕒 Last Backup"
                                       FontWeight="SemiBold"
                                       Foreground="#424242"/>
                            <TextBlock Text="{Binding LastBackupDate}"
                                       FontSize="14"
                                       Foreground="#212121"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="1" Spacing="4">
                            <TextBlock Text="📍 Backup Location"
                                       FontWeight="SemiBold"
                                       Foreground="#424242"/>
                            <TextBox Text="{Binding BackupLocation}"
                                     IsReadOnly="False"
                                     FontSize="12"
                                     FontFamily="Consolas,Courier New"/>
                        </StackPanel>
                    </Grid>
                    
                    <!-- Status Message -->
                    <TextBlock Grid.Row="2"
                               Text="{Binding BackupStatus}"
                               FontSize="14"
                               Foreground="#2196F3"
                               FontWeight="SemiBold"/>
                </Grid>
            </Border>

            <!-- Backup Configuration -->
            <Border Background="#FFFFFF"
                    BorderBrush="#E0E0E0"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                
                <Grid RowDefinitions="Auto,Auto">
                    <TextBlock Grid.Row="0"
                               Text="⚙️ Backup Configuration"
                               FontSize="16"
                               FontWeight="SemiBold"
                               Foreground="#212121"
                               Margin="0,0,0,16"/>
                    
                    <Grid Grid.Row="1" ColumnDefinitions="*,*,Auto" RowDefinitions="Auto,Auto">
                        <!-- Auto Backup Toggle -->
                        <StackPanel Grid.Column="0" Grid.Row="0" Spacing="8">
                            <TextBlock Text="🔄 Automatic Backup"
                                       FontWeight="SemiBold"
                                       Foreground="#424242"/>
                            <CheckBox IsChecked="{Binding AutoBackupEnabled}"
                                      Content="Enable automatic backups"/>
                        </StackPanel>
                        
                        <!-- Retention Period -->
                        <StackPanel Grid.Column="1" Grid.Row="0" Spacing="8">
                            <TextBlock Text="📅 Retention Period"
                                       FontWeight="SemiBold"
                                       Foreground="#424242"/>
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <NumericUpDown Value="{Binding BackupRetentionDays}"
                                               Minimum="1"
                                               Maximum="365"
                                               Width="80"/>
                                <TextBlock Text="days" VerticalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>
                        
                        <!-- Schedule Backup Button -->
                        <Button Grid.Column="2" Grid.Row="0"
                                Content="⏰ Schedule"
                                Classes="mtm-primary"
                                Command="{Binding ScheduleBackupCommand}"
                                Height="36"
                                VerticalAlignment="Bottom"/>
                    </Grid>
                </Grid>
            </Border>

            <!-- Backup History -->
            <Border Background="#FFFFFF"
                    BorderBrush="#E0E0E0"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                
                <Grid RowDefinitions="Auto,*">
                    <TextBlock Grid.Row="0"
                               Text="📋 Backup History"
                               FontSize="16"
                               FontWeight="SemiBold"
                               Foreground="#212121"
                               Margin="0,0,0,12"/>
                    
                    <ScrollViewer Grid.Row="1" Height="200" VerticalScrollBarVisibility="Auto">
                        <ItemsControl ItemsSource="{Binding BackupHistory}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#F5F5F5"
                                            BorderBrush="#E0E0E0"
                                            BorderThickness="0,0,0,1"
                                            Padding="12,8">
                                        
                                        <Grid ColumnDefinitions="*,Auto,Auto,Auto,Auto">
                                            <!-- File Name -->
                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="{Binding FileName}"
                                                           FontWeight="SemiBold"
                                                           Foreground="#212121"/>
                                                <TextBlock Text="{Binding FormattedDate}"
                                                           FontSize="12"
                                                           Foreground="#424242"/>
                                            </StackPanel>
                                            
                                            <!-- Size -->
                                            <TextBlock Grid.Column="1"
                                                       Text="{Binding Size}"
                                                       FontSize="12"
                                                       Foreground="#424242"
                                                       VerticalAlignment="Center"
                                                       Margin="8,0"/>
                                            
                                            <!-- Type -->
                                            <Border Grid.Column="2"
                                                    Background="#2196F3"
                                                    CornerRadius="4"
                                                    Padding="6,2"
                                                    Margin="4,0">
                                                <TextBlock Text="{Binding Type}"
                                                           FontSize="10"
                                                           FontWeight="SemiBold"
                                                           Foreground="#FFFFFF"/>
                                            </Border>
                                            
                                            <!-- Status -->
                                            <Border Grid.Column="3"
                                                    Background="#4CAF50"
                                                    CornerRadius="4"
                                                    Padding="6,2"
                                                    Margin="4,0">
                                                <TextBlock Text="{Binding Status}"
                                                           FontSize="10"
                                                           FontWeight="SemiBold"
                                                           Foreground="#FFFFFF"/>
                                            </Border>
                                            
                                            <!-- Delete Button -->
                                            <Button Grid.Column="4"
                                                    Content="🗑️"
                                                    Classes="mtm-danger"
                                                    Command="{Binding $parent[ItemsControl].((vm:BackupRecoveryViewModel)DataContext).DeleteBackupCommand}"
                                                    CommandParameter="{Binding}"
                                                    Width="32"
                                                    Height="28"
                                                    Margin="8,0,0,0"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </Border>

            <!-- Scheduled Backups -->
            <Border Background="#FFFFFF"
                    BorderBrush="#E0E0E0"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                
                <Grid RowDefinitions="Auto,*">
                    <TextBlock Grid.Row="0"
                               Text="⏰ Scheduled Backups"
                               FontSize="16"
                               FontWeight="SemiBold"
                               Foreground="#212121"
                               Margin="0,0,0,12"/>
                    
                    <ItemsControl Grid.Row="1" ItemsSource="{Binding ScheduledBackups}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="#F5F5F5"
                                        BorderBrush="#E0E0E0"
                                        BorderThickness="1"
                                        CornerRadius="6"
                                        Padding="12"
                                        Margin="0,4">
                                    
                                    <Grid ColumnDefinitions="Auto,*,Auto,Auto">
                                        <!-- Enabled Toggle -->
                                        <CheckBox Grid.Column="0"
                                                  IsChecked="{Binding IsEnabled}"
                                                  VerticalAlignment="Center"
                                                  Margin="0,0,12,0"/>
                                        
                                        <!-- Schedule Info -->
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="{Binding Name}"
                                                       FontWeight="SemiBold"
                                                       Foreground="#212121"/>
                                            <TextBlock Text="{Binding Schedule}"
                                                       FontSize="12"
                                                       Foreground="#424242"/>
                                        </StackPanel>
                                        
                                        <!-- Next Run -->
                                        <StackPanel Grid.Column="2" HorizontalAlignment="Right" Margin="8,0">
                                            <TextBlock Text="Next Run:"
                                                       FontSize="10"
                                                       Foreground="#424242"/>
                                            <TextBlock Text="{Binding FormattedNextRun}"
                                                       FontSize="12"
                                                       FontWeight="SemiBold"
                                                       Foreground="#2196F3"/>
                                        </StackPanel>
                                        
                                        <!-- Type Badge -->
                                        <Border Grid.Column="3"
                                                Background="#757575"
                                                CornerRadius="4"
                                                Padding="6,4"
                                                Margin="8,0,0,0">
                                            <TextBlock Text="{Binding Type}"
                                                       FontSize="10"
                                                       FontWeight="SemiBold"
                                                       Foreground="#FFFFFF"/>
                                        </Border>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Grid>
            </Border>

            <!-- Loading Indicator -->
            <Border Background="#FF9800"
                    CornerRadius="8"
                    Padding="12"
                    IsVisible="{Binding IsBackupInProgress}">
                
                <StackPanel Orientation="Horizontal" 
                            Spacing="12"
                            HorizontalAlignment="Center">
                    <ProgressBar IsIndeterminate="True"
                                 Width="120"
                                 Height="6"/>
                    <TextBlock Text="Processing backup operation..."
                               Foreground="#FFFFFF"
                               FontWeight="SemiBold"/>
                </StackPanel>
            </Border>

        </StackPanel>
    </ScrollViewer>

</UserControl>