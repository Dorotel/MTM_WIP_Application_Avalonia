<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:MTM_WIP_Application_Avalonia.ViewModels.MainForm"
             xmlns:materialIcons="using:Material.Icons.Avalonia"
             xmlns:i="using:Avalonia.Xaml.Interactivity"
             xmlns:controls="using:MTM_WIP_Application_Avalonia.Controls"
             mc:Ignorable="d"
             d:DesignWidth="800"
             d:DesignHeight="600"
             x:Class="MTM_WIP_Application_Avalonia.Views.TransferTabView"
             x:CompileBindings="True"
             x:DataType="vm:TransferItemViewModel">

  <UserControl.Resources>
    <!-- Resources are now provided by DynamicResource bindings from MTM_Amber.axaml -->
  </UserControl.Resources>

  <UserControl.Styles>
    <!-- MTM Amber Theme Input Field Styles -->
    <Style Selector="TextBox.input-field">
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.BorderDarkBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="4"/>
      <Setter Property="Padding" Value="8,6"/>
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"/>
      <Setter Property="Foreground" Value="{DynamicResource MTM_Shared_Logic.BodyText}"/>
      <Setter Property="FontSize" Value="11"/>
      <Setter Property="MinHeight" Value="28"/>
      <Setter Property="Margin" Value="3"/>
    </Style>

    <Style Selector="TextBox.input-field:focus">
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.FocusBrush}"/>
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.HoverBackground}"/>
    </Style>

    <!-- Validation error styles -->
    <Style Selector="TextBox.validation-error">
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.ErrorBrush}"/>
      <Setter Property="BorderThickness" Value="2"/>
    </Style>

    <Style Selector="NumericUpDown.validation-error">
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.ErrorBrush}"/>
      <Setter Property="BorderThickness" Value="2"/>
    </Style>

    <Style Selector="NumericUpDown.input-field">
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.BorderDarkBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="4"/>
      <Setter Property="Padding" Value="8,6"/>
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"/>
      <Setter Property="Foreground" Value="{DynamicResource MTM_Shared_Logic.BodyText}"/>
      <Setter Property="FontSize" Value="11"/>
      <Setter Property="MinHeight" Value="28"/>
      <Setter Property="Margin" Value="3"/>
    </Style>

    <Style Selector="NumericUpDown.input-field:focus">
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.FocusBrush}"/>
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.HoverBackground}"/>
    </Style>

    <!-- MTM Amber Theme Button Styles -->
    <Style Selector="Button.action-button">
      <Setter Property="Padding" Value="8,6"/>
      <Setter Property="Margin" Value="3"/>
      <Setter Property="FontSize" Value="11"/>
      <Setter Property="FontWeight" Value="SemiBold"/>
      <Setter Property="CornerRadius" Value="4"/>
      <Setter Property="MinHeight" Value="28"/>
      <Setter Property="Cursor" Value="Hand"/>
      <Setter Property="HorizontalContentAlignment" Value="Center"/>
      <Setter Property="VerticalContentAlignment" Value="Center"/>
      <Setter Property="BorderThickness" Value="1"/>
    </Style>
    
    <Style Selector="Button.primary">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.PrimaryAction}"/>
      <Setter Property="Foreground" Value="{DynamicResource MTM_Shared_Logic.OverlayTextBrush}"/>
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.PrimaryAction}"/>
    </Style>
    
    <Style Selector="Button.primary:pointerover">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.PrimaryHoverBrush}"/>
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.PrimaryHoverBrush}"/>
    </Style>
    
    <Style Selector="Button.primary:pressed">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.PrimaryPressedBrush}"/>
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.PrimaryPressedBrush}"/>
    </Style>

    <Style Selector="Button.secondary">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"/>
      <Setter Property="Foreground" Value="{DynamicResource MTM_Shared_Logic.InteractiveText}"/>
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.BorderDarkBrush}"/>
    </Style>
    
    <Style Selector="Button.secondary:pointerover">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.SecondaryHoverBrush}"/>
      <Setter Property="Foreground" Value="{DynamicResource MTM_Shared_Logic.OverlayTextBrush}"/>
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.SecondaryHoverBrush}"/>
    </Style>
    
    <Style Selector="Button.secondary:pressed">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.SecondaryPressedBrush}"/>
      <Setter Property="Foreground" Value="{DynamicResource MTM_Shared_Logic.OverlayTextBrush}"/>
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.SecondaryPressedBrush}"/>
    </Style>

    <Style Selector="Button.transfer">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.SuccessBrush}"/>
      <Setter Property="Foreground" Value="{DynamicResource MTM_Shared_Logic.OverlayTextBrush}"/>
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.SuccessBrush}"/>
    </Style>
    
    <Style Selector="Button.transfer:pointerover">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.SuccessDarkBrush}"/>
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.SuccessDarkBrush}"/>
    </Style>

    <!-- MTM DataGrid styling -->
    <Style Selector="DataGrid">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"/>
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.BorderAccentBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="4"/>
      <Setter Property="GridLinesVisibility" Value="Horizontal"/>
      <Setter Property="HeadersVisibility" Value="Column"/>
      <Setter Property="CanUserReorderColumns" Value="True"/>
      <Setter Property="CanUserResizeColumns" Value="True"/>
      <Setter Property="CanUserSortColumns" Value="True"/>
      <Setter Property="IsReadOnly" Value="True"/>
      <Setter Property="SelectionMode" Value="Single"/>
      <Setter Property="Foreground" Value="{DynamicResource MTM_Shared_Logic.BodyText}"/>
    </Style>

    <Style Selector="DataGridColumnHeader">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.PanelBackgroundBrush}"/>
      <Setter Property="Foreground" Value="{DynamicResource MTM_Shared_Logic.HeadingText}"/>
      <Setter Property="FontWeight" Value="SemiBold"/>
    </Style>

    <Style Selector="DataGridRow:selected">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.SelectionBrush}"/>
    </Style>

    <Style Selector="DataGridRow:pointerover">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.HoverBackground}"/>
    </Style>

    <!-- Header panel styling -->
    <Style Selector="Border.header-panel">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.SidebarGradientBrush}"/>
      <Setter Property="CornerRadius" Value="4"/>
    </Style>

    <!-- Transfer criteria panel styling -->
    <Style Selector="Border.transfer-panel">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.PanelBackgroundBrush}"/>
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.BorderAccentBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="6"/>
    </Style>

    <!-- Vertical header bar styling -->
    <Style Selector="Border.vertical-header">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.PrimaryGradientBrush}"/>
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.BorderDarkBrush}"/>
      <Setter Property="CornerRadius" Value="6,0,0,6"/>
    </Style>
  </UserControl.Styles>

  <!-- Main Layout Container - ScrollViewer for overflow handling -->
  <ScrollViewer HorizontalScrollBarVisibility="Auto"
                VerticalScrollBarVisibility="Auto"
                Background="{DynamicResource MTM_Shared_Logic.MainBackground}">
    
    <Grid x:Name="MainContainer" 
          RowDefinitions="*,Auto"
          MinWidth="600"
          MinHeight="400"
          Margin="8">

      <!-- Main Content Panel -->
      <Border Grid.Row="0"
              Background="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"
              BorderBrush="{DynamicResource MTM_Shared_Logic.BorderLightBrush}"
              BorderThickness="1"
              CornerRadius="8"
              Padding="16"
              Margin="0,0,0,8">
        
        <Grid RowDefinitions="Auto,*">
          
          <!-- Transfer Configuration Panel with CollapsiblePanel -->
          <controls:CollapsiblePanel Grid.Row="0"
                                    x:Name="TransferConfigPanel"
                                    Header="Transfer Configuration"
                                    IsExpanded="True"
                                    Margin="0,0,0,16">
            
            <Grid ColumnDefinitions="*,*" ColumnSpacing="16" Margin="16">
              
              <!-- Left Column: Source Selection -->
              <StackPanel Grid.Column="0" Spacing="12">
                
                <TextBlock Text="Source Selection" 
                          FontSize="14" 
                          FontWeight="SemiBold" 
                          Foreground="{DynamicResource MTM_Shared_Logic.HeadingText}"
                          Margin="0,0,0,8"/>
                
                <!-- Part ID Field -->
                <Grid ColumnDefinitions="80,*" ColumnSpacing="8">
                  <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="4" VerticalAlignment="Center">
                    <materialIcons:MaterialIcon Kind="Identifier" Width="14" Height="14" 
                                              Foreground="{DynamicResource MTM_Shared_Logic.InteractiveText}" />
                    <TextBlock Text="Part ID:" FontSize="12" FontWeight="Medium" 
                              Foreground="{DynamicResource MTM_Shared_Logic.HeadingText}" VerticalAlignment="Center" />
                  </StackPanel>
                  <TextBox Grid.Column="1" 
                          x:Name="PartTextBox"
                          Text="{Binding PartText, Mode=TwoWay}"
                          Classes="input-field"
                          Watermark="Enter part ID..."
                          ToolTip.Tip="Enter or select part ID for transfer source"
                          TabIndex="1" />
                </Grid>

                <!-- Operation Field -->
                <Grid ColumnDefinitions="80,*" ColumnSpacing="8">
                  <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="4" VerticalAlignment="Center">
                    <materialIcons:MaterialIcon Kind="Cog" Width="14" Height="14" 
                                              Foreground="{DynamicResource MTM_Shared_Logic.InteractiveText}" />
                    <TextBlock Text="Operation:" FontSize="12" FontWeight="Medium" 
                              Foreground="{DynamicResource MTM_Shared_Logic.HeadingText}" VerticalAlignment="Center" />
                  </StackPanel>
                  <TextBox Grid.Column="1" 
                          x:Name="OperationTextBox"
                          Text="{Binding OperationText, Mode=TwoWay}"
                          Classes="input-field"
                          Watermark="Enter operation..."
                          ToolTip.Tip="Enter or select operation number (optional filter)"
                          TabIndex="2" />
                </Grid>
                
              </StackPanel>
              
              <!-- Right Column: Destination Configuration -->
              <StackPanel Grid.Column="1" Spacing="12">
                
                <TextBlock Text="Destination Configuration" 
                          FontSize="14" 
                          FontWeight="SemiBold" 
                          Foreground="{DynamicResource MTM_Shared_Logic.HeadingText}"
                          Margin="0,0,0,8"/>
                
                <!-- To Location Field -->
                <Grid ColumnDefinitions="80,*" ColumnSpacing="8">
                  <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="4" VerticalAlignment="Center">
                    <materialIcons:MaterialIcon Kind="MapMarkerRadius" Width="14" Height="14" 
                                              Foreground="{DynamicResource MTM_Shared_Logic.InteractiveText}" />
                    <TextBlock Text="To Location:" FontSize="12" FontWeight="Medium" 
                              Foreground="{DynamicResource MTM_Shared_Logic.HeadingText}" VerticalAlignment="Center" />
                  </StackPanel>
                  <TextBox Grid.Column="1" 
                          x:Name="ToLocationTextBox"
                          Text="{Binding ToLocationText, Mode=TwoWay}"
                          Classes="input-field"
                          Classes.validation-error="{Binding HasLocationValidationError}"
                          Watermark="Select destination..."
                          ToolTip.Tip="Enter or select destination location"
                          TabIndex="3" />
                </Grid>

                <!-- Transfer Quantity Field -->
                <Grid ColumnDefinitions="80,*,Auto" ColumnSpacing="8">
                  <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="4" VerticalAlignment="Center">
                    <materialIcons:MaterialIcon Kind="Counter" Width="14" Height="14" 
                                              Foreground="{DynamicResource MTM_Shared_Logic.InteractiveText}" />
                    <TextBlock Text="Quantity:" FontSize="12" FontWeight="Medium" 
                              Foreground="{DynamicResource MTM_Shared_Logic.HeadingText}" VerticalAlignment="Center" />
                  </StackPanel>
                  <NumericUpDown Grid.Column="1"
                                Value="{Binding TransferQuantity, Mode=TwoWay}"
                                Minimum="1"
                                Maximum="{Binding MaxTransferQuantity}"
                                Classes="input-field"
                                Classes.validation-error="{Binding HasQuantityValidationError}"
                                ToolTip.Tip="Quantity to transfer"
                                TabIndex="4" />
                  <Border Grid.Column="2"
                          Background="{DynamicResource MTM_Shared_Logic.InteractiveText}"
                          CornerRadius="4"
                          Padding="6,2"
                          VerticalAlignment="Center"
                          Margin="6,0,0,0">
                    <TextBlock Text="{Binding MaxTransferQuantity, StringFormat='Max: {0}'}"
                              FontSize="10"
                              FontWeight="SemiBold"
                              Foreground="{DynamicResource MTM_Shared_Logic.OverlayTextBrush}"
                              ToolTip.Tip="Maximum available quantity" />
                  </Border>
                </Grid>
                
              </StackPanel>
              
            </Grid>
            
          </controls:CollapsiblePanel>
          
          <!-- DataGrid for Available Inventory -->
          <Border Grid.Row="1"
                  Background="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"
                  BorderBrush="{DynamicResource MTM_Shared_Logic.BorderAccentBrush}"
                  BorderThickness="1"
                  CornerRadius="6"
                  Padding="8">
            
            <Grid RowDefinitions="Auto,*">
              
              <!-- DataGrid Header -->
              <Border Grid.Row="0" 
                      Background="{DynamicResource MTM_Shared_Logic.SidebarGradientBrush}"
                      CornerRadius="4"
                      Padding="12,8"
                      Margin="0,0,0,8">
                <Grid ColumnDefinitions="Auto,*,Auto">
                  <materialIcons:MaterialIcon Grid.Column="0"
                                            Kind="ViewList"
                                            Width="16"
                                            Height="16"
                                            Foreground="{DynamicResource MTM_Shared_Logic.OverlayTextBrush}"
                                            VerticalAlignment="Center"
                                            Margin="0,0,8,0" />
                  <TextBlock Grid.Column="1"
                            Text="Available Inventory for Transfer"
                            FontSize="14"
                            FontWeight="Bold"
                            Foreground="{DynamicResource MTM_Shared_Logic.OverlayTextBrush}"
                            VerticalAlignment="Center" />
                  <Border Grid.Column="2"
                          Background="{DynamicResource MTM_Shared_Logic.OverlayTextBrush}"
                          CornerRadius="8"
                          Padding="8,4">
                    <StackPanel Orientation="Horizontal" Spacing="6">
                      <TextBlock Text="{Binding InventoryItems.Count}"
                                FontSize="12"
                                FontWeight="Bold"
                                Foreground="{DynamicResource MTM_Shared_Logic.PrimaryAction}"
                                VerticalAlignment="Center" />
                      <TextBlock Text="items"
                                FontSize="11"
                                Foreground="{DynamicResource MTM_Shared_Logic.BodyText}"
                                VerticalAlignment="Center" />
                    </StackPanel>
                  </Border>
                </Grid>
              </Border>
              
              <!-- DataGrid -->
              <Grid Grid.Row="1">
                <!-- Loading Overlay -->
                <Border Background="#80000000" 
                        CornerRadius="6"
                        IsVisible="{Binding IsLoading}"
                        ZIndex="10">
                  <StackPanel HorizontalAlignment="Center" 
                              VerticalAlignment="Center" 
                              Spacing="12">
                    <ProgressBar IsIndeterminate="True" 
                                Width="200" 
                                Height="4" 
                                Foreground="{DynamicResource MTM_Shared_Logic.PrimaryAction}"
                                Background="Transparent"/>
                    <TextBlock Text="Loading inventory data..." 
                              FontSize="14"
                              FontWeight="Medium"
                              Foreground="White"
                              HorizontalAlignment="Center"/>
                  </StackPanel>
                </Border>

                <!-- Nothing Found Indicator -->
                <Border Background="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"
                        BorderBrush="{DynamicResource MTM_Shared_Logic.BorderAccentBrush}"
                        BorderThickness="1"
                        CornerRadius="6"
                        Padding="40"
                        IsVisible="{Binding ShowNothingFoundIndicator}"
                        ZIndex="5">
                  <StackPanel HorizontalAlignment="Center" 
                              VerticalAlignment="Center" 
                              Spacing="16">
                    <materialIcons:MaterialIcon Kind="FileFind" 
                                              Width="48" 
                                              Height="48" 
                                              Foreground="{DynamicResource MTM_Shared_Logic.TertiaryTextBrush}"/>
                    <TextBlock Text="Nothing Found" 
                              FontSize="18"
                              FontWeight="SemiBold"
                              Foreground="{DynamicResource MTM_Shared_Logic.HeadingText}"
                              HorizontalAlignment="Center"/>
                    <TextBlock Text="No transfer candidates match your search criteria." 
                              FontSize="12"
                              Foreground="{DynamicResource MTM_Shared_Logic.BodyText}"
                              HorizontalAlignment="Center"
                              TextWrapping="Wrap"
                              MaxWidth="300"/>
                    <StackPanel Orientation="Horizontal" 
                                Spacing="8" 
                                HorizontalAlignment="Center"
                                Margin="0,8,0,0">
                      <Button Content="Reset Search" 
                              Classes="action-button secondary"
                              Command="{Binding ResetCommand}"
                              ToolTip.Tip="Clear search criteria and reset form"
                              Padding="12,6"/>
                      <Button Content="Modify Criteria" 
                              Classes="action-button primary"
                              Command="{Binding ExpandPanelCommand}"
                              ToolTip.Tip="Expand search panel to modify criteria"
                              Padding="12,6"/>
                    </StackPanel>
                  </StackPanel>
                </Border>

                <!-- DataGrid -->
                <DataGrid x:Name="InventoryDataGrid"
                          ItemsSource="{Binding InventoryItems}"
                          SelectedItem="{Binding SelectedInventoryItem, Mode=TwoWay}"
                          AutoGenerateColumns="False"
                          CanUserReorderColumns="True"
                          CanUserResizeColumns="True"
                          CanUserSortColumns="True"
                          IsReadOnly="True"
                          SelectionMode="Extended"
                          GridLinesVisibility="Horizontal"
                          HeadersVisibility="Column"
                          FontSize="11"
                          RowHeight="28"
                          ToolTip.Tip="Select inventory items for transfer. Use Ctrl+Click for multiple selection"
                          IsVisible="{Binding HasInventoryItems}">
                  <DataGrid.Columns>
                    <DataGridTextColumn Header="Location" Binding="{Binding Location}" Width="100" />
                    <DataGridTextColumn Header="Part ID" Binding="{Binding PartId}" Width="120" />
                    <DataGridTextColumn Header="Operation" Binding="{Binding Operation}" Width="80" />
                    <DataGridTextColumn Header="Available Qty" Binding="{Binding Quantity}" Width="100" />
                    <DataGridTextColumn Header="Notes" Binding="{Binding Notes}" Width="*" />
                    <DataGridTextColumn Header="Last Updated" Binding="{Binding LastUpdated, StringFormat='MM/dd/yy HH:mm'}" Width="120" />
                  </DataGrid.Columns>
                </DataGrid>
              </Grid>
              
            </Grid>
          </Border>
          
        </Grid>
      </Border>

      <!-- Action Buttons Panel -->
      <Border Grid.Row="1"
              Background="{DynamicResource MTM_Shared_Logic.PanelBackgroundBrush}"
              BorderBrush="{DynamicResource MTM_Shared_Logic.BorderAccentBrush}"
              BorderThickness="1"
              CornerRadius="6"
              Padding="12"
              Margin="0,0,0,8">
        <Grid ColumnDefinitions="*,Auto">
          
          <!-- Left side buttons -->
          <StackPanel Grid.Column="0" 
                      Orientation="Horizontal" 
                      HorizontalAlignment="Left" 
                      Spacing="8">
            
            <!-- Search Button - Auto-collapse panel on search -->
            <Button x:Name="SearchButton"
                    Classes="action-button primary"
                    Width="80" 
                    Height="32"
                    Command="{Binding SearchCommand}"
                    ToolTip.Tip="Search inventory (F5)"
                    TabIndex="5">
              <StackPanel Orientation="Horizontal" Spacing="6"
                          HorizontalAlignment="Center" VerticalAlignment="Center">
                <materialIcons:MaterialIcon Kind="Magnify" Width="14" Height="14"/>
                <TextBlock Text="Search" FontSize="11" FontWeight="SemiBold"/>
              </StackPanel>
            </Button>
            
            <!-- Transfer Button -->
            <Button x:Name="TransferButton"
                    Classes="action-button transfer"
                    Width="90" 
                    Height="32"
                    Command="{Binding TransferCommand}"
                    IsEnabled="{Binding CanTransfer}"
                    ToolTip.Tip="Execute transfer (Enter)"
                    TabIndex="6">
              <StackPanel Orientation="Horizontal" Spacing="6"
                          HorizontalAlignment="Center" VerticalAlignment="Center">
                <materialIcons:MaterialIcon Kind="ArrowRightBold" Width="14" Height="14"/>
                <TextBlock Text="Transfer" FontSize="11" FontWeight="SemiBold"/>
              </StackPanel>
            </Button>
            
            <!-- Reset Button - Auto-expand panel on reset -->
            <Button x:Name="ResetButton"
                    Classes="action-button secondary"
                    Width="70" 
                    Height="32"
                    Command="{Binding ResetCommand}"
                    ToolTip.Tip="Reset form (Escape)"
                    TabIndex="7">
              <StackPanel Orientation="Horizontal" Spacing="6"
                          HorizontalAlignment="Center" VerticalAlignment="Center">
                <materialIcons:MaterialIcon Kind="Refresh" Width="14" Height="14"/>
                <TextBlock Text="Reset" FontSize="11"/>
              </StackPanel>
            </Button>
            
            <!-- Print Button -->
            <Button x:Name="PrintButton"
                    Classes="action-button secondary"
                    Width="70" 
                    Height="32"
                    Command="{Binding PrintCommand}"
                    ToolTip.Tip="Print report (Ctrl+P)"
                    TabIndex="8">
              <StackPanel Orientation="Horizontal" Spacing="6"
                          HorizontalAlignment="Center" VerticalAlignment="Center">
                <materialIcons:MaterialIcon Kind="Printer" Width="14" Height="14"/>
                <TextBlock Text="Print" FontSize="11"/>
              </StackPanel>
            </Button>
            
          </StackPanel>

          <!-- Right side - QuickButtons toggle -->
          <Button Grid.Column="1"
                  x:Name="TogglePanelButton"
                  Classes="action-button secondary"
                  Width="32" 
                  Height="32"
                  Command="{Binding TogglePanelCommand}"
                  ToolTip.Tip="Toggle QuickButtons panel">
            <materialIcons:MaterialIcon Kind="DotsVertical" Width="14" Height="14"/>
          </Button>
          
        </Grid>
      </Border>

    </Grid>
  </ScrollViewer>
</UserControl>
