<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:MTM_WIP_Application_Avalonia.ViewModels.MainForm"
             xmlns:materialIcons="using:Material.Icons.Avalonia"
             xmlns:controls="using:MTM_WIP_Application_Avalonia.Controls"
             mc:Ignorable="d"
             d:DesignWidth="800"
             d:DesignHeight="600"
             x:Class="MTM_WIP_Application_Avalonia.Views.InventoryTabView"
             x:CompileBindings="True"
             x:DataType="vm:InventoryTabViewModel">

  <!-- ================================================================================================= -->
  <!-- MASTER CONTAINER - Root layout for seamless MainView integration -->
  <!-- ================================================================================================= -->
  <Border x:Name="MasterContainer"
          Background="Transparent"
          BorderThickness="0"
          CornerRadius="0"
          Padding="8"
          HorizontalAlignment="Stretch"
          VerticalAlignment="Stretch"
          ClipToBounds="True">

    <!-- ================================================================================================= -->
    <!-- MAIN GRID LAYOUT - Content area + Action buttons separation -->
    <!-- ================================================================================================= -->
    <Grid x:Name="MainContainer"
          RowDefinitions="*,Auto"
          Background="Transparent"
          HorizontalAlignment="Stretch"
          VerticalAlignment="Stretch"
          ClipToBounds="True">

      <!-- ============================================================================================= -->
      <!-- CONTENT AREA - Form fields container using StyleSystem Card class -->
      <!-- ============================================================================================= -->
    <Border Grid.Row="0"
          Classes="Card"
          Padding="16"
          Margin="0,4,0,4"
          HorizontalAlignment="Stretch"
          VerticalAlignment="Stretch">

        <!-- ========================================================================================= -->
        <!-- FORM FIELDS GRID - 5-row layout with proper spacing -->
        <!-- ========================================================================================= -->
        <Grid Classes="ManufacturingForm"
            RowDefinitions="Auto,12,Auto,12,Auto,12,100*"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch">

        <!-- ========================================================================================= -->
        <!-- ROW 0: FORM TITLE SECTION - Manufacturing header with icon -->
        <!-- ========================================================================================= -->
        <StackPanel Grid.Row="0" Classes="ManufacturingFormTitle" Margin="0">
        <Border Classes="ManufacturingTitleIcon" Margin="0">
          <materialIcons:MaterialIcon Kind="Package" Classes="ManufacturingTitleIcon"/>
        </Border>
        <TextBlock Classes="ManufacturingFormTitle" Margin="0" Text="Add Inventory Item"/>
        </StackPanel>

        <!-- ROW 1: Space -->

        <!-- =================================================================================== -->
        <!-- ROW 2: PART ID + OPERATION FIELDS - Two column layout -->
        <!-- =================================================================================== -->
        <Grid Grid.Row="2" Classes="ManufacturingTwoColumn" ColumnDefinitions="1*,6,1*">

          <!-- Part ID Field -->
          <Border Grid.Column="0" Classes="ManufacturingField" Tapped="FocusPartTextBox">
            <StackPanel Classes="ManufacturingFieldContent">
            <StackPanel Classes="ManufacturingFieldHeader">
              <materialIcons:MaterialIcon Kind="Identifier" Classes="ManufacturingFieldIcon"/>
              <TextBlock Classes="ManufacturingFieldLabel" Text="Part ID *"/>
            </StackPanel>
            <TextBox x:Name="PartTextBox"
                   Classes="ManufacturingInput"
                   Text="{Binding SelectedPart, Mode=TwoWay}"
                   Watermark="{Binding PartWatermark}"
                   ToolTip.Tip="Select or enter a part number"
                   TabIndex="1"/>
            </StackPanel>
          </Border>

          <!-- Operation Field -->
          <Border Grid.Column="2" Classes="ManufacturingField" Tapped="FocusOperationTextBox">
            <StackPanel Classes="ManufacturingFieldContent">
            <StackPanel Classes="ManufacturingFieldHeader">
              <materialIcons:MaterialIcon Kind="Cog" Classes="ManufacturingFieldIcon"/>
              <TextBlock Classes="ManufacturingFieldLabel" Text="Operation *"/>
            </StackPanel>
            <TextBox x:Name="OperationTextBox"
                   Classes="ManufacturingInput"
                   Text="{Binding SelectedOperation, Mode=TwoWay}"
                   Watermark="{Binding OperationWatermark}"
                   ToolTip.Tip="Enter operation number (90, 100, 110)"
                   TabIndex="2"/>
            </StackPanel>
          </Border>

        </Grid>

        <!-- Row 3: 12px spacing -->

        <!-- =================================================================================== -->
        <!-- ROW 4: LOCATION + QUANTITY FIELDS - Two column layout -->
        <!-- =================================================================================== -->
        <Grid Grid.Row="4" Classes="ManufacturingTwoColumn" ColumnDefinitions="1*,6,1*">

          <!-- Location Field -->
          <Border Grid.Column="0" Classes="ManufacturingField" Tapped="FocusLocationTextBox">
            <StackPanel Classes="ManufacturingFieldContent">
            <StackPanel Classes="ManufacturingFieldHeader">
              <materialIcons:MaterialIcon Kind="MapMarker" Classes="ManufacturingFieldIcon"/>
              <TextBlock Classes="ManufacturingFieldLabel" Text="Location *"/>
            </StackPanel>
            <TextBox x:Name="LocationTextBox"
                   Classes="ManufacturingInput"
                   Text="{Binding SelectedLocation, Mode=TwoWay}"
                   Watermark="{Binding LocationWatermark}"
                   ToolTip.Tip="Enter location (FLOOR, RECEIVING, etc.)"
                   TabIndex="3"/>
            </StackPanel>
          </Border>

          <!-- Quantity Field -->
          <Border Grid.Column="2" Classes="ManufacturingField" Tapped="FocusQuantityTextBox">
            <StackPanel Classes="ManufacturingFieldContent">
            <StackPanel Classes="ManufacturingFieldHeader">
              <materialIcons:MaterialIcon Kind="Counter" Classes="ManufacturingFieldIcon"/>
              <TextBlock Classes="ManufacturingFieldLabel" Text="Quantity *"/>
            </StackPanel>
            <TextBox x:Name="QuantityTextBox"
                   Classes="ManufacturingInput"
                   Text="{Binding QuantityText, Mode=TwoWay}"
                   Watermark="{Binding QuantityWatermark}"
                   ToolTip.Tip="Enter numeric quantity"
                   TabIndex="4"/>
            </StackPanel>
          </Border>

        </Grid>

        <!-- Row 5: 12px spacing -->

        <!-- =================================================================================== -->
        <!-- ROW 6: NOTES FIELD - Full width, expandable multiline -->
        <!-- =================================================================================== -->
        <Border Grid.Row="6"
              Classes="ManufacturingField Notes"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch"
              Tapped="FocusNotesTextBox">

          <Grid Classes="ManufacturingSingleColumn" RowDefinitions="Auto,*"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch">

            <!-- Notes Label -->
            <StackPanel Grid.Row="0" Classes="ManufacturingFieldHeader">
            <materialIcons:MaterialIcon Kind="NoteText" Classes="ManufacturingFieldIcon"/>
            <TextBlock Classes="ManufacturingFieldLabel" Text="Notes (Optional)"/>
            </StackPanel>

            <!-- Notes TextBox - multiline, fills remaining space with proper containment -->
            <TextBox Grid.Row="1"
                   x:Name="NotesTextBox"
                   Classes="ManufacturingInput Notes"
                   Text="{Binding Notes, Mode=TwoWay}"
                   Watermark="{Binding NotesWatermark}"
                   ToolTip.Tip="Optional notes or comments - Press Enter for new line"
                   TabIndex="5"
                   AcceptsReturn="True"
                   TextWrapping="Wrap"
                   VerticalAlignment="Stretch"
                   HorizontalAlignment="Stretch"
                   ScrollViewer.VerticalScrollBarVisibility="Auto"
                   ScrollViewer.HorizontalScrollBarVisibility="Auto"/>
          </Grid>
        </Border>

        </Grid>

    </Border>

      <!-- ============================================================================================= -->
      <!-- ACTION BUTTONS PANEL - Bottom row with primary and secondary actions -->
      <!-- ============================================================================================= -->
      <Grid Classes="ManufacturingActions"
            ColumnDefinitions="Auto,*,Auto"
            Grid.Row="1"
            Margin="0,4,0,4">

        <!-- ========================================================================================= -->
        <!-- PRIMARY ACTIONS - Save and Reset buttons -->
        <!-- ========================================================================================= -->
        <StackPanel Grid.Column="0"
                    Orientation="Horizontal"
                    Spacing="8"
                    HorizontalAlignment="Left">

          <!-- Save Button -->
          <Button x:Name="SaveButton"
                  Classes="Primary ManufacturingSave"
                  Command="{Binding SaveCommand}"
                  IsEnabled="{Binding CanSave}"
                  ToolTip.Tip="Save inventory item (Enter to execute)"
                  TabIndex="6"
                  Height="32"
                  MinWidth="100">
            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Spacing="6">
              <materialIcons:MaterialIcon Kind="ContentSave" Classes="ManufacturingActionIcon"/>
              <TextBlock Classes="Caption" Text="Save Item"/>
            </StackPanel>
          </Button>

          <!-- Reset Button -->
          <Button Classes="Secondary ManufacturingReset"
                  Command="{Binding ResetCommand}"
                  CommandParameter="False"
                  ToolTip.Tip="Reset form (F5 for soft reset, Shift+F5 for hard reset)"
                  Height="32"
                  MinWidth="80">
            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Spacing="6">
              <materialIcons:MaterialIcon Kind="Refresh" Classes="ManufacturingSecondaryIcon"/>
              <TextBlock Classes="Caption" Text="Reset"/>
            </StackPanel>
          </Button>

        </StackPanel>

        <!-- ========================================================================================= -->
        <!-- ADVANCED ACTIONS - Settings/Advanced entry button -->
        <!-- ========================================================================================= -->
        <Button Grid.Column="2"
                Classes="Icon ManufacturingAdvanced"
                Command="{Binding AdvancedEntryCommand}"
                ToolTip.Tip="Open advanced inventory features"
                Height="32"
                Width="32">
          <materialIcons:MaterialIcon Kind="Settings" Classes="ManufacturingLargeIcon"/>
        </Button>

      </Grid>

    </Grid>
  </Border>
</UserControl>
