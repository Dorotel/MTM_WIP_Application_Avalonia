<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:MTM_WIP_Application_Avalonia.ViewModels"
             xmlns:materialIcons="using:Material.Icons.Avalonia"
             mc:Ignorable="d"
             d:DesignWidth="800"
             d:DesignHeight="600"
             x:Class="MTM_WIP_Application_Avalonia.Views.TransferTabView"
             x:CompileBindings="True"
             x:DataType="vm:TransferItemViewModel">

  <UserControl.Resources>
    <!-- Black, White, Gold Color Scheme -->
    <SolidColorBrush x:Key="PrimaryBrush" Color="#FFD700"/>           <!-- Gold -->
    <SolidColorBrush x:Key="PrimaryDarkBrush" Color="#DAA520"/>       <!-- Dark Gold -->
    <SolidColorBrush x:Key="SecondaryBrush" Color="#F5F5DC"/>         <!-- Beige -->
    <SolidColorBrush x:Key="CardBackgroundBrush" Color="#FFFFFF"/>    <!-- White -->
    <SolidColorBrush x:Key="BorderBrush" Color="#E0E0E0"/>            <!-- Light Gray -->
    <SolidColorBrush x:Key="PrimaryTextBrush" Color="#000000"/>       <!-- Black Text -->
    <SolidColorBrush x:Key="AccentBrush" Color="#4169E1"/>            <!-- Royal Blue for icons -->
    <SolidColorBrush x:Key="SuccessBrush" Color="#228B22"/>           <!-- Forest Green -->
  </UserControl.Resources>

  <UserControl.Styles>
    <!-- Compact Input Styles -->
    <Style Selector="TextBox.input-field">
      <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="3"/>
      <Setter Property="Padding" Value="6,3"/>
      <Setter Property="Background" Value="{StaticResource CardBackgroundBrush}"/>
      <Setter Property="FontSize" Value="10"/>
      <Setter Property="MinHeight" Value="24"/>
      <Setter Property="Margin" Value="2"/>
    </Style>

    <Style Selector="ComboBox.input-field">
      <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="3"/>
      <Setter Property="Padding" Value="6,3"/>
      <Setter Property="Background" Value="{StaticResource CardBackgroundBrush}"/>
      <Setter Property="FontSize" Value="10"/>
      <Setter Property="MinHeight" Value="24"/>
      <Setter Property="Margin" Value="2"/>
    </Style>

    <Style Selector="NumericUpDown.input-field">
      <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="3"/>
      <Setter Property="Padding" Value="6,3"/>
      <Setter Property="Background" Value="{StaticResource CardBackgroundBrush}"/>
      <Setter Property="FontSize" Value="10"/>
      <Setter Property="MinHeight" Value="24"/>
      <Setter Property="Margin" Value="2"/>
    </Style>

    <!-- AutoCompleteBox Input Styles -->
    <Style Selector="AutoCompleteBox.input-field">
      <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="3"/>
      <Setter Property="Padding" Value="6,3"/>
      <Setter Property="Background" Value="{StaticResource CardBackgroundBrush}"/>
      <Setter Property="FontSize" Value="10"/>
      <Setter Property="MinHeight" Value="24"/>
      <Setter Property="Margin" Value="2"/>
      <Setter Property="FilterMode" Value="Contains"/>
      <Setter Property="MinimumPrefixLength" Value="0"/>
      <Setter Property="MaxDropDownHeight" Value="200"/>
      <Setter Property="IsTextCompletionEnabled" Value="True"/>
    </Style>

    <!-- Compact Button Styles -->
    <Style Selector="Button.action-button">
      <Setter Property="Padding" Value="6,3"/>
      <Setter Property="Margin" Value="2"/>
      <Setter Property="FontSize" Value="10"/>
      <Setter Property="FontWeight" Value="Medium"/>
      <Setter Property="CornerRadius" Value="3"/>
      <Setter Property="MinHeight" Value="24"/>
      <Setter Property="Cursor" Value="Hand"/>
      <Setter Property="HorizontalContentAlignment" Value="Center"/>
      <Setter Property="VerticalContentAlignment" Value="Center"/>
    </Style>
    
    <Style Selector="Button.primary">
      <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
      <Setter Property="Foreground" Value="{StaticResource PrimaryTextBrush}"/>
      <Setter Property="BorderBrush" Value="{StaticResource PrimaryBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
    </Style>
    <Style Selector="Button.primary:pointerover">
      <Setter Property="Background" Value="{StaticResource PrimaryDarkBrush}"/>
    </Style>

    <Style Selector="Button.secondary">
      <Setter Property="Background" Value="{StaticResource CardBackgroundBrush}"/>
      <Setter Property="Foreground" Value="{StaticResource PrimaryTextBrush}"/>
      <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
    </Style>
    <Style Selector="Button.secondary:pointerover">
      <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
      <Setter Property="Foreground" Value="{StaticResource PrimaryTextBrush}"/>
    </Style>

    <Style Selector="Button.transfer">
      <Setter Property="Background" Value="{StaticResource SuccessBrush}"/>
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="BorderBrush" Value="{StaticResource SuccessBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
    </Style>

    <!-- DataGrid styling -->
    <Style Selector="DataGrid">
      <Setter Property="Background" Value="{StaticResource CardBackgroundBrush}"/>
      <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="3"/>
      <Setter Property="GridLinesVisibility" Value="Horizontal"/>
      <Setter Property="HeadersVisibility" Value="Column"/>
      <Setter Property="CanUserReorderColumns" Value="True"/>
      <Setter Property="CanUserResizeColumns" Value="True"/>
      <Setter Property="CanUserSortColumns" Value="True"/>
      <Setter Property="IsReadOnly" Value="True"/>
      <Setter Property="SelectionMode" Value="Single"/>
    </Style>
  </UserControl.Styles>

  <!-- Main container -->
  <Grid RowDefinitions="*,Auto" 
        HorizontalAlignment="Stretch" 
        VerticalAlignment="Stretch"
        Margin="0"
        Background="{StaticResource CardBackgroundBrush}">

    <!-- Main Panel -->
    <Border Grid.Row="0"
            Background="{StaticResource CardBackgroundBrush}"
            BorderBrush="{StaticResource BorderBrush}"
            BorderThickness="1"
            CornerRadius="4"
            Padding="4"
            Margin="4"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch">
      <Grid ColumnSpacing="6">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="280"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        
        <!-- Left Panel: Transfer Criteria -->
        <Border Grid.Column="0"
                Background="{StaticResource CardBackgroundBrush}"
                BorderBrush="{StaticResource BorderBrush}"
                BorderThickness="1"
                CornerRadius="4">
          <Grid ColumnDefinitions="Auto,*">
            <!-- Vertical Header Bar -->
            <Border Grid.Column="0"
                    Background="{StaticResource PrimaryBrush}"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="0,0,1,0"
                    Width="32"
                    CornerRadius="4,0,0,4">
              <Grid RowDefinitions="*,Auto,*">
                <!-- Transfer Icon -->
                <materialIcons:MaterialIcon Grid.Row="1"
                                            Kind="SwapHorizontal"
                                            Width="14"
                                            Height="14"
                                            Foreground="{StaticResource AccentBrush}"
                                            HorizontalAlignment="Center"
                                            ToolTip.Tip="Transfer Panel"/>
              </Grid>
            </Border>

            <!-- Transfer Criteria Content -->
            <Border Grid.Column="1" Padding="6,4">
              <StackPanel Spacing="6">
                
                <!-- Part ID -->
                <StackPanel>
                  <Grid ColumnDefinitions="Auto,*" ColumnSpacing="3" Margin="0,0,0,1">
                    <materialIcons:MaterialIcon Grid.Column="0"
                                                Kind="Identifier"
                                                Width="10"
                                                Height="10"
                                                Foreground="{StaticResource AccentBrush}"
                                                VerticalAlignment="Center"
                                                ToolTip.Tip="Part ID"/>
                  </Grid>
                  <AutoCompleteBox ItemsSource="{Binding PartOptions}"
                                   SelectedItem="{Binding SelectedPart, Mode=TwoWay}"
                                   Text="{Binding PartText, Mode=TwoWay}"
                                   Classes="input-field"
                                   HorizontalAlignment="Stretch"
                                   Watermark="Select part ID..."
                                   ToolTip.Tip="Select part to transfer"/>
                </StackPanel>

                <!-- Operation -->
                <StackPanel>
                  <Grid ColumnDefinitions="Auto,*" ColumnSpacing="3" Margin="0,0,0,1">
                    <materialIcons:MaterialIcon Grid.Column="0"
                                                Kind="Cog"
                                                Width="10"
                                                Height="10"
                                                Foreground="{StaticResource AccentBrush}"
                                                VerticalAlignment="Center"
                                                ToolTip.Tip="Operation"/>
                  </Grid>
                  <AutoCompleteBox ItemsSource="{Binding OperationOptions}"
                                   SelectedItem="{Binding SelectedOperation, Mode=TwoWay}"
                                   Text="{Binding OperationText, Mode=TwoWay}"
                                   Classes="input-field"
                                   HorizontalAlignment="Stretch"
                                   Watermark="Select operation..."
                                   ToolTip.Tip="Select operation (optional)"/>
                </StackPanel>

                <!-- To Location -->
                <StackPanel>
                  <Grid ColumnDefinitions="Auto,*" ColumnSpacing="3" Margin="0,0,0,1">
                    <materialIcons:MaterialIcon Grid.Column="0"
                                                Kind="MapMarkerRadius"
                                                Width="10"
                                                Height="10"
                                                Foreground="{StaticResource AccentBrush}"
                                                VerticalAlignment="Center"
                                                ToolTip.Tip="Destination Location"/>
                  </Grid>
                  <AutoCompleteBox ItemsSource="{Binding LocationOptions}"
                                   SelectedItem="{Binding SelectedToLocation, Mode=TwoWay}"
                                   Text="{Binding ToLocationText, Mode=TwoWay}"
                                   Classes="input-field"
                                   HorizontalAlignment="Stretch"
                                   Watermark="Select destination..."
                                   ToolTip.Tip="Select destination location"/>
                </StackPanel>

                <!-- Transfer Quantity -->
                <StackPanel>
                  <Grid ColumnDefinitions="Auto,*" ColumnSpacing="3" Margin="0,0,0,1">
                    <materialIcons:MaterialIcon Grid.Column="0"
                                                Kind="Counter"
                                                Width="10"
                                                Height="10"
                                                Foreground="{StaticResource AccentBrush}"
                                                VerticalAlignment="Center"
                                                ToolTip.Tip="Transfer Quantity"/>
                  </Grid>
                  <Grid ColumnDefinitions="*,Auto">
                    <NumericUpDown Grid.Column="0"
                                   Value="{Binding TransferQuantity, Mode=TwoWay}"
                                   Minimum="1"
                                   Maximum="{Binding MaxTransferQuantity}"
                                   Classes="input-field"
                                   HorizontalAlignment="Stretch"
                                   ToolTip.Tip="Quantity to transfer"/>
                    <TextBlock Grid.Column="1"
                               Text="{Binding MaxTransferQuantity, StringFormat='/ {0}'}"
                               FontSize="9"
                               VerticalAlignment="Center"
                               Margin="4,0,0,0"
                               Foreground="{StaticResource PrimaryTextBrush}"
                               Opacity="0.7"
                               ToolTip.Tip="Maximum available"/>
                  </Grid>
                </StackPanel>

              </StackPanel>
            </Border>
          </Grid>
        </Border>

        <!-- Right Panel: Transfer Results Grid -->
        <Border Grid.Column="1"
                Background="{StaticResource CardBackgroundBrush}"
                BorderBrush="{StaticResource BorderBrush}"
                BorderThickness="1"
                CornerRadius="4"
                Padding="4">
          <Grid RowDefinitions="Auto,*">
            <!-- Grid Header -->
            <Border Grid.Row="0" 
                    Background="{StaticResource PrimaryBrush}"
                    CornerRadius="3"
                    Padding="6,4"
                    Margin="0,0,0,4">
              <Grid ColumnDefinitions="Auto,*,Auto">
                <materialIcons:MaterialIcon Grid.Column="0"
                                            Kind="ViewList"
                                            Width="14"
                                            Height="14"
                                            Foreground="{StaticResource AccentBrush}"
                                            VerticalAlignment="Center"
                                            Margin="0,0,4,0"/>
                <TextBlock Grid.Column="1"
                           Text="Available Inventory"
                           FontSize="11"
                           FontWeight="SemiBold"
                           Foreground="{StaticResource PrimaryTextBrush}"
                           VerticalAlignment="Center"/>
                <StackPanel Grid.Column="2" 
                            Orientation="Horizontal" 
                            Spacing="3">
                  <TextBlock Text="{Binding InventoryItems.Count}"
                             FontSize="10"
                             FontWeight="Bold"
                             Foreground="{StaticResource AccentBrush}"
                             VerticalAlignment="Center"/>
                  <TextBlock Text="items"
                             FontSize="9"
                             Foreground="{StaticResource PrimaryTextBrush}"
                             VerticalAlignment="Center"/>
                </StackPanel>
              </Grid>
            </Border>
            
            <!-- Data Grid -->
            <DataGrid Grid.Row="1"
                      ItemsSource="{Binding InventoryItems}"
                      SelectedItem="{Binding SelectedInventoryItem, Mode=TwoWay}"
                      AutoGenerateColumns="False"
                      FontSize="9"
                      RowHeight="20">
              <DataGrid.Columns>
                <DataGridTextColumn Header="Location" Binding="{Binding Location}" Width="80"/>
                <DataGridTextColumn Header="Part" Binding="{Binding PartId}" Width="80"/>
                <DataGridTextColumn Header="Op" Binding="{Binding Operation}" Width="35"/>
                <DataGridTextColumn Header="Qty" Binding="{Binding Quantity}" Width="40"/>
                <DataGridTextColumn Header="Notes" Binding="{Binding Notes}" Width="*"/>
                <DataGridTextColumn Header="Date" Binding="{Binding LastUpdated, StringFormat='{}{0:MM/dd/yy}'}" Width="50"/>
              </DataGrid.Columns>
            </DataGrid>
          </Grid>
        </Border>

      </Grid>
    </Border>

    <!-- Compact Bottom Action Panel -->
    <Border Grid.Row="1"
            Background="{StaticResource CardBackgroundBrush}"
            BorderBrush="{StaticResource BorderBrush}"
            BorderThickness="1"
            CornerRadius="4"
            Padding="6"
            Margin="4,0,4,4">
      <Grid ColumnDefinitions="*,Auto">
        <!-- Left side buttons -->
        <StackPanel Grid.Column="0" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Left" 
                    Spacing="4">
          <Button Classes="action-button primary"
                  Width="60" 
                  Height="24"
                  Command="{Binding SearchCommand}"
                  ToolTip.Tip="Search inventory">
            <StackPanel Orientation="Horizontal" Spacing="3"
                        HorizontalAlignment="Center" VerticalAlignment="Center">
              <materialIcons:MaterialIcon Kind="Magnify" Width="10" Height="10"/>
              <TextBlock Text="Search" FontSize="9"/>
            </StackPanel>
          </Button>
          <Button Classes="action-button transfer"
                  Width="60" 
                  Height="24"
                  Command="{Binding TransferCommand}"
                  IsEnabled="{Binding CanTransfer}"
                  ToolTip.Tip="Execute transfer">
            <StackPanel Orientation="Horizontal" Spacing="3"
                        HorizontalAlignment="Center" VerticalAlignment="Center">
              <materialIcons:MaterialIcon Kind="ArrowRightBold" Width="10" Height="10"/>
              <TextBlock Text="Transfer" FontSize="9"/>
            </StackPanel>
          </Button>
          <Button Classes="action-button secondary"
                  Width="50" 
                  Height="24"
                  Command="{Binding ResetCommand}"
                  ToolTip.Tip="Reset form">
            <StackPanel Orientation="Horizontal" Spacing="3"
                        HorizontalAlignment="Center" VerticalAlignment="Center">
              <materialIcons:MaterialIcon Kind="Refresh" Width="10" Height="10"/>
              <TextBlock Text="Reset" FontSize="9"/>
            </StackPanel>
          </Button>
          <Button Classes="action-button secondary"
                  Width="50" 
                  Height="24"
                  Command="{Binding PrintCommand}"
                  ToolTip.Tip="Print report">
            <StackPanel Orientation="Horizontal" Spacing="3"
                        HorizontalAlignment="Center" VerticalAlignment="Center">
              <materialIcons:MaterialIcon Kind="Printer" Width="10" Height="10"/>
              <TextBlock Text="Print" FontSize="9"/>
            </StackPanel>
          </Button>
        </StackPanel>

        <!-- Right side - toggle button -->
        <Button Grid.Column="1"
                Classes="action-button secondary"
                Width="24" 
                Height="24"
                Command="{Binding TogglePanelCommand}"
                ToolTip.Tip="Toggle panel">
          <materialIcons:MaterialIcon Kind="DotsVertical" Width="10" Height="10"/>
        </Button>
      </Grid>
    </Border>
  </Grid>
</UserControl>
