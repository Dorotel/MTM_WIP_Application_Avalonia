<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:MTM_WIP_Application_Avalonia.ViewModels.MainForm"
             xmlns:materialIcons="using:Material.Icons.Avalonia"
             mc:Ignorable="d"
             d:DesignWidth="1200"
             d:DesignHeight="800"
             x:Class="MTM_WIP_Application_Avalonia.Views.AdvancedRemoveView"
             x:CompileBindings="True"
             x:DataType="vm:AdvancedRemoveViewModel">

  <UserControl.Styles>
    <!-- Compact Input Styles -->
    <Style Selector="TextBox.input-field">
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.BorderBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="3"/>
      <Setter Property="Padding" Value="6,3"/>
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"/>
      <Setter Property="FontSize" Value="10"/>
      <Setter Property="MinHeight" Value="24"/>
      <Setter Property="Margin" Value="2"/>
    </Style>

    <Style Selector="AutoCompleteBox.input-field">
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.BorderBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="3"/>
      <Setter Property="Padding" Value="6,3"/>
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"/>
      <Setter Property="FontSize" Value="10"/>
      <Setter Property="MinHeight" Value="24"/>
      <Setter Property="Margin" Value="2"/>
    </Style>

    <!-- Compact Button Styles -->
    <Style Selector="Button.action-button">
      <Setter Property="Padding" Value="6,3"/>
      <Setter Property="Margin" Value="2"/>
      <Setter Property="FontSize" Value="10"/>
      <Setter Property="FontWeight" Value="Medium"/>
      <Setter Property="CornerRadius" Value="3"/>
      <Setter Property="MinHeight" Value="24"/>
      <Setter Property="Cursor" Value="Hand"/>
    </Style>
    
    <Style Selector="Button.primary">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.PrimaryBrush}"/>
      <Setter Property="Foreground" Value="{DynamicResource MTM_Shared_Logic.LightTextBrush}"/>
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.PrimaryBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
    </Style>
    <Style Selector="Button.primary:pointerover">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.PrimaryHoverBrush}"/>
    </Style>

    <Style Selector="Button.secondary">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"/>
      <Setter Property="Foreground" Value="{DynamicResource MTM_Shared_Logic.PrimaryTextBrush}"/>
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.BorderBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
    </Style>
    <Style Selector="Button.secondary:pointerover">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.PrimaryBrush}"/>
      <Setter Property="Foreground" Value="{DynamicResource MTM_Shared_Logic.LightTextBrush}"/>
    </Style>

    <Style Selector="Button.danger">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.ErrorBrush}"/>
      <Setter Property="Foreground" Value="{DynamicResource MTM_Shared_Logic.LightTextBrush}"/>
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.ErrorBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
    </Style>

    <!-- DataGrid styling -->
    <Style Selector="DataGrid">
      <Setter Property="Background" Value="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"/>
      <Setter Property="BorderBrush" Value="{DynamicResource MTM_Shared_Logic.BorderBrush}"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="3"/>
      <Setter Property="GridLinesVisibility" Value="Horizontal"/>
      <Setter Property="HeadersVisibility" Value="Column"/>
      <Setter Property="CanUserReorderColumns" Value="True"/>
      <Setter Property="CanUserResizeColumns" Value="True"/>
      <Setter Property="CanUserSortColumns" Value="True"/>
      <Setter Property="IsReadOnly" Value="True"/>
      <Setter Property="SelectionMode" Value="Extended"/>
    </Style>
  </UserControl.Styles>

  <!-- FIXED: Properly contained within tab content with no excessive margins -->
  <Grid RowDefinitions="*,Auto" 
        HorizontalAlignment="Stretch" 
        VerticalAlignment="Stretch"
        Margin="0"
        Background="{DynamicResource MTM_Shared_Logic.AppBackgroundBrush}">

    <!-- Main Panel -->
    <Border Grid.Row="0"
            Background="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"
            BorderBrush="{DynamicResource MTM_Shared_Logic.BorderBrush}"
            BorderThickness="1"
            CornerRadius="4"
            Padding="4"
            Margin="4"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch">
      <Grid ColumnSpacing="6">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="{Binding FilterPanelWidth}"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        
        <!-- Compact Left Panel: Search Criteria -->
        <Border Grid.Column="0"
                Background="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"
                BorderBrush="{DynamicResource MTM_Shared_Logic.BorderBrush}"
                BorderThickness="1"
                CornerRadius="4">
          <Grid ColumnDefinitions="Auto,*">
            <!-- Compact Vertical Header Bar -->
            <Border Grid.Column="0"
                    Background="{DynamicResource MTM_Shared_Logic.PrimaryGradientBrush}"
                    BorderBrush="{DynamicResource MTM_Shared_Logic.BorderBrush}"
                    BorderThickness="0,0,1,0"
                    Width="32"
                    CornerRadius="4,0,0,4">
              <Grid RowDefinitions="*,Auto,Auto,*">
                <!-- Filter Icon -->
                <materialIcons:MaterialIcon Grid.Row="1"
                                            Kind="FilterVariant"
                                            Width="14"
                                            Height="14"
                                            Foreground="{DynamicResource MTM_Shared_Logic.LightTextBrush}"
                                            HorizontalAlignment="Center"
                                            Margin="0,0,0,3"/>
                
                <!-- Toggle Button -->
                <Button Grid.Row="2"
                        Command="{Binding ToggleFilterPanelCommand}"
                        Width="20"
                        Height="20"
                        Background="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"
                        Foreground="{DynamicResource MTM_Shared_Logic.PrimaryBrush}"
                        BorderThickness="1"
                        BorderBrush="{DynamicResource MTM_Shared_Logic.BorderBrush}"
                        CornerRadius="10"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Margin="6,0,6,6"
                        Cursor="Hand"
                        ToolTip.Tip="Toggle Filter Panel">
                  <materialIcons:MaterialIcon Kind="{Binding CollapseButtonIcon}"
                                              Width="10"
                                              Height="10"/>
                </Button>
              </Grid>
            </Border>

            <!-- Compact Filter Content -->
            <Border Grid.Column="1"
                    IsVisible="{Binding IsFilterPanelExpanded}"
                    Padding="6,4">
              <StackPanel Spacing="6">
                
                <!-- Part ID -->
                <StackPanel>
                  <Grid ColumnDefinitions="Auto,*" ColumnSpacing="3" Margin="0,0,0,1">
                    <materialIcons:MaterialIcon Grid.Column="0"
                                                Kind="Identifier"
                                                Width="10"
                                                Height="10"
                                                Foreground="{DynamicResource MTM_Shared_Logic.PrimaryBrush}"
                                                VerticalAlignment="Center"/>
                    <TextBlock Grid.Column="1" 
                               Text="Part ID:" 
                               FontSize="9" 
                               FontWeight="Medium" 
                               Foreground="{DynamicResource MTM_Shared_Logic.PrimaryTextBrush}"/>
                  </Grid>
                  <AutoCompleteBox ItemsSource="{Binding PartIDOptions}"
                                   Text="{Binding FilterPartIDText, Mode=TwoWay}"
                                   Classes="input-field"
                                   HorizontalAlignment="Stretch"/>
                </StackPanel>

                <!-- Location -->
                <StackPanel>
                  <Grid ColumnDefinitions="Auto,*" ColumnSpacing="3" Margin="0,0,0,1">
                    <materialIcons:MaterialIcon Grid.Column="0"
                                                Kind="MapMarker"
                                                Width="10"
                                                Height="10"
                                                Foreground="{DynamicResource MTM_Shared_Logic.PrimaryBrush}"
                                                VerticalAlignment="Center"/>
                    <TextBlock Grid.Column="1" 
                               Text="Location:" 
                               FontSize="9" 
                               FontWeight="Medium" 
                               Foreground="{DynamicResource MTM_Shared_Logic.PrimaryTextBrush}"/>
                  </Grid>
                  <AutoCompleteBox ItemsSource="{Binding LocationOptions}"
                                   Text="{Binding FilterLocationText, Mode=TwoWay}"
                                   Classes="input-field"
                                   HorizontalAlignment="Stretch"/>
                </StackPanel>

                <!-- Operation -->
                <StackPanel>
                  <Grid ColumnDefinitions="Auto,*" ColumnSpacing="3" Margin="0,0,0,1">
                    <materialIcons:MaterialIcon Grid.Column="0"
                                                Kind="Cog"
                                                Width="10"
                                                Height="10"
                                                Foreground="{DynamicResource MTM_Shared_Logic.PrimaryBrush}"
                                                VerticalAlignment="Center"/>
                    <TextBlock Grid.Column="1" 
                               Text="Operation:" 
                               FontSize="9" 
                               FontWeight="Medium" 
                               Foreground="{DynamicResource MTM_Shared_Logic.PrimaryTextBrush}"/>
                  </Grid>
                  <AutoCompleteBox ItemsSource="{Binding OperationOptions}"
                                   Text="{Binding FilterOperation, Mode=TwoWay}"
                                   Classes="input-field"
                                   HorizontalAlignment="Stretch"/>
                </StackPanel>

                <!-- User -->
                <StackPanel>
                  <Grid ColumnDefinitions="Auto,*" ColumnSpacing="3" Margin="0,0,0,1">
                    <materialIcons:MaterialIcon Grid.Column="0"
                                                Kind="Account"
                                                Width="10"
                                                Height="10"
                                                Foreground="{DynamicResource MTM_Shared_Logic.PrimaryBrush}"
                                                VerticalAlignment="Center"/>
                    <TextBlock Grid.Column="1" 
                               Text="User:" 
                               FontSize="9" 
                               FontWeight="Medium" 
                               Foreground="{DynamicResource MTM_Shared_Logic.PrimaryTextBrush}"/>
                  </Grid>
                  <AutoCompleteBox ItemsSource="{Binding UserOptions}"
                                   Text="{Binding FilterUserText, Mode=TwoWay}"
                                   Watermark="Enter User"
                                   Classes="input-field"
                                   HorizontalAlignment="Stretch"/>
                </StackPanel>

                <!-- Notes -->
                <StackPanel>
                  <Grid ColumnDefinitions="Auto,*" ColumnSpacing="3" Margin="0,0,0,1">
                    <materialIcons:MaterialIcon Grid.Column="0"
                                                Kind="NoteText"
                                                Width="10"
                                                Height="10"
                                                Foreground="{DynamicResource MTM_Shared_Logic.PrimaryBrush}"
                                                VerticalAlignment="Center"/>
                    <TextBlock Grid.Column="1" 
                               Text="Notes:" 
                               FontSize="9" 
                               FontWeight="Medium" 
                               Foreground="{DynamicResource MTM_Shared_Logic.PrimaryTextBrush}"/>
                  </Grid>
                  <TextBox Text="{Binding FilterNotes, Mode=TwoWay}"
                           Classes="input-field"
                           HorizontalAlignment="Stretch"/>
                </StackPanel>

                <!-- Quantity Range -->
                <StackPanel>
                  <Grid ColumnDefinitions="Auto,*" ColumnSpacing="3" Margin="0,0,0,1">
                    <materialIcons:MaterialIcon Grid.Column="0"
                                                Kind="Counter"
                                                Width="10"
                                                Height="10"
                                                Foreground="{DynamicResource MTM_Shared_Logic.PrimaryBrush}"
                                                VerticalAlignment="Center"/>
                    <TextBlock Grid.Column="1" 
                               Text="Quantity:" 
                               FontSize="9" 
                               FontWeight="Medium" 
                               Foreground="{DynamicResource MTM_Shared_Logic.PrimaryTextBrush}"/>
                  </Grid>
                  <Grid ColumnDefinitions="*,3,*" ColumnSpacing="3">
                    <TextBox Grid.Column="0" 
                             Watermark="Min"
                             Text="{Binding QuantityMin, Mode=TwoWay}"
                             Classes="input-field"
                             HorizontalAlignment="Stretch"/>
                    <TextBox Grid.Column="2" 
                             Watermark="Max"
                             Text="{Binding QuantityMax, Mode=TwoWay}"
                             Classes="input-field"
                             HorizontalAlignment="Stretch"/>
                  </Grid>
                </StackPanel>

                <!-- Compact Date Range -->
                <StackPanel>
                  <CheckBox IsChecked="{Binding UseDateRange, Mode=TwoWay}"
                            FontSize="9"
                            FontWeight="Medium"
                            Foreground="{DynamicResource MTM_Shared_Logic.PrimaryTextBrush}"
                            Margin="0,0,0,3">
                    <CheckBox.Content>
                      <Grid ColumnDefinitions="Auto,*" ColumnSpacing="3">
                        <materialIcons:MaterialIcon Grid.Column="0"
                                                    Kind="CalendarRange"
                                                    Width="10"
                                                    Height="10"
                                                    Foreground="{DynamicResource MTM_Shared_Logic.PrimaryBrush}"
                                                    VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1" 
                                   Text="Date Range:" 
                                   FontSize="9" 
                                   FontWeight="Medium"/>
                      </Grid>
                    </CheckBox.Content>
                  </CheckBox>
                  <Grid ColumnDefinitions="*,3,*" 
                        ColumnSpacing="3"
                        IsEnabled="{Binding UseDateRange}">
                    <!-- Start Date -->
                    <Border Grid.Column="0"
                            BorderBrush="{DynamicResource MTM_Shared_Logic.BorderBrush}"
                            BorderThickness="1"
                            CornerRadius="3"
                            Background="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"
                            Cursor="Hand">
                      <Grid>
                        <TextBox Text="{Binding RemovalDateRangeStart, StringFormat='{}{0:MM/dd/yyyy}', Mode=OneWay}"
                                 IsReadOnly="True"
                                 Classes="input-field"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 Watermark="Start Date"
                                 HorizontalAlignment="Stretch"
                                 Padding="6,3,20,3"/>
                        <materialIcons:MaterialIcon Kind="Calendar"
                                                    Width="10"
                                                    Height="10"
                                                    Foreground="{DynamicResource MTM_Shared_Logic.PrimaryBrush}"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Center"
                                                    Margin="0,0,4,0"
                                                    IsHitTestVisible="False"/>
                        <Button Background="Transparent"
                                BorderThickness="0"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Cursor="Hand"
                                Padding="0"
                                Margin="0">
                          <Button.Flyout>
                            <Flyout Placement="BottomEdgeAlignedLeft">
                              <Border Background="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"
                                      BorderBrush="{DynamicResource MTM_Shared_Logic.BorderBrush}"
                                      BorderThickness="1"
                                      CornerRadius="4"
                                      Padding="8">
                                <StackPanel Spacing="6">
                                  <Grid ColumnDefinitions="Auto,*" ColumnSpacing="4">
                                    <materialIcons:MaterialIcon Grid.Column="0"
                                                                Kind="CalendarStart"
                                                                Width="12"
                                                                Height="12"
                                                                Foreground="{DynamicResource MTM_Shared_Logic.PrimaryBrush}"
                                                                VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1"
                                               Text="Select Start Date"
                                               FontSize="10"
                                               FontWeight="Medium"
                                               Foreground="{DynamicResource MTM_Shared_Logic.PrimaryTextBrush}"/>
                                  </Grid>
                                  <DatePicker SelectedDate="{Binding RemovalDateRangeStart, Mode=TwoWay}"
                                              FontSize="9"
                                              MinWidth="160"/>
                                </StackPanel>
                              </Border>
                            </Flyout>
                          </Button.Flyout>
                        </Button>
                      </Grid>
                    </Border>
                    
                    <!-- End Date -->
                    <Border Grid.Column="2"
                            BorderBrush="{DynamicResource MTM_Shared_Logic.BorderBrush}"
                            BorderThickness="1"
                            CornerRadius="3"
                            Background="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"
                            Cursor="Hand">
                      <Grid>
                        <TextBox Text="{Binding RemovalDateRangeEnd, StringFormat='{}{0:MM/dd/yyyy}', Mode=OneWay}"
                                 IsReadOnly="True"
                                 Classes="input-field"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 Watermark="End Date"
                                 HorizontalAlignment="Stretch"
                                 Padding="6,3,20,3"/>
                        <materialIcons:MaterialIcon Kind="Calendar"
                                                    Width="10"
                                                    Height="10"
                                                    Foreground="{DynamicResource MTM_Shared_Logic.PrimaryBrush}"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Center"
                                                    Margin="0,0,4,0"
                                                    IsHitTestVisible="False"/>
                        <Button Background="Transparent"
                                BorderThickness="0"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Cursor="Hand"
                                Padding="0"
                                Margin="0">
                          <Button.Flyout>
                            <Flyout Placement="BottomEdgeAlignedLeft">
                              <Border Background="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"
                                      BorderBrush="{DynamicResource MTM_Shared_Logic.BorderBrush}"
                                      BorderThickness="1"
                                      CornerRadius="4"
                                      Padding="8">
                                <StackPanel Spacing="6">
                                  <Grid ColumnDefinitions="Auto,*" ColumnSpacing="4">
                                    <materialIcons:MaterialIcon Grid.Column="0"
                                                                Kind="CalendarEnd"
                                                                Width="12"
                                                                Height="12"
                                                                Foreground="{DynamicResource MTM_Shared_Logic.PrimaryBrush}"
                                                                VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1"
                                               Text="Select End Date"
                                               FontSize="10"
                                               FontWeight="Medium"
                                               Foreground="{DynamicResource MTM_Shared_Logic.PrimaryTextBrush}"/>
                                  </Grid>
                                  <DatePicker SelectedDate="{Binding RemovalDateRangeEnd, Mode=TwoWay}"
                                              FontSize="9"
                                              MinWidth="160"/>
                                </StackPanel>
                              </Border>
                            </Flyout>
                          </Button.Flyout>
                        </Button>
                      </Grid>
                    </Border>
                  </Grid>
                </StackPanel>

              </StackPanel>
            </Border>
          </Grid>
        </Border>

        <!-- Right Panel: Removal History Grid -->
        <Border Grid.Column="1"
                Background="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"
                BorderBrush="{DynamicResource MTM_Shared_Logic.BorderBrush}"
                BorderThickness="1"
                CornerRadius="4"
                Padding="4">
          <Grid RowDefinitions="Auto,*">
            <!-- Compact Grid Header -->
            <Border Grid.Row="0" 
                    Background="{DynamicResource MTM_Shared_Logic.PrimaryGradientBrush}"
                    CornerRadius="3"
                    Padding="6,4"
                    Margin="0,0,0,4">
              <Grid ColumnDefinitions="Auto,*,Auto">
                <materialIcons:MaterialIcon Grid.Column="0"
                                            Kind="History"
                                            Width="14"
                                            Height="14"
                                            Foreground="{DynamicResource MTM_Shared_Logic.LightTextBrush}"
                                            VerticalAlignment="Center"
                                            Margin="0,0,4,0"/>
                <TextBlock Grid.Column="1"
                           Text="Removal History"
                           FontSize="11"
                           FontWeight="SemiBold"
                           Foreground="{DynamicResource MTM_Shared_Logic.LightTextBrush}"
                           VerticalAlignment="Center"/>
                <StackPanel Grid.Column="2" 
                            Orientation="Horizontal" 
                            Spacing="3">
                  <TextBlock Text="{Binding RemovalHistoryGrid.Count}"
                             FontSize="10"
                             FontWeight="Bold"
                             Foreground="{DynamicResource MTM_Shared_Logic.LightTextBrush}"
                             VerticalAlignment="Center"/>
                  <TextBlock Text="records"
                             FontSize="9"
                             Foreground="{DynamicResource MTM_Shared_Logic.LightTextBrush}"
                             VerticalAlignment="Center"/>
                </StackPanel>
              </Grid>
            </Border>
            
            <!-- Compact Data Grid -->
            <DataGrid Grid.Row="1"
                      ItemsSource="{Binding RemovalHistoryGrid}"
                      SelectedItem="{Binding SelectedHistoryItem, Mode=TwoWay}"
                      AutoGenerateColumns="False"
                      FontSize="9"
                      RowHeight="20">
              <DataGrid.Columns>
                <DataGridTextColumn Header="ID" Binding="{Binding ID}" Width="35"/>
                <DataGridTextColumn Header="Part" Binding="{Binding PartID}" Width="80"/>
                <DataGridTextColumn Header="Op" Binding="{Binding Operation}" Width="35"/>
                <DataGridTextColumn Header="Location" Binding="{Binding Location}" Width="60"/>
                <DataGridTextColumn Header="Qty" Binding="{Binding Quantity}" Width="40"/>
                <DataGridTextColumn Header="User" Binding="{Binding User}" Width="50"/>
                <DataGridTextColumn Header="Date" Binding="{Binding DateRemoved, StringFormat='{}{0:MM/dd/yy}'}" Width="50"/>
              </DataGrid.Columns>
            </DataGrid>
          </Grid>
        </Border>

      </Grid>
    </Border>

    <!-- Compact Bottom Action Panel -->
    <Border Grid.Row="1"
            Background="{DynamicResource MTM_Shared_Logic.CardBackgroundBrush}"
            BorderBrush="{DynamicResource MTM_Shared_Logic.BorderBrush}"
            BorderThickness="1"
            CornerRadius="4"
            Padding="6"
            Margin="4,0,4,4">
      <Grid ColumnDefinitions="*,Auto">
        <!-- Left side buttons -->
        <StackPanel Grid.Column="0" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Left" 
                    Spacing="4">
          <Button Classes="action-button primary"
                  Width="60" 
                  Height="24"
                  Command="{Binding SearchCommand}">
            <StackPanel Orientation="Horizontal" Spacing="3">
              <materialIcons:MaterialIcon Kind="Magnify" Width="10" Height="10"/>
              <TextBlock Text="Search" FontSize="9"/>
            </StackPanel>
          </Button>
          <Button Classes="action-button secondary"
                  Width="60" 
                  Height="24"
                  Command="{Binding UndoRemovalCommand}"
                  IsEnabled="{Binding CanUndo}">
            <StackPanel Orientation="Horizontal" Spacing="3">
              <materialIcons:MaterialIcon Kind="Undo" Width="10" Height="10"/>
              <TextBlock Text="Undo" FontSize="9"/>
            </StackPanel>
          </Button>
          <Button Classes="action-button danger"
                  Width="60" 
                  Height="24"
                  Command="{Binding RemoveSelectedCommand}">
            <StackPanel Orientation="Horizontal" Spacing="3">
              <materialIcons:MaterialIcon Kind="Delete" Width="10" Height="10"/>
              <TextBlock Text="Delete" FontSize="9"/>
            </StackPanel>
          </Button>
          <Button Classes="action-button secondary"
                  Width="60" 
                  Height="24"
                  Command="{Binding ClearCommand}">
            <StackPanel Orientation="Horizontal" Spacing="3">
              <materialIcons:MaterialIcon Kind="Refresh" Width="10" Height="10"/>
              <TextBlock Text="Reset" FontSize="9"/>
            </StackPanel>
          </Button>
          <Button Classes="action-button secondary"
                  Width="60" 
                  Height="24"
                  Command="{Binding PrintRemovalSummaryCommand}">
            <StackPanel Orientation="Horizontal" Spacing="3">
              <materialIcons:MaterialIcon Kind="Printer" Width="10" Height="10"/>
              <TextBlock Text="Print" FontSize="9"/>
            </StackPanel>
          </Button>
        </StackPanel>

        <!-- Right side button -->
        <Button Grid.Column="1"
                Classes="action-button secondary"
                Width="100" 
                Height="24"
                Command="{Binding BackToNormalCommand}">
          <StackPanel Orientation="Horizontal" Spacing="4">
            <materialIcons:MaterialIcon Kind="ArrowLeft" Width="10" Height="10"/>
            <TextBlock Text="Back to Normal" FontSize="9"/>
          </StackPanel>
        </Button>
      </Grid>
    </Border>
  </Grid>
</UserControl>
