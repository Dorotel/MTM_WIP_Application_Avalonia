<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MTM CustomDataGrid Implementation Guide</title>
    <style>
        :root {
            --mtm-primary: #0078D4;
            --mtm-secondary: #106EBE;
            --mtm-background: #FAFAFA;
            --mtm-card: #FFFFFF;
            --mtm-border: #E1DFDD;
            --mtm-text: #323130;
            --mtm-text-secondary: #605E5C;
            --mtm-success: #4CAF50;
            --mtm-warning: #FF9800;
            --mtm-error: #F44336;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: var(--mtm-background);
            color: var(--mtm-text);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: var(--mtm-primary);
            color: white;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }

        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }

        .card {
            background: var(--mtm-card);
            border: 1px solid var(--mtm-border);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .card h2 {
            color: var(--mtm-primary);
            margin-top: 0;
            border-bottom: 2px solid var(--mtm-border);
            padding-bottom: 10px;
        }

        .card h3 {
            color: var(--mtm-secondary);
            margin-top: 25px;
        }

        .code-block {
            background: #f8f9fa;
            border: 1px solid var(--mtm-border);
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .code-block.xml {
            background: #fff5f5;
            border-color: #fed7d7;
        }

        .code-block.csharp {
            background: #f0fff4;
            border-color: #c6f6d5;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid var(--mtm-border);
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            background: none;
            border-bottom: 3px solid transparent;
            color: var(--mtm-text-secondary);
            font-size: 1em;
        }

        .tab.active {
            color: var(--mtm-primary);
            border-bottom-color: var(--mtm-primary);
            font-weight: 600;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .feature-card {
            background: var(--mtm-card);
            border: 1px solid var(--mtm-border);
            border-radius: 6px;
            padding: 15px;
            text-align: center;
        }

        .feature-card h4 {
            color: var(--mtm-primary);
            margin: 0 0 10px 0;
        }

        .feature-card p {
            margin: 0;
            font-size: 0.9em;
            color: var(--mtm-text-secondary);
        }

        .alert {
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
        }

        .alert.info {
            background-color: #e3f2fd;
            border: 1px solid #bbdefb;
            color: #0d47a1;
        }

        .alert.warning {
            background-color: #fff3e0;
            border: 1px solid #ffcc02;
            color: #e65100;
        }

        .alert.success {
            background-color: #e8f5e8;
            border: 1px solid #4caf50;
            color: #2e7d32;
        }

        .button {
            background: var(--mtm-primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            margin: 5px;
            font-size: 0.9em;
        }

        .button:hover {
            background: var(--mtm-secondary);
        }

        .button.secondary {
            background: #6c757d;
        }

        .scenario-selector {
            margin: 20px 0;
        }

        .scenario-selector select {
            padding: 10px;
            border: 1px solid var(--mtm-border);
            border-radius: 4px;
            font-size: 1em;
            width: 100%;
            max-width: 300px;
        }

        .toc {
            background: var(--mtm-card);
            border: 1px solid var(--mtm-border);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .toc h3 {
            margin-top: 0;
            color: var(--mtm-primary);
        }

        .toc ul {
            list-style: none;
            padding: 0;
        }

        .toc li {
            margin: 8px 0;
        }

        .toc a {
            color: var(--mtm-secondary);
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            display: block;
        }

        .toc a:hover {
            background: var(--mtm-background);
            color: var(--mtm-primary);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>MTM CustomDataGrid</h1>
            <p>Enterprise-Grade Data Grid Implementation Guide</p>
        </div>

        <div class="toc">
            <h3>Table of Contents</h3>
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#quick-start">Quick Start</a></li>
                <li><a href="#basic-implementation">Basic Implementation</a></li>
                <li><a href="#advanced-features">Advanced Features</a></li>
                <li><a href="#copilot-prompts">GitHub Copilot Prompts</a></li>
                <li><a href="#troubleshooting">Troubleshooting</a></li>
            </ul>
        </div>

        <div class="card" id="overview">
            <h2>ðŸŽ¯ Overview</h2>
            <p>The MTM CustomDataGrid is a complete enterprise-grade data grid control designed specifically for the MTM WIP Application. It provides professional-level functionality for displaying, managing, and interacting with inventory and transaction data.</p>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>Phase 1: Core Grid</h4>
                    <p>Virtual scrolling, column definitions, MTM theme integration</p>
                </div>
                <div class="feature-card">
                    <h4>Phase 2: Selection</h4>
                    <p>Multi-selection with checkboxes, row actions, context menus</p>
                </div>
                <div class="feature-card">
                    <h4>Phase 3: Column Management</h4>
                    <p>Show/hide columns, reordering, configuration persistence</p>
                </div>
                <div class="feature-card">
                    <h4>Phase 4: Advanced Columns</h4>
                    <p>Drag-and-drop reordering, interactive resizing, settings</p>
                </div>
                <div class="feature-card">
                    <h4>Phase 5: Filtering</h4>
                    <p>Advanced filtering, search, filter presets, performance</p>
                </div>
                <div class="feature-card">
                    <h4>Phase 6: Data Operations</h4>
                    <p>Import/export, bulk operations, data analytics, insights</p>
                </div>
            </div>
        </div>

        <div class="card" id="quick-start">
            <h2>ðŸš€ Quick Start</h2>
            
            <div class="alert info">
                <strong>Prerequisites:</strong> Ensure your View follows the MTM InventoryTabView pattern with ScrollViewer as root and RowDefinitions="*,Auto".
            </div>

            <h3>1. Add Namespace</h3>
            <div class="code-block xml">
xmlns:customGrid="using:MTM_WIP_Application_Avalonia.Controls.CustomDataGrid"</div>

            <h3>2. Basic Grid Implementation</h3>
            <div class="code-block xml">
&lt;customGrid:CustomDataGrid 
    ItemsSource="{Binding YourDataCollection}"
    Columns="{Binding YourColumnDefinitions}"
    SelectedItem="{Binding SelectedItem}"
    IsMultiSelectEnabled="True"
    Margin="16" /&gt;</div>

            <h3>3. ViewModel Setup</h3>
            <div class="code-block csharp">
[ObservableObject]
public partial class YourViewModel : BaseViewModel
{
    [ObservableProperty]
    private ObservableCollection&lt;YourDataModel&gt; yourDataCollection = new();
    
    [ObservableProperty]
    private ObservableCollection&lt;CustomDataGridColumn&gt; yourColumnDefinitions = new();
    
    [ObservableProperty]
    private YourDataModel? selectedItem;
}</div>
        </div>

        <div class="card" id="basic-implementation">
            <h2>ðŸ“‹ Basic Implementation Examples</h2>

            <div class="tabs">
                <button class="tab active" onclick="showTab('inventory-example')">Inventory Data</button>
                <button class="tab" onclick="showTab('transaction-example')">Transaction Data</button>
                <button class="tab" onclick="showTab('simple-example')">Simple Data</button>
            </div>

            <div id="inventory-example" class="tab-content active">
                <h3>Inventory Data Grid</h3>
                <p>Perfect for displaying inventory items with part IDs, operations, quantities, and locations.</p>

                <h4>AXAML Implementation</h4>
                <div class="code-block xml">
&lt;ScrollViewer&gt;
  &lt;Grid RowDefinitions="*,Auto"&gt;
    &lt;customGrid:CustomDataGrid 
        Grid.Row="0"
        ItemsSource="{Binding InventoryItems}"
        Columns="{Binding InventoryColumns}"
        SelectedItem="{Binding SelectedInventoryItem}"
        IsMultiSelectEnabled="True"
        EnableFiltering="True"
        EnableColumnManagement="True"
        Margin="16" /&gt;
    
    &lt;!-- Action buttons in bottom row --&gt;
    &lt;StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="12" Margin="16"&gt;
      &lt;Button Content="Add Item" Command="{Binding AddItemCommand}" /&gt;
      &lt;Button Content="Edit Selected" Command="{Binding EditItemCommand}" /&gt;
      &lt;Button Content="Export Data" Command="{Binding ExportCommand}" /&gt;
    &lt;/StackPanel&gt;
  &lt;/Grid&gt;
&lt;/ScrollViewer&gt;</div>

                <h4>ViewModel Code</h4>
                <div class="code-block csharp">
[ObservableObject]
public partial class InventoryTabViewModel : BaseViewModel
{
    private readonly ICustomDataGridService _gridService;
    
    [ObservableProperty]
    private ObservableCollection&lt;InventoryItem&gt; inventoryItems = new();
    
    [ObservableProperty]
    private ObservableCollection&lt;CustomDataGridColumn&gt; inventoryColumns = new();
    
    [ObservableProperty]
    private InventoryItem? selectedInventoryItem;

    public InventoryTabViewModel(ICustomDataGridService gridService, ILogger&lt;InventoryTabViewModel&gt; logger) 
        : base(logger)
    {
        _gridService = gridService;
    }
    
    protected override async Task OnInitializeAsync()
    {
        try
        {
            // Load column definitions
            InventoryColumns = await _gridService.CreateInventoryColumnsAsync();
            
            // Load data
            await LoadInventoryDataAsync();
        }
        catch (Exception ex)
        {
            await ErrorHandling.HandleErrorAsync(ex, "Initialize inventory grid");
        }
    }
}</div>
            </div>

            <div id="transaction-example" class="tab-content">
                <h3>Transaction History Grid</h3>
                <p>Ideal for displaying transaction records with timestamps, users, and transaction details.</p>

                <h4>AXAML Implementation</h4>
                <div class="code-block xml">
&lt;customGrid:CustomDataGrid 
    ItemsSource="{Binding TransactionHistory}"
    Columns="{Binding TransactionColumns}"
    SelectedItem="{Binding SelectedTransaction}"
    IsMultiSelectEnabled="False"
    EnableFiltering="True"
    EnableExport="True"
    Margin="16"&gt;
    
    &lt;!-- Custom context menu for transactions --&gt;
    &lt;customGrid:CustomDataGrid.ContextMenu&gt;
        &lt;ContextMenu&gt;
            &lt;MenuItem Header="View Details" Command="{Binding ViewTransactionCommand}" /&gt;
            &lt;MenuItem Header="Print Transaction" Command="{Binding PrintTransactionCommand}" /&gt;
            &lt;Separator /&gt;
            &lt;MenuItem Header="Export Selected" Command="{Binding ExportSelectedCommand}" /&gt;
        &lt;/ContextMenu&gt;
    &lt;/customGrid:CustomDataGrid.ContextMenu&gt;
&lt;/customGrid:CustomDataGrid&gt;</div>

                <h4>Service Integration</h4>
                <div class="code-block csharp">
private async Task LoadTransactionDataAsync()
{
    try
    {
        IsLoading = true;
        
        // Create transaction columns
        TransactionColumns = await _gridService.CreateTransactionColumnsAsync();
        
        // Load transaction data (example)
        var transactions = await _transactionService.GetTransactionHistoryAsync();
        
        TransactionHistory.Clear();
        foreach (var transaction in transactions)
        {
            TransactionHistory.Add(transaction);
        }
        
        StatusMessage = $"Loaded {transactions.Count} transactions";
    }
    catch (Exception ex)
    {
        await ErrorHandling.HandleErrorAsync(ex, "Load transaction data");
    }
    finally
    {
        IsLoading = false;
    }
}</div>
            </div>

            <div id="simple-example" class="tab-content">
                <h3>Simple Data Grid</h3>
                <p>Basic implementation for simple data display without advanced features.</p>

                <h4>Minimal Setup</h4>
                <div class="code-block xml">
&lt;customGrid:CustomDataGrid 
    ItemsSource="{Binding SimpleData}"
    AutoGenerateColumns="True"
    IsMultiSelectEnabled="False"
    Margin="16" /&gt;</div>

                <h4>Data Model</h4>
                <div class="code-block csharp">
public class SimpleDataItem
{
    public string Name { get; set; } = string.Empty;
    public string Value { get; set; } = string.Empty;
    public DateTime CreatedDate { get; set; } = DateTime.Now;
    public bool IsActive { get; set; } = true;
}

// In your ViewModel
[ObservableProperty]
private ObservableCollection&lt;SimpleDataItem&gt; simpleData = new();

// Load data
private void LoadSimpleData()
{
    SimpleData.Clear();
    SimpleData.Add(new SimpleDataItem { Name = "Item 1", Value = "Value 1" });
    SimpleData.Add(new SimpleDataItem { Name = "Item 2", Value = "Value 2" });
}</div>
            </div>
        </div>

        <div class="card" id="advanced-features">
            <h2>âš¡ Advanced Features</h2>

            <div class="tabs">
                <button class="tab active" onclick="showTab('filtering-feature')">Filtering & Search</button>
                <button class="tab" onclick="showTab('column-management-feature')">Column Management</button>
                <button class="tab" onclick="showTab('export-import-feature')">Export/Import</button>
                <button class="tab" onclick="showTab('bulk-operations-feature')">Bulk Operations</button>
            </div>

            <div id="filtering-feature" class="tab-content active">
                <h3>Advanced Filtering and Search</h3>
                <p>Phase 5 features provide comprehensive filtering capabilities with real-time search and filter presets.</p>

                <h4>Enable Filtering</h4>
                <div class="code-block xml">
&lt;customGrid:CustomDataGrid 
    ItemsSource="{Binding YourData}"
    Columns="{Binding YourColumns}"
    EnableFiltering="True"
    FilterConfiguration="{Binding FilterConfig}"
    FilteredItemsSource="{Binding FilteredData, Mode=TwoWay}" /&gt;</div>

                <h4>Filter Configuration</h4>
                <div class="code-block csharp">
[ObservableProperty]
private FilterConfiguration filterConfig = new();

[ObservableProperty]
private IEnumerable filteredData = new ObservableCollection&lt;object&gt;();

// Configure filters
private void SetupFiltering()
{
    FilterConfig = new FilterConfiguration
    {
        EnableGlobalSearch = true,
        GlobalSearchColumns = new[] { "PartId", "Description", "Location" },
        ColumnFilters = new ObservableCollection&lt;ColumnFilter&gt;
        {
            new() { ColumnName = "Quantity", FilterType = FilterType.Numeric },
            new() { ColumnName = "CreatedDate", FilterType = FilterType.Date },
            new() { ColumnName = "IsActive", FilterType = FilterType.Boolean }
        }
    };
}</div>

                <h4>Filter Presets</h4>
                <div class="code-block csharp">
// Create filter presets for common scenarios
var lowStockPreset = new FilterPreset
{
    Name = "Low Stock Items",
    Description = "Items with quantity less than 10",
    Filters = new[]
    {
        new ColumnFilter { ColumnName = "Quantity", Operator = FilterOperator.LessThan, Value = "10" }
    }
};

// Apply preset
FilterConfig.ApplyPreset(lowStockPreset);</div>
            </div>

            <div id="column-management-feature" class="tab-content">
                <h3>Column Management</h3>
                <p>Phase 3 & 4 features allow users to customize column visibility, order, and sizing.</p>

                <h4>Enable Column Management</h4>
                <div class="code-block xml">
&lt;customGrid:CustomDataGrid 
    EnableColumnManagement="True"
    ColumnConfiguration="{Binding ColumnConfig}"
    IsColumnManagementVisible="{Binding ShowColumnManager}" /&gt;</div>

                <h4>Column Configuration</h4>
                <div class="code-block csharp">
[ObservableProperty]
private ColumnConfiguration columnConfig = new();

[ObservableProperty]
private bool showColumnManager;

// Setup column management
private void InitializeColumnManagement()
{
    ColumnConfig = new ColumnConfiguration
    {
        AllowReordering = true,
        AllowResizing = true,
        AllowHideShow = true,
        SaveConfigurationName = "MyViewLayout"
    };
}

// Save/Load configurations
[RelayCommand]
private async Task SaveLayoutAsync()
{
    try
    {
        await _gridService.SaveColumnConfigurationAsync(ColumnConfig);
        StatusMessage = "Layout saved successfully";
    }
    catch (Exception ex)
    {
        await ErrorHandling.HandleErrorAsync(ex, "Save layout");
    }
}</div>
            </div>

            <div id="export-import-feature" class="tab-content">
                <h3>Data Export and Import</h3>
                <p>Phase 6 features provide professional-grade data exchange capabilities.</p>

                <h4>Export Data</h4>
                <div class="code-block csharp">
[RelayCommand]
private async Task ExportToCsvAsync()
{
    try
    {
        var saveDialog = new SaveFileDialog
        {
            Title = "Export Data",
            DefaultExtension = "csv",
            Filters = new[] { new FileDialogFilter { Name = "CSV Files", Extensions = { "csv" } } }
        };

        var result = await saveDialog.ShowAsync(App.MainWindow);
        if (result != null)
        {
            var success = await _gridService.ExportDataAsync(
                YourDataCollection, 
                YourColumns, 
                result, 
                "csv");
                
            StatusMessage = success ? "Export completed" : "Export failed";
        }
    }
    catch (Exception ex)
    {
        await ErrorHandling.HandleErrorAsync(ex, "Export data");
    }
}

[RelayCommand]
private async Task ExportToExcelAsync()
{
    // Similar implementation for Excel export
    var success = await _gridService.ExportDataAsync(
        YourDataCollection, 
        YourColumns, 
        filePath, 
        "excel");
}</div>

                <h4>Import Data</h4>
                <div class="code-block csharp">
[RelayCommand]
private async Task ImportFromCsvAsync()
{
    try
    {
        var openDialog = new OpenFileDialog
        {
            Title = "Import Data",
            Filters = new[] { new FileDialogFilter { Name = "CSV Files", Extensions = { "csv" } } }
        };

        var result = await openDialog.ShowAsync(App.MainWindow);
        if (result?.Length > 0)
        {
            var importResult = await _gridService.ImportFromCsvAsync&lt;YourDataModel&gt;(
                result[0], 
                YourColumns);

            if (importResult.IsSuccess)
            {
                foreach (var item in importResult.ImportedItems)
                {
                    YourDataCollection.Add(item);
                }
                StatusMessage = $"Imported {importResult.ImportedItems.Count} items";
            }
            else
            {
                StatusMessage = $"Import failed: {importResult.ErrorSummary}";
            }
        }
    }
    catch (Exception ex)
    {
        await ErrorHandling.HandleErrorAsync(ex, "Import data");
    }
}</div>
            </div>

            <div id="bulk-operations-feature" class="tab-content">
                <h3>Bulk Operations</h3>
                <p>Phase 6 bulk operations allow efficient multi-row updates and deletions.</p>

                <h4>Enable Multi-Selection</h4>
                <div class="code-block xml">
&lt;customGrid:CustomDataGrid 
    IsMultiSelectEnabled="True"
    SelectedItems="{Binding SelectedItems}"
    SelectionMode="Multiple" /&gt;</div>

                <h4>Bulk Update Operations</h4>
                <div class="code-block csharp">
[ObservableProperty]
private ObservableCollection&lt;object&gt; selectedItems = new();

[RelayCommand]
private async Task BulkUpdateQuantityAsync()
{
    if (!SelectedItems.Any())
    {
        StatusMessage = "No items selected for update";
        return;
    }

    try
    {
        var updateData = new BulkUpdateData
        {
            FieldName = "Quantity",
            NewValue = NewQuantityValue,
            UpdateMode = BulkUpdateMode.Add // or Set, Multiply, etc.
        };

        var result = await _gridService.PerformBulkUpdateAsync(
            SelectedItems.Cast&lt;YourDataModel&gt;(), 
            updateData);

        if (result.IsSuccess)
        {
            // Refresh the grid data
            await LoadDataAsync();
            StatusMessage = $"Updated {result.UpdatedCount} items";
        }
    }
    catch (Exception ex)
    {
        await ErrorHandling.HandleErrorAsync(ex, "Bulk update");
    }
}

[RelayCommand]
private async Task BulkDeleteAsync()
{
    if (!SelectedItems.Any()) return;

    var confirmResult = await ShowConfirmationDialog(
        $"Delete {SelectedItems.Count} selected items?", 
        "Confirm Bulk Delete");
        
    if (!confirmResult) return;

    try
    {
        var result = await _gridService.PerformBulkDeleteAsync(
            SelectedItems.Cast&lt;YourDataModel&gt;());

        if (result.IsSuccess)
        {
            // Remove from collection
            foreach (var item in SelectedItems.Cast&lt;YourDataModel&gt;().ToList())
            {
                YourDataCollection.Remove(item);
            }
            
            SelectedItems.Clear();
            StatusMessage = $"Deleted {result.DeletedCount} items";
        }
    }
    catch (Exception ex)
    {
        await ErrorHandling.HandleErrorAsync(ex, "Bulk delete");
    }
}</div>
            </div>
        </div>

        <div class="card" id="copilot-prompts">
            <h2>ðŸ¤– GitHub Copilot Prompts</h2>
            
            <div class="alert info">
                <strong>Copy and paste these prompts into GitHub Copilot to generate specific implementations quickly.</strong>
            </div>

            <div class="scenario-selector">
                <label for="scenario-select">Select Implementation Scenario:</label>
                <select id="scenario-select" onchange="showScenario()">
                    <option value="basic-setup">Basic CustomDataGrid Setup</option>
                    <option value="inventory-grid">Inventory Management Grid</option>
                    <option value="transaction-grid">Transaction History Grid</option>
                    <option value="filtering-implementation">Advanced Filtering Implementation</option>
                    <option value="export-import">Export/Import Functionality</option>
                    <option value="bulk-operations">Bulk Operations Setup</option>
                    <option value="column-management">Column Management</option>
                    <option value="theme-integration">MTM Theme Integration</option>
                </select>
            </div>

            <div id="basic-setup" class="scenario-prompt">
                <h3>Basic CustomDataGrid Setup</h3>
                <div class="code-block">
@copilot create a basic MTM CustomDataGrid implementation for my View following these requirements:

1. **AXAML Requirements:**
   - Use ScrollViewer as root element with Grid RowDefinitions="*,Auto"
   - Add namespace: xmlns:customGrid="using:MTM_WIP_Application_Avalonia.Controls.CustomDataGrid"
   - Place CustomDataGrid in Grid.Row="0" with proper MTM spacing (Margin="16")
   - Add action buttons in Grid.Row="1" using StackPanel with Spacing="12"

2. **ViewModel Requirements:**
   - Use MVVM Community Toolkit with [ObservableObject] and [ObservableProperty]
   - Inherit from BaseViewModel with proper constructor injection
   - Include ICustomDataGridService dependency
   - Create ObservableCollection properties for data and columns
   - Add proper error handling with Services.ErrorHandling.HandleErrorAsync()

3. **Data Model:**
   - Create a simple data model class with 4-5 properties
   - Include validation attributes where appropriate
   - Follow MTM naming conventions

4. **Service Integration:**
   - Use _gridService.CreateInventoryColumnsAsync() or similar
   - Implement proper async loading patterns
   - Add status message updates

My data represents: [DESCRIBE YOUR DATA HERE]
My View is named: [YOUR_VIEW_NAME]
My ViewModel is named: [YOUR_VIEWMODEL_NAME]

Generate the complete implementation following MTM architecture patterns.
                </div>
            </div>

            <div id="inventory-grid" class="scenario-prompt" style="display: none;">
                <h3>Inventory Management Grid</h3>
                <div class="code-block">
@copilot create a complete inventory management CustomDataGrid implementation with these MTM requirements:

1. **Data Model Requirements:**
   - InventoryItem class with PartId, Operation, Quantity, Location, LastUpdated properties
   - Add validation attributes: Required, StringLength, Range for Quantity
   - Include audit fields (UserId, Timestamp, TransactionType)

2. **Grid Features:**
   - Enable multi-selection with IsMultiSelectEnabled="True"
   - Include filtering with EnableFiltering="True"
   - Add column management with EnableColumnManagement="True"
   - Support export functionality

3. **ViewModel Features:**
   - MVVM Community Toolkit patterns with [RelayCommand] for actions
   - Commands: AddItemCommand, EditItemCommand, DeleteItemCommand, ExportCommand
   - Proper dependency injection with ICustomDataGridService and IInventoryService
   - Error handling following MTM patterns

4. **AXAML Layout:**
   - Follow InventoryTabView pattern with ScrollViewer root
   - Action buttons for Add, Edit, Delete, Export operations
   - Status display for selection count and grid statistics
   - MTM theme integration with DynamicResource bindings

5. **Business Logic:**
   - Implement inventory CRUD operations
   - Add validation for inventory business rules
   - Include transaction logging for audit trail

Generate complete implementation with proper MTM architecture compliance.
                </div>
            </div>

            <div id="transaction-grid" class="scenario-prompt" style="display: none;">
                <h3>Transaction History Grid</h3>
                <div class="code-block">
@copilot create a transaction history CustomDataGrid implementation for MTM with:

1. **Transaction Model:**
   - TransactionRecord class with Id, PartId, Operation, Quantity, TransactionType (IN/OUT/TRANSFER)
   - Include UserId, Timestamp, Notes, Location properties
   - Add computed properties for display formatting

2. **Grid Configuration:**
   - Read-only grid (IsMultiSelectEnabled="False")
   - Advanced filtering by date range, user, transaction type
   - Sort by timestamp (newest first)
   - Context menu with View Details, Print, Export options

3. **Search and Filter Features:**
   - Global search across PartId, UserId, Notes
   - Date range filter with DatePicker controls
   - Transaction type dropdown filter
   - User selection filter

4. **ViewModel Implementation:**
   - TransactionHistoryViewModel with BaseViewModel inheritance
   - Commands: SearchCommand, ClearFiltersCommand, ExportCommand, PrintCommand
   - Dependency injection: ITransactionService, ICustomDataGridService
   - Async data loading with progress indication

5. **Export Functionality:**
   - Export to CSV and Excel with filtered data
   - Print preview capabilities
   - Email export options

6. **Performance:**
   - Implement paging for large transaction sets
   - Virtual scrolling for smooth performance
   - Debounced search input

Follow MTM architecture patterns and provide complete implementation.
                </div>
            </div>

            <div id="filtering-implementation" class="scenario-prompt" style="display: none;">
                <h3>Advanced Filtering Implementation</h3>
                <div class="code-block">
@copilot implement advanced filtering for CustomDataGrid following MTM Phase 5 patterns:

1. **FilterConfiguration Setup:**
   - Create FilterConfiguration with global search enabled
   - Configure column-specific filters for different data types
   - Implement filter presets for common scenarios
   - Add real-time filter statistics

2. **Filter Types to Implement:**
   - Text filters: contains, equals, starts with, ends with
   - Numeric filters: equals, greater than, less than, between
   - Date filters: equals, before, after, between, relative dates
   - Boolean filters: true/false selection
   - List filters: contains any, contains all

3. **Filter UI Components:**
   - Global search TextBox with debounced input
   - Column-specific filter controls based on data type
   - Filter preset ComboBox with built-in scenarios
   - Clear filters button and filter status display

4. **Business Logic:**
   - Implement filter application logic with proper performance
   - Add filter result caching for common queries
   - Include filter state persistence
   - Real-time filter result counts

5. **MTM Integration:**
   - Follow MVVM Community Toolkit patterns
   - Use proper dependency injection
   - Include error handling and logging
   - MTM theme compliance with DynamicResource

My data model is: [DESCRIBE YOUR DATA]
My key searchable fields are: [LIST FIELDS]
My common filter scenarios are: [DESCRIBE SCENARIOS]

Generate complete filtering implementation with ViewModel and AXAML.
                </div>
            </div>

            <div id="export-import" class="scenario-prompt" style="display: none;">
                <h3>Export/Import Functionality</h3>
                <div class="code-block">
@copilot implement comprehensive export/import functionality for CustomDataGrid using MTM Phase 6 patterns:

1. **Export Requirements:**
   - Support CSV and Excel formats
   - Export all data or filtered/selected data only
   - Include column header customization
   - Progress indication for large datasets
   - Error handling with user feedback

2. **Import Requirements:**
   - CSV and Excel file import with validation
   - Data validation against business rules
   - Error reporting with line-by-line feedback
   - Preview imported data before final import
   - Duplicate detection and handling

3. **Commands to Implement:**
   - ExportToCsvCommand, ExportToExcelCommand
   - ImportFromCsvCommand, ImportFromExcelCommand
   - ExportSelectedCommand for partial exports
   - PreviewImportCommand for data validation

4. **Service Integration:**
   - Use ICustomDataGridService for export/import operations
   - Implement proper async patterns with cancellation
   - Add progress reporting with IProgress&lt;T&gt;
   - Include comprehensive error logging

5. **UI Components:**
   - File dialogs with proper filters
   - Progress bars for long operations
   - Status messages for operation feedback
   - Export options (all/selected/filtered)

6. **Data Validation:**
   - Required field validation
   - Data type validation
   - Business rule validation
   - Duplicate detection

My data model: [YOUR_DATA_MODEL]
Required validation rules: [DESCRIBE RULES]
Export file naming convention: [DESCRIBE PATTERN]

Generate complete export/import implementation following MTM architecture.
                </div>
            </div>

            <div id="bulk-operations" class="scenario-prompt" style="display: none;">
                <h3>Bulk Operations Setup</h3>
                <div class="code-block">
@copilot implement bulk operations for CustomDataGrid following MTM Phase 6 enterprise patterns:

1. **Multi-Selection Setup:**
   - Enable multi-selection with checkboxes
   - Implement SelectableItem wrapper if needed
   - Add selection statistics display
   - Select all/none functionality

2. **Bulk Update Operations:**
   - Bulk field updates (quantity, location, status)
   - Mathematical operations (add, subtract, multiply)
   - Conditional updates based on current values
   - Validation before applying updates

3. **Bulk Delete Operations:**
   - Multi-item deletion with confirmation
   - Soft delete vs hard delete options
   - Undo functionality for accidental deletions
   - Audit trail for deleted items

4. **Commands to Implement:**
   - BulkUpdateCommand with parameter support
   - BulkDeleteCommand with confirmation
   - SelectAllCommand, SelectNoneCommand
   - UndoLastBulkOperationCommand

5. **UI Requirements:**
   - Bulk operation toolbar when items selected
   - Progress indication for large operations
   - Operation confirmation dialogs
   - Real-time selection count display

6. **Performance Considerations:**
   - Batch processing for large selections
   - Background processing with progress reporting
   - Memory-efficient operations
   - UI responsiveness during operations

7. **Error Handling:**
   - Partial success handling
   - Operation rollback on errors
   - Detailed error reporting per item
   - User notification of failed operations

My data model: [YOUR_DATA_MODEL]
Bulk operations needed: [LIST OPERATIONS]
Business validation rules: [DESCRIBE RULES]

Generate complete bulk operations implementation with proper MTM patterns.
                </div>
            </div>

            <div id="column-management" class="scenario-prompt" style="display: none;">
                <h3>Column Management</h3>
                <div class="code-block">
@copilot implement comprehensive column management for CustomDataGrid using MTM Phase 3 & 4 patterns:

1. **Column Configuration:**
   - ColumnConfiguration model with visibility, order, width settings
   - Column reordering with drag-and-drop or button controls
   - Column resizing with interactive handles
   - Show/hide column toggles

2. **Configuration Persistence:**
   - Save/load named column layouts
   - User-specific configuration storage
   - Default configuration reset
   - Configuration sharing between views

3. **Column Management UI:**
   - Column management panel with toggle visibility
   - Column width controls (auto, fixed, percentage)
   - Reorder buttons (left, right, start, end)
   - Quick actions (show all, hide all, reset)

4. **Interactive Features:**
   - Real-time column statistics
   - Preview of configuration changes
   - Configuration validation
   - Undo/redo for column changes

5. **Commands to Implement:**
   - ToggleColumnVisibilityCommand
   - ReorderColumnCommand
   - ResizeColumnCommand
   - SaveConfigurationCommand
   - LoadConfigurationCommand
   - ResetColumnsCommand

6. **Service Integration:**
   - Use ICustomDataGridService for configuration persistence
   - Implement configuration validation
   - Add configuration versioning
   - Include user preference storage

7. **MTM Integration:**
   - Follow MVVM Community Toolkit patterns
   - MTM theme compliance
   - Proper error handling
   - User feedback for all operations

My columns represent: [DESCRIBE COLUMNS]
Default column order: [LIST ORDER]
Required always-visible columns: [LIST REQUIRED]

Generate complete column management implementation with ViewModel and AXAML.
                </div>
            </div>

            <div id="theme-integration" class="scenario-prompt" style="display: none;">
                <h3>MTM Theme Integration</h3>
                <div class="code-block">
@copilot implement proper MTM theme integration for CustomDataGrid following established design patterns:

1. **Theme Resource Usage:**
   - Use DynamicResource bindings for all MTM_Shared_Logic.* resources
   - Implement proper color scheme compliance
   - Support all MTM theme variants (Blue, Green, Dark, Red)
   - Ensure proper contrast ratios

2. **Color Implementation:**
   - Primary actions: MTM_Shared_Logic.PrimaryAction (#0078D4)
   - Secondary actions: MTM_Shared_Logic.SecondaryAction
   - Backgrounds: MTM_Shared_Logic.CardBackgroundBrush, MainBackground
   - Text: MTM_Shared_Logic.HeadingText, BodyText, TertiaryTextBrush
   - Interactive: MTM_Shared_Logic.InteractiveText, HoverBackground

3. **Component Styling:**
   - Grid headers with proper MTM header styling
   - Data cells with hover and selection states
   - Button styling following MTM button classes
   - Input controls with MTM focus indicators

4. **Style Classes to Implement:**
   - .mtm-header-cell for grid headers
   - .mtm-data-cell for data rows
   - .mtm-selected for selected rows
   - .mtm-hover for hover states

5. **Responsive Design:**
   - Proper spacing using MTM spacing system (8px, 16px, 24px)
   - Font sizes following MTM typography scale
   - Icon sizing and spacing
   - Mobile-friendly touch targets

6. **Accessibility:**
   - High contrast mode support
   - Screen reader friendly markup
   - Keyboard navigation support
   - Focus indicators

7. **Theme Service Integration:**
   - IThemeService dependency if needed
   - Theme change event handling
   - Dynamic resource updates
   - Theme persistence

Generate complete theme integration with proper AXAML styles and theme compliance.
                </div>
            </div>
        </div>

        <div class="card" id="troubleshooting">
            <h2>ðŸ”§ Troubleshooting</h2>

            <h3>Common Issues and Solutions</h3>

            <div class="alert warning">
                <strong>AVLN2000 Compilation Error</strong><br>
                Ensure you're using <code>x:Name</code> instead of <code>Name</code> on Grid definitions and proper xmlns namespace.
            </div>

            <h4>1. Grid Not Displaying Data</h4>
            <div class="code-block">
âœ… Check ItemsSource binding: ItemsSource="{Binding YourDataCollection}"
âœ… Verify ViewModel property is [ObservableProperty] with proper naming
âœ… Ensure data collection is ObservableCollection&lt;T&gt;
âœ… Check that columns are properly defined
âœ… Verify DataContext is set correctly</div>

            <h4>2. Columns Not Showing</h4>
            <div class="code-block">
âœ… Create columns using _gridService.CreateInventoryColumnsAsync()
âœ… Set Columns property: Columns="{Binding YourColumnDefinitions}"
âœ… Ensure column bindings match your data model properties
âœ… Check column visibility settings</div>

            <h4>3. MTM Theme Not Applied</h4>
            <div class="code-block">
âœ… Use DynamicResource for all color bindings
âœ… Verify MTM_Shared_Logic.* resources are available
âœ… Check that theme service is properly registered
âœ… Ensure proper Style selectors are used</div>

            <h4>4. Service Not Registered</h4>
            <div class="code-block">
âœ… Add to ServiceCollectionExtensions.cs:
   services.TryAddScoped&lt;ICustomDataGridService, CustomDataGridService&gt;();
âœ… Verify constructor injection in ViewModel
âœ… Check that ArgumentNullException.ThrowIfNull() is used</div>

            <h4>5. Performance Issues</h4>
            <div class="code-block">
âœ… Enable virtual scrolling (enabled by default)
âœ… Use debounced search input (300ms default)
âœ… Implement proper filtering logic
âœ… Consider data paging for very large datasets</div>

            <h3>Getting Help</h3>
            <p>If you encounter issues not covered here:</p>
            <ul>
                <li>Check the <code>CustomDataGridDemo.axaml</code> for working examples</li>
                <li>Review the <code>RemoveTabView.axaml</code> for MTM View patterns</li>
                <li>Use the GitHub Copilot prompts above for quick implementations</li>
                <li>Follow MTM architecture patterns from the copilot instructions</li>
            </ul>

            <div class="alert success">
                <strong>Success Tips:</strong><br>
                â€¢ Always follow the InventoryTabView pattern with ScrollViewer and RowDefinitions="*,Auto"<br>
                â€¢ Use MVVM Community Toolkit patterns consistently<br>
                â€¢ Include proper error handling with Services.ErrorHandling.HandleErrorAsync()<br>
                â€¢ Test with the demo implementation first to understand the patterns
            </div>
        </div>

        <div style="text-align: center; padding: 40px; color: var(--mtm-text-secondary); border-top: 1px solid var(--mtm-border); margin-top: 40px;">
            <p><strong>MTM CustomDataGrid Implementation Guide</strong></p>
            <p>Enterprise-Grade Data Grid Control for MTM WIP Application</p>
            <p>Generated: <span id="current-date"></span></p>
        </div>
    </div>

    <script>
        // Set current date
        document.getElementById('current-date').textContent = new Date().toLocaleDateString();

        // Tab functionality
        function showTab(tabId) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));

            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Show selected tab content
            document.getElementById(tabId).classList.add('active');

            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Scenario prompt functionality
        function showScenario() {
            const select = document.getElementById('scenario-select');
            const selectedValue = select.value;

            // Hide all scenario prompts
            const prompts = document.querySelectorAll('.scenario-prompt');
            prompts.forEach(prompt => prompt.style.display = 'none');

            // Show selected scenario
            const selectedPrompt = document.getElementById(selectedValue);
            if (selectedPrompt) {
                selectedPrompt.style.display = 'block';
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            showScenario(); // Show default scenario
        });

        // Copy code block functionality
        document.querySelectorAll('.code-block').forEach(block => {
            block.addEventListener('click', function() {
                navigator.clipboard.writeText(this.textContent).then(() => {
                    // Show copy feedback
                    const originalBorder = this.style.border;
                    this.style.border = '2px solid var(--mtm-success)';
                    setTimeout(() => {
                        this.style.border = originalBorder;
                    }, 1000);
                });
            });
        });
    </script>
</body>
</html>