<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Result.cs - Technical Documentation | MTM WIP Application</title>
    <link rel="stylesheet" href="../../../styles.css">
</head>
<body>
    <div class="container">
        <header>
            <nav class="breadcrumb">
                <a href="../../../index.html">üìö Documentation Hub</a>
                <span>‚Ä∫</span>
                <a href="../../index.html">üîß Technical</a>
                <span>‚Ä∫</span>
                <a href="../index.html">üìÑ File Definitions</a>
                <span>‚Ä∫</span>
                <a href="index.html">Models</a>
                <span>‚Ä∫</span>
                <span>Result</span>
            </nav>
            <div class="file-header">
                <h1>üîß Result.cs - Technical Documentation</h1>
                <div class="file-meta">
                    <span class="file-type">Data Models & Patterns</span>
                    <span class="complexity">üü° Medium Complexity</span>
                    <span class="maintainability">üü¢ High Maintainability</span>
                </div>
            </div>
        </header>

        <main>
            <!-- Overview -->
            <section class="hero-section">
                <div class="card">
                    <h2>üìã File Overview</h2>
                    <div class="class-signature">
                        <pre><code>namespace MTM.Models
{
    public class Result { ... }
    public class Result&lt;T&gt; : Result { ... }
    public class QuickButtonItem { ... }
}</code></pre>
                    </div>
                    <p>This file implements the Result pattern for operation outcome handling and defines the QuickButtonItem model for UI preset functionality. Framework-agnostic design ensures compatibility across different .NET application types.</p>
                </div>
            </section>

            <!-- Architecture & Patterns -->
            <section>
                <h2>üèóÔ∏è Architecture & Design Patterns</h2>
                <div class="grid-2">
                    <div class="card">
                        <h3>üìê Design Patterns</h3>
                        <ul>
                            <li><strong>Result Pattern:</strong> Explicit success/failure handling without exceptions</li>
                            <li><strong>Generic Type Pattern:</strong> Result&lt;T&gt; for typed return values</li>
                            <li><strong>Factory Pattern:</strong> Static factory methods for object creation</li>
                            <li><strong>Inheritance Pattern:</strong> Result&lt;T&gt; extends base Result class</li>
                            <li><strong>Implicit Conversion:</strong> Automatic conversion from T to Result&lt;T&gt;</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h3>üéØ Domain Model</h3>
                        <ul>
                            <li><strong>Operation Outcomes:</strong> Standardized success/failure representation</li>
                            <li><strong>Error Propagation:</strong> Consistent error handling across layers</li>
                            <li><strong>UI Presets:</strong> QuickButtonItem for user workflow optimization</li>
                            <li><strong>MTM Operations:</strong> Operation numbers as string workflow identifiers</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Result Class API -->
            <section>
                <h2>üìö Result Class API</h2>
                
                <!-- Properties -->
                <div class="card">
                    <h3>üè∑Ô∏è Properties</h3>
                    <div class="property-grid">
                        <div class="property-card">
                            <h4>IsSuccess</h4>
                            <pre><code>public bool IsSuccess { get; protected set; }</code></pre>
                            <p><strong>Purpose:</strong> Indicates if the operation succeeded</p>
                            <p><strong>Access:</strong> Read-only from external code, settable by derived classes</p>
                        </div>
                        
                        <div class="property-card">
                            <h4>IsFailure</h4>
                            <pre><code>public bool IsFailure => !IsSuccess;</code></pre>
                            <p><strong>Purpose:</strong> Computed property for failure state</p>
                            <p><strong>Access:</strong> Read-only, automatically derived from IsSuccess</p>
                        </div>
                        
                        <div class="property-card">
                            <h4>ErrorMessage</h4>
                            <pre><code>public string? ErrorMessage { get; protected set; }</code></pre>
                            <p><strong>Purpose:</strong> Human-readable error description</p>
                            <p><strong>Nullability:</strong> Null for successful operations</p>
                        </div>
                        
                        <div class="property-card">
                            <h4>Exception</h4>
                            <pre><code>public Exception? Exception { get; protected set; }</code></pre>
                            <p><strong>Purpose:</strong> Original exception for detailed debugging</p>
                            <p><strong>Nullability:</strong> Null if no exception occurred</p>
                        </div>
                    </div>
                </div>

                <!-- Factory Methods -->
                <div class="card">
                    <h3>üè≠ Factory Methods</h3>
                    
                    <div class="method-card">
                        <div class="method-signature">
                            <pre><code>public static Result Success()</code></pre>
                        </div>
                        <div class="method-details">
                            <h4>Returns</h4>
                            <p>A successful Result instance with IsSuccess = true</p>
                            <h4>Usage Example</h4>
                            <pre><code>public async Task&lt;Result&gt; DeleteItemAsync(string itemId)
{
    try
    {
        await database.DeleteAsync(itemId);
        return Result.Success();
    }
    catch (Exception ex)
    {
        return Result.Failure(ex);
    }
}</code></pre>
                        </div>
                    </div>

                    <div class="method-card">
                        <div class="method-signature">
                            <pre><code>public static Result Failure(string errorMessage)</code></pre>
                        </div>
                        <div class="method-details">
                            <h4>Parameters</h4>
                            <ul>
                                <li><code>errorMessage</code> (string): User-friendly error description</li>
                            </ul>
                            <h4>Usage Example</h4>
                            <pre><code>if (string.IsNullOrEmpty(partId))
{
    return Result.Failure("Part ID cannot be empty");
}</code></pre>
                        </div>
                    </div>

                    <div class="method-card">
                        <div class="method-signature">
                            <pre><code>public static Result Failure(Exception exception)</code></pre>
                        </div>
                        <div class="method-details">
                            <h4>Parameters</h4>
                            <ul>
                                <li><code>exception</code> (Exception): Original exception with full stack trace</li>
                            </ul>
                            <h4>Behavior</h4>
                            <ul>
                                <li>ErrorMessage is set to exception.Message</li>
                                <li>Exception property preserves full exception details</li>
                            </ul>
                        </div>
                    </div>

                    <div class="method-card">
                        <div class="method-signature">
                            <pre><code>public static Result Failure(string errorMessage, Exception exception)</code></pre>
                        </div>
                        <div class="method-details">
                            <h4>Parameters</h4>
                            <ul>
                                <li><code>errorMessage</code> (string): Custom user-friendly message</li>
                                <li><code>exception</code> (Exception): Original exception for debugging</li>
                            </ul>
                            <h4>Use Case</h4>
                            <p>When you want to provide a custom error message while preserving technical details</p>
                            <pre><code>catch (SqlException ex)
{
    return Result.Failure("Database connection failed", ex);
}</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Generic Result<T> API -->
            <section>
                <h2>üìö Result&lt;T&gt; Class API</h2>
                
                <div class="card">
                    <h3>üè∑Ô∏è Additional Properties</h3>
                    <div class="property-card">
                        <h4>Value</h4>
                        <pre><code>public T? Value { get; private set; }</code></pre>
                        <p><strong>Purpose:</strong> The actual data returned on successful operations</p>
                        <p><strong>Access:</strong> Read-only, set only through factory methods</p>
                        <p><strong>Nullability:</strong> Null for failed operations, contains value for successful operations</p>
                    </div>
                </div>

                <div class="card">
                    <h3>üè≠ Generic Factory Methods</h3>
                    
                    <div class="method-card">
                        <div class="method-signature">
                            <pre><code>public static Result&lt;T&gt; Success(T value)</code></pre>
                        </div>
                        <div class="method-details">
                            <h4>Parameters</h4>
                            <ul>
                                <li><code>value</code> (T): The data to return on success</li>
                            </ul>
                            <h4>Usage Examples</h4>
                            <pre><code>// Return inventory item
public async Task&lt;Result&lt;InventoryItem&gt;&gt; GetItemAsync(string partId)
{
    var item = await database.GetItemAsync(partId);
    return Result&lt;InventoryItem&gt;.Success(item);
}

// Return collection
public async Task&lt;Result&lt;List&lt;Transaction&gt;&gt;&gt; GetTransactionsAsync()
{
    var transactions = await database.GetTransactionsAsync();
    return Result&lt;List&lt;Transaction&gt;&gt;.Success(transactions);
}</code></pre>
                        </div>
                    </div>

                    <div class="method-card">
                        <div class="method-signature">
                            <pre><code>public static implicit operator Result&lt;T&gt;(T value)</code></pre>
                        </div>
                        <div class="method-details">
                            <h4>Purpose</h4>
                            <p>Allows automatic conversion from any value to a successful Result&lt;T&gt;</p>
                            <h4>Usage Example</h4>
                            <pre><code>public Result&lt;string&gt; GetMessage()
{
    // Implicit conversion - these are equivalent:
    return "Hello World";  // Implicit
    return Result&lt;string&gt;.Success("Hello World");  // Explicit
}</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- QuickButtonItem Model -->
            <section>
                <h2>‚ö° QuickButtonItem Model</h2>
                
                <div class="card">
                    <h3>üìã Model Definition</h3>
                    <pre><code>public class QuickButtonItem
{
    public int Position { get; set; }        // 1-10 button slots
    public string PartId { get; set; }       // Part identifier
    public string Operation { get; set; }    // Workflow step number
    public int Quantity { get; set; }        // Default quantity
    public string DisplayText { get; set; }  // Button label text
    public DateTime LastUsed { get; set; }   // Usage tracking
    public int UsageCount { get; set; }      // Popularity metric
    public bool IsActive { get; set; }       // Enable/disable state
}</code></pre>
                </div>

                <div class="card">
                    <h3>üè∑Ô∏è Property Details</h3>
                    <div class="property-grid">
                        <div class="property-card">
                            <h4>Position</h4>
                            <p><strong>Type:</strong> int</p>
                            <p><strong>Range:</strong> 1-10 (corresponding to UI button positions)</p>
                            <p><strong>Purpose:</strong> Determines button placement in UI grid</p>
                        </div>
                        
                        <div class="property-card">
                            <h4>PartId</h4>
                            <p><strong>Type:</strong> string</p>
                            <p><strong>Format:</strong> Alphanumeric part identifier (e.g., "SHAFT001", "BEARING025")</p>
                            <p><strong>Purpose:</strong> Links button to specific inventory part</p>
                        </div>
                        
                        <div class="property-card">
                            <h4>Operation</h4>
                            <p><strong>Type:</strong> string (NOT enum)</p>
                            <p><strong>Format:</strong> Numeric string ("90", "100", "110")</p>
                            <p><strong>MTM Rule:</strong> Workflow step identifier, NOT transaction type indicator</p>
                        </div>
                        
                        <div class="property-card">
                            <h4>Quantity</h4>
                            <p><strong>Type:</strong> int</p>
                            <p><strong>Purpose:</strong> Default quantity when button is clicked</p>
                            <p><strong>Validation:</strong> Should be positive integer</p>
                        </div>
                        
                        <div class="property-card">
                            <h4>DisplayText</h4>
                            <p><strong>Type:</strong> string</p>
                            <p><strong>Format:</strong> Human-readable button label</p>
                            <p><strong>Example:</strong> "Add 50x SHAFT001 (Op 90)"</p>
                        </div>
                        
                        <div class="property-card">
                            <h4>LastUsed</h4>
                            <p><strong>Type:</strong> DateTime</p>
                            <p><strong>Purpose:</strong> Track recent usage for optimization</p>
                            <p><strong>Updates:</strong> Set whenever button is clicked</p>
                        </div>
                        
                        <div class="property-card">
                            <h4>UsageCount</h4>
                            <p><strong>Type:</strong> int</p>
                            <p><strong>Purpose:</strong> Popularity metric for button optimization</p>
                            <p><strong>Updates:</strong> Incremented on each use</p>
                        </div>
                        
                        <div class="property-card">
                            <h4>IsActive</h4>
                            <p><strong>Type:</strong> bool</p>
                            <p><strong>Purpose:</strong> Enable/disable button without deletion</p>
                            <p><strong>Default:</strong> true</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Usage Patterns -->
            <section>
                <h2>üéØ Usage Patterns</h2>
                
                <div class="card">
                    <h3>‚úÖ Service Layer Implementation</h3>
                    <pre><code>public class InventoryService
{
    public async Task&lt;Result&lt;InventoryItem&gt;&gt; AddItemAsync(string partId, int quantity)
    {
        try
        {
            // Validation
            if (string.IsNullOrEmpty(partId))
                return Result&lt;InventoryItem&gt;.Failure("Part ID is required");
            
            if (quantity &lt;= 0)
                return Result&lt;InventoryItem&gt;.Failure("Quantity must be positive");
            
            // Database operation
            var result = await _database.AddInventoryAsync(partId, quantity);
            
            if (result.IsSuccess)
            {
                var item = await _database.GetItemAsync(partId);
                return Result&lt;InventoryItem&gt;.Success(item);
            }
            
            return Result&lt;InventoryItem&gt;.Failure(result.ErrorMessage);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Failed to add inventory item {PartId}", partId);
            return Result&lt;InventoryItem&gt;.Failure("Database error occurred", ex);
        }
    }
}</code></pre>
                </div>

                <div class="card">
                    <h3>‚úÖ ViewModel Result Handling</h3>
                    <pre><code>public class InventoryViewModel : BaseViewModel
{
    private async Task ExecuteAddItemAsync()
    {
        var result = await _inventoryService.AddItemAsync(PartId, Quantity);
        
        if (result.IsSuccess)
        {
            // Update UI with successful result
            Items.Add(result.Value);
            StatusMessage = "Item added successfully";
            Logger.LogInformation("Added {Quantity} of {PartId}", Quantity, PartId);
        }
        else
        {
            // Handle failure
            StatusMessage = result.ErrorMessage;
            Logger.LogWarning("Failed to add item: {Error}", result.ErrorMessage);
            
            // Log detailed error for debugging
            if (result.Exception != null)
            {
                Logger.LogError(result.Exception, "Detailed error for {PartId}", PartId);
            }
        }
    }
}</code></pre>
                </div>

                <div class="card">
                    <h3>‚úÖ QuickButtonItem Usage</h3>
                    <pre><code>public class QuickButtonService
{
    public async Task&lt;Result&lt;List&lt;QuickButtonItem&gt;&gt;&gt; GetActiveButtonsAsync()
    {
        try
        {
            var buttons = await _database.GetQuickButtonsAsync();
            var activeButtons = buttons
                .Where(b => b.IsActive)
                .OrderBy(b => b.Position)
                .ToList();
            
            return Result&lt;List&lt;QuickButtonItem&gt;&gt;.Success(activeButtons);
        }
        catch (Exception ex)
        {
            return Result&lt;List&lt;QuickButtonItem&gt;&gt;.Failure(ex);
        }
    }
    
    public async Task&lt;Result&gt; UpdateUsageAsync(int position)
    {
        try
        {
            var button = await _database.GetButtonByPositionAsync(position);
            if (button == null)
                return Result.Failure($"Button at position {position} not found");
            
            button.LastUsed = DateTime.Now;
            button.UsageCount++;
            
            await _database.UpdateButtonAsync(button);
            return Result.Success();
        }
        catch (Exception ex)
        {
            return Result.Failure("Failed to update button usage", ex);
        }
    }
}</code></pre>
                </div>
            </section>

            <!-- MTM-Specific Considerations -->
            <section>
                <h2>üè≠ MTM-Specific Implementation Notes</h2>
                <div class="grid-2">
                    <div class="card">
                        <h3>‚ö†Ô∏è Critical MTM Rules</h3>
                        <ul>
                            <li><strong>Operation Numbers:</strong> Always strings ("90", "100", "110"), never integers</li>
                            <li><strong>Transaction Types:</strong> Determined by user intent, NOT operation number</li>
                            <li><strong>Part IDs:</strong> Alphanumeric strings, case-sensitive</li>
                            <li><strong>Database Operations:</strong> Always use stored procedures, never direct SQL</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h3>üéØ Performance Considerations</h3>
                        <ul>
                            <li><strong>Result Pattern:</strong> No exceptions for expected failures</li>
                            <li><strong>Implicit Conversion:</strong> Minimal overhead for value ‚Üí Result&lt;T&gt;</li>
                            <li><strong>Memory Efficiency:</strong> Lightweight Result objects</li>
                            <li><strong>Quick Buttons:</strong> Cache active buttons for UI performance</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Testing -->
            <section>
                <h2>üß™ Testing Patterns</h2>
                <div class="card">
                    <h3>üìã Unit Testing Examples</h3>
                    <pre><code>[Test]
public void Result_Success_SetsPropertiesCorrectly()
{
    // Act
    var result = Result.Success();
    
    // Assert
    Assert.IsTrue(result.IsSuccess);
    Assert.IsFalse(result.IsFailure);
    Assert.IsNull(result.ErrorMessage);
    Assert.IsNull(result.Exception);
}

[Test]
public void Result_Generic_Success_ReturnsValue()
{
    // Arrange
    var expectedValue = "test value";
    
    // Act
    var result = Result&lt;string&gt;.Success(expectedValue);
    
    // Assert
    Assert.IsTrue(result.IsSuccess);
    Assert.AreEqual(expectedValue, result.Value);
}

[Test]
public void Result_ImplicitConversion_Works()
{
    // Act
    Result&lt;int&gt; result = 42;  // Implicit conversion
    
    // Assert
    Assert.IsTrue(result.IsSuccess);
    Assert.AreEqual(42, result.Value);
}

[Test]
public void QuickButtonItem_DefaultValues_AreValid()
{
    // Act
    var button = new QuickButtonItem();
    
    // Assert
    Assert.AreEqual(string.Empty, button.PartId);
    Assert.AreEqual(string.Empty, button.Operation);
    Assert.IsTrue(button.IsActive);  // Default should be true
}</code></pre>
                </div>
            </section>

            <!-- Navigation -->
            <section class="navigation-section">
                <h2>üß≠ Related Documentation</h2>
                <div class="nav-grid">
                    <a href="../../../PlainEnglish/FileDefinitions/Models/Result.html" class="nav-card plain-english">
                        <span class="nav-icon">üìñ</span>
                        <div class="nav-content">
                            <h3>Plain English Guide</h3>
                            <p>Business-friendly explanation</p>
                        </div>
                    </a>
                    <a href="../Services/InventoryService.html" class="nav-card">
                        <span class="nav-icon">‚öôÔ∏è</span>
                        <div class="nav-content">
                            <h3>InventoryService</h3>
                            <p>How services use Result pattern</p>
                        </div>
                    </a>
                    <a href="../ViewModels/BaseViewModel.html" class="nav-card">
                        <span class="nav-icon">üéØ</span>
                        <div class="nav-content">
                            <h3>BaseViewModel</h3>
                            <p>How ViewModels handle Results</p>
                        </div>
                    </a>
                </div>
            </section>
        </main>

        <footer>
            <div class="file-info">
                <div class="file-path">
                    <strong>File:</strong> <code>Models/Result.cs</code>
                </div>
                <div class="last-updated">
                    <strong>Namespace:</strong> <code>MTM.Models</code>
                </div>
            </div>
        </footer>
    </div>

    <!-- Copy to Clipboard & Keyboard Navigation -->
    <script>
        document.querySelectorAll('pre code').forEach(block => {
            block.addEventListener('click', () => {
                navigator.clipboard.writeText(block.textContent).then(() => {
                    block.style.background = '#d4edda';
                    setTimeout(() => {
                        block.style.background = '';
                    }, 1000);
                });
            });
        });

        document.addEventListener('keydown', function(event) {
            if (event.altKey) {
                switch(event.key) {
                    case 'p':
                    case 'P':
                        event.preventDefault();
                        window.location.href = '../../../PlainEnglish/FileDefinitions/Models/Result.html';
                        break;
                    case 'h':
                    case 'H':
                        event.preventDefault();
                        window.location.href = '../../../index.html';
                        break;
                }
            }
        });
    </script>
</body>
</html>