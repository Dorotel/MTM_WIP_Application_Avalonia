<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CoreModels.cs - Technical Documentation</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1a1a1a;
            color: #ffffff;
            line-height: 1.6;
        }
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: #ecf0f1;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            border-left: 5px solid #3498db;
        }
        .nav-section {
            background: rgba(52, 152, 219, 0.1);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            border-left: 4px solid #3498db;
        }
        .nav-button {
            background: #3498db;
            color: white;
            padding: 0.75rem 1.5rem;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            margin-right: 1rem;
            margin-bottom: 0.5rem;
            display: inline-block;
            transition: all 0.3s ease;
        }
        .nav-button:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }
        .content-section {
            background: #2c2c2c;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            border-left: 4px solid #3498db;
        }
        .highlight {
            background: #f39c12;
            color: #2c3e50;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            font-weight: bold;
        }
        .code-block {
            background: #1e1e1e;
            border: 1px solid #3498db;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
        }
        .method-signature {
            background: #34495e;
            border-left: 4px solid #e74c3c;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
            font-family: 'Courier New', monospace;
        }
        .parameter-list {
            background: #2c3e50;
            padding: 1rem;
            border-radius: 5px;
            margin: 0.5rem 0;
        }
        .return-info {
            background: #27ae60;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            margin: 0.5rem 0;
            font-weight: bold;
        }
        .warning-box {
            background: #e74c3c;
            color: white;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            font-weight: bold;
        }
        .info-box {
            background: #3498db;
            color: white;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }
        h1, h2, h3 { color: #3498db; }
        .metric { 
            background: #34495e; 
            padding: 0.5rem; 
            border-radius: 5px; 
            display: inline-block; 
            margin: 0.25rem;
            border: 1px solid #3498db;
        }
        .model-category {
            background: rgba(52, 152, 219, 0.1);
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1.5rem 0;
            border: 1px solid rgba(52, 152, 219, 0.3);
        }
        .model-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        .model-card {
            background: #34495e;
            padding: 1rem;
            border-radius: 8px;
            border-left: 3px solid #3498db;
        }
        .property-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            background: #2c3e50;
        }
        .property-table th, .property-table td {
            border: 1px solid #3498db;
            padding: 0.75rem;
            text-align: left;
        }
        .property-table th {
            background: #3498db;
            color: white;
            font-weight: bold;
        }
        .enum-value {
            background: #8e44ad;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 3px;
            font-family: monospace;
            margin: 0.25rem;
            display: inline-block;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üèóÔ∏è CoreModels.cs - Technical Documentation</h1>
        <p><strong>File:</strong> Models/CoreModels.cs</p>
        <p><strong>Namespace:</strong> MTM.Models</p>
        <p><strong>Purpose:</strong> Comprehensive data model library for MTM WIP Application</p>
    </div>

    <div class="nav-section">
        <h3>üìã Quick Navigation</h3>
        <a href="../../../PlainEnglish/FileDefinitions/Models/CoreModels.html" class="nav-button" accesskey="p">üìñ Plain English (Alt+P)</a>
        <a href="../../index.html" class="nav-button">üìö Documentation Home</a>
        <a href="../../../index.html" class="nav-button">üè† Main Documentation</a>
    </div>

    <div class="content-section">
        <h2>üìù Overview</h2>
        <p>CoreModels.cs defines the complete data model foundation for the MTM WIP Application, containing 25+ business entities organized into 6 logical categories. All models follow MTM-specific business conventions and include compatibility layers for legacy code integration.</p>

        <div class="highlight">
            üîß <strong>Technical Pattern:</strong> Domain-Driven Design with business rule enforcement, property compatibility aliases, and JSON serialization support for API communication.
        </div>

        <h3>üìä Statistics</h3>
        <div class="metric">25+ Models</div>
        <div class="metric">6 Categories</div>
        <div class="metric">2 Enums</div>
        <div class="metric">JSON Ready</div>
        <div class="metric">Database Mapped</div>
    </div>

    <div class="model-category">
        <h2>üë• User Management Models</h2>
        <p>Complete user administration system with role-based access control.</p>

        <div class="model-grid">
            <div class="model-card">
                <h4>User Model</h4>
                <div class="method-signature">
                    public class User<br>
                    Maps to: usr_users table
                </div>
                <table class="property-table">
                    <tr><th>Property</th><th>Type</th><th>Description</th></tr>
                    <tr><td>ID</td><td>int</td><td>Primary key</td></tr>
                    <tr><td>User_Name</td><td>string</td><td>Username (database column 'User')</td></tr>
                    <tr><td>UserName</td><td>string</td><td>Compatibility alias => User_Name</td></tr>
                    <tr><td>UserId</td><td>string?</td><td>Compatibility alias => User_Name</td></tr>
                    <tr><td>FullName</td><td>string?</td><td>Display name</td></tr>
                    <tr><td>Shift</td><td>string</td><td>Work shift (default "1")</td></tr>
                    <tr><td>VitsUser</td><td>bool</td><td>VITS system integration flag</td></tr>
                    <tr><td>Theme_Name</td><td>string</td><td>UI theme preference</td></tr>
                    <tr><td>WipServerAddress</td><td>string</td><td>Database server connection</td></tr>
                </table>
            </div>
            <div class="model-card">
                <h4>Role Model</h4>
                <div class="method-signature">
                    public class Role<br>
                    Maps to: sys_roles table
                </div>
                <table class="property-table">
                    <tr><th>Property</th><th>Type</th><th>Description</th></tr>
                    <tr><td>ID</td><td>int</td><td>Primary key</td></tr>
                    <tr><td>RoleName</td><td>string</td><td>Role identifier</td></tr>
                    <tr><td>Description</td><td>string?</td><td>Role description</td></tr>
                    <tr><td>Permissions</td><td>string?</td><td>JSON permissions string</td></tr>
                    <tr><td>IsSystem</td><td>bool</td><td>System role flag</td></tr>
                    <tr><td>CreatedBy</td><td>string</td><td>Creator username</td></tr>
                    <tr><td>CreatedAt</td><td>DateTime</td><td>Creation timestamp</td></tr>
                </table>
            </div>
        </div>
    </div>

    <div class="model-category">
        <h2>üì¶ Inventory Core Models</h2>
        <p>The foundation of MTM inventory tracking with complete transaction audit trails.</p>

        <div class="warning-box">
            üö® <strong>Critical Business Rule:</strong> Operations are string numbers ("90", "100", "110") representing workflow steps, NOT transaction type indicators. TransactionType is determined by user intent.
        </div>

        <div class="model-grid">
            <div class="model-card">
                <h4>InventoryItem Model</h4>
                <div class="method-signature">
                    public class InventoryItem<br>
                    Maps to: inv_inventory table
                </div>
                <table class="property-table">
                    <tr><th>Property</th><th>Type</th><th>Description</th></tr>
                    <tr><td>ID</td><td>int</td><td>Primary key</td></tr>
                    <tr><td>PartID</td><td>string</td><td>Part identifier (string)</td></tr>
                    <tr><td>PartId</td><td>string</td><td>Compatibility alias => PartID</td></tr>
                    <tr><td>Location</td><td>string</td><td>Storage location</td></tr>
                    <tr><td>Operation</td><td>string?</td><td>Workflow step number</td></tr>
                    <tr><td>Quantity</td><td>int</td><td>Item count</td></tr>
                    <tr><td>ItemType</td><td>string</td><td>Item classification</td></tr>
                    <tr><td>ReceiveDate</td><td>DateTime</td><td>Initial receipt time</td></tr>
                    <tr><td>LastUpdated</td><td>DateTime</td><td>Last modification time</td></tr>
                    <tr><td>User</td><td>string</td><td>Last updating user</td></tr>
                    <tr><td>LastUpdatedBy</td><td>string</td><td>Compatibility alias => User</td></tr>
                </table>
            </div>
            <div class="model-card">
                <h4>InventoryTransaction Model</h4>
                <div class="method-signature">
                    public class InventoryTransaction<br>
                    Maps to: inv_transaction table
                </div>
                <table class="property-table">
                    <tr><th>Property</th><th>Type</th><th>Description</th></tr>
                    <tr><td>ID</td><td>int</td><td>Primary key</td></tr>
                    <tr><td>TransactionType</td><td>TransactionType</td><td>IN/OUT/TRANSFER</td></tr>
                    <tr><td>PartID</td><td>string</td><td>Part identifier</td></tr>
                    <tr><td>FromLocation</td><td>string?</td><td>Source location</td></tr>
                    <tr><td>ToLocation</td><td>string?</td><td>Destination location</td></tr>
                    <tr><td>Operation</td><td>string?</td><td>Workflow step number</td></tr>
                    <tr><td>Quantity</td><td>int</td><td>Transaction quantity</td></tr>
                    <tr><td>User</td><td>string</td><td>Transaction user</td></tr>
                    <tr><td>ReceiveDate</td><td>DateTime</td><td>Transaction timestamp</td></tr>
                </table>
            </div>
        </div>

        <div class="info-box">
            <h4>TransactionType Enum</h4>
            <div class="enum-value">IN</div> - Adding stock to inventory<br>
            <div class="enum-value">OUT</div> - Removing stock from inventory<br>
            <div class="enum-value">TRANSFER</div> - Moving stock between locations
        </div>
    </div>

    <div class="model-category">
        <h2>üóÉÔ∏è Master Data Models</h2>
        <p>Reference data models that define valid values for inventory operations.</p>

        <div class="model-grid">
            <div class="model-card">
                <h4>PartDefinition Model</h4>
                <div class="method-signature">
                    public class PartDefinition<br>
                    Maps to: md_part_ids table
                </div>
                <table class="property-table">
                    <tr><th>Property</th><th>Type</th><th>Description</th></tr>
                    <tr><td>ID</td><td>int</td><td>Primary key</td></tr>
                    <tr><td>PartID</td><td>string</td><td>Part identifier</td></tr>
                    <tr><td>Customer</td><td>string</td><td>Customer name</td></tr>
                    <tr><td>Description</td><td>string</td><td>Part description</td></tr>
                    <tr><td>Operations</td><td>List&lt;string&gt;?</td><td>Valid operations (JSON array)</td></tr>
                </table>
            </div>
            <div class="model-card">
                <h4>Location Model</h4>
                <div class="method-signature">
                    public class Location<br>
                    Maps to: md_locations table
                </div>
                <table class="property-table">
                    <tr><th>Property</th><th>Type</th><th>Description</th></tr>
                    <tr><td>ID</td><td>int</td><td>Primary key</td></tr>
                    <tr><td>LocationCode</td><td>string</td><td>Location identifier</td></tr>
                    <tr><td>Building</td><td>string</td><td>Building name (default "Expo")</td></tr>
                    <tr><td>IssuedBy</td><td>string</td><td>Creator username</td></tr>
                </table>
            </div>
        </div>
    </div>

    <div class="model-category">
        <h2>‚öôÔ∏è System & UI Models</h2>
        <p>User interface configuration and system preferences management.</p>

        <div class="model-card">
            <h4>QuickTransactionButton Model</h4>
            <div class="method-signature">
                public class QuickTransactionButton<br>
                Maps to: sys_last_10_transactions table
            </div>
            <table class="property-table">
                <tr><th>Property</th><th>Type</th><th>Description</th></tr>
                <tr><td>ID</td><td>int</td><td>Primary key</td></tr>
                <tr><td>User</td><td>string</td><td>Owner username</td></tr>
                <tr><td>PartID</td><td>string</td><td>Part identifier</td></tr>
                <tr><td>Operation</td><td>string</td><td>Workflow step number</td></tr>
                <tr><td>Quantity</td><td>int</td><td>Last used quantity</td></tr>
                <tr><td>Position</td><td>int</td><td>UI position (1-based indexing)</td></tr>
                <tr><td>DisplayText</td><td>string</td><td>Computed: "(Operation) - [PartID x Quantity]"</td></tr>
            </table>

            <div class="code-block">
                // Display text generation
                public string DisplayText => $"({Operation}) - [{PartID} x {Quantity}]";
                
                // Example output: "(90) - [PART001 x 5]"
            </div>
        </div>
    </div>

    <div class="model-category">
        <h2>üìù Logging & Error Management</h2>
        <p>Comprehensive error tracking and system monitoring models.</p>

        <div class="model-grid">
            <div class="model-card">
                <h4>ErrorLog Model</h4>
                <div class="method-signature">
                    public class ErrorLog<br>
                    Maps to: log_error table
                </div>
                <table class="property-table">
                    <tr><th>Property</th><th>Type</th><th>Description</th></tr>
                    <tr><td>ID</td><td>int</td><td>Primary key</td></tr>
                    <tr><td>User</td><td>string?</td><td>User context</td></tr>
                    <tr><td>Severity</td><td>ErrorSeverity</td><td>Error severity level</td></tr>
                    <tr><td>ErrorMessage</td><td>string</td><td>Error description</td></tr>
                    <tr><td>StackTrace</td><td>string?</td><td>Exception stack trace</td></tr>
                    <tr><td>ModuleName</td><td>string?</td><td>Source module</td></tr>
                    <tr><td>MachineName</td><td>string?</td><td>Machine identifier</td></tr>
                    <tr><td>AppVersion</td><td>string?</td><td>Application version</td></tr>
                    <tr><td>ErrorTime</td><td>DateTime</td><td>Error timestamp</td></tr>
                </table>
            </div>
            <div class="model-card">
                <h4>ErrorSeverity Enum</h4>
                <div class="enum-value">Information</div> - Informational messages<br>
                <div class="enum-value">Warning</div> - Warning conditions<br>
                <div class="enum-value">Error</div> - Error conditions<br>
                <div class="enum-value">Critical</div> - Critical system errors<br>
                <div class="enum-value">High</div> - High priority errors
            </div>
        </div>
    </div>

    <div class="model-category">
        <h2>üîß Application State & Business Operation Models</h2>
        <p>Runtime state management and complex business operation support.</p>

        <div class="model-grid">
            <div class="model-card">
                <h4>ValidationResult Model</h4>
                <div class="method-signature">
                    public class ValidationResult
                </div>
                <table class="property-table">
                    <tr><th>Property</th><th>Type</th><th>Description</th></tr>
                    <tr><td>IsValid</td><td>bool</td><td>Validation success flag</td></tr>
                    <tr><td>Errors</td><td>List&lt;string&gt;</td><td>Error messages</td></tr>
                    <tr><td>Warnings</td><td>List&lt;string&gt;</td><td>Warning messages</td></tr>
                    <tr><td>ErrorMessages</td><td>List&lt;string&gt;</td><td>Compatibility alias => Errors</td></tr>
                </table>

                <div class="code-block">
                    // Factory methods
                    public static ValidationResult Success() => new() { IsValid = true };
                    public static ValidationResult Failure(params string[] errors) => new() 
                    { 
                        IsValid = false, 
                        Errors = new List&lt;string&gt;(errors) 
                    };
                    
                    // Helper methods
                    public void AddError(string error) => Errors.Add(error);
                    public void AddWarning(string warning) => Warnings.Add(warning);
                </div>
            </div>
            <div class="model-card">
                <h4>InventoryOperationRequest Model</h4>
                <div class="method-signature">
                    public class InventoryOperationRequest
                </div>
                <p>Complete request model for complex inventory operations that may involve multiple database calls.</p>
                <table class="property-table">
                    <tr><th>Property</th><th>Type</th><th>Description</th></tr>
                    <tr><td>PartID</td><td>string</td><td>Part identifier</td></tr>
                    <tr><td>Operation</td><td>string</td><td>Workflow step number</td></tr>
                    <tr><td>Location</td><td>string</td><td>Primary location</td></tr>
                    <tr><td>Quantity</td><td>int</td><td>Operation quantity</td></tr>
                    <tr><td>TransactionType</td><td>TransactionType</td><td>Operation intent</td></tr>
                    <tr><td>ToLocation</td><td>string?</td><td>Destination (for TRANSFER)</td></tr>
                    <tr><td>BatchNumber</td><td>string?</td><td>Batch tracking</td></tr>
                    <tr><td>User</td><td>string</td><td>Requesting user</td></tr>
                    <tr><td>Notes</td><td>string?</td><td>Operation notes</td></tr>
                </table>
            </div>
        </div>
    </div>

    <div class="content-section">
        <h2>üîß Technical Implementation Details</h2>

        <h3>üìä Property Compatibility System</h3>
        <div class="code-block">
            // Primary database properties (match database columns exactly)
            public string PartID { get; set; } = string.Empty;
            public string User_Name { get; set; } = string.Empty;
            
            // Compatibility aliases for existing code
            public string PartId => PartID;                    // Read-only alias
            public string UserName => User_Name;               // Read-only alias
            
            // Read-write compatibility properties
            public string LastUpdatedBy
            {
                get => User; 
                set => User = value;
            }
        </div>

        <h3>üóÉÔ∏è Database Table Mapping</h3>
        <div class="parameter-list">
            <strong>User Management:</strong> usr_users, sys_roles, sys_user_roles<br>
            <strong>Inventory Core:</strong> inv_inventory, inv_transaction, inv_inventory_batch_seq<br>
            <strong>Master Data:</strong> md_part_ids, md_locations, md_operation_numbers, md_item_types<br>
            <strong>System:</strong> sys_last_10_transactions, app_themes, usr_ui_settings<br>
            <strong>Logging:</strong> log_error, log_changelog
        </div>

        <h3>üì° JSON Serialization Support</h3>
        <div class="code-block">
            using System.Text.Json.Serialization;
            
            // All models are ready for JSON serialization
            // Includes JsonPropertyName attributes where needed
            // Supports API communication and data exchange
        </div>

        <h3>‚úÖ MTM Business Rule Enforcement</h3>
        <div class="warning-box">
            <strong>Critical Rules Enforced:</strong><br>
            ‚Ä¢ Part IDs are always strings (never integers)<br>
            ‚Ä¢ Operations are string numbers representing workflow steps<br>
            ‚Ä¢ UI positions use 1-based indexing (Position 1-10)<br>
            ‚Ä¢ TransactionType determined by user intent, not operation numbers<br>
            ‚Ä¢ Compatibility aliases maintain backward compatibility
        </div>
    </div>

    <div class="content-section">
        <h2>üöÄ Usage Examples</h2>

        <h3>Creating an Inventory Item</h3>
        <div class="code-block">
            var item = new InventoryItem
            {
                PartID = "PART001",           // String part identifier
                Location = "WC01",            // Location code
                Operation = "90",             // String operation number
                Quantity = 50,                // Integer quantity
                ItemType = "WIP",             // Item classification
                User = "john.doe",            // Username
                ReceiveDate = DateTime.Now,   // Timestamp
                LastUpdated = DateTime.Now    // Last modification
            };
            
            // Compatibility properties work automatically
            string partId = item.PartId;      // Returns "PART001"
            string updatedBy = item.LastUpdatedBy; // Returns "john.doe"
        </div>

        <h3>Creating an Inventory Transaction</h3>
        <div class="code-block">
            var transaction = new InventoryTransaction
            {
                TransactionType = TransactionType.IN,  // User intent: adding stock
                PartID = "PART001",                     // Part being processed
                FromLocation = null,                    // No source (new stock)
                ToLocation = "WC01",                    // Destination location
                Operation = "90",                       // Workflow step (NOT transaction type!)
                Quantity = 25,                          // Quantity being added
                User = "jane.smith",                    // User performing operation
                ReceiveDate = DateTime.Now,             // Transaction timestamp
                Notes = "New stock delivery"            // Optional notes
            };
        </div>

        <h3>Validation Result Usage</h3>
        <div class="code-block">
            // Success case
            var success = ValidationResult.Success();
            
            // Failure case with multiple errors
            var failure = ValidationResult.Failure(
                "Part ID is required",
                "Quantity must be positive"
            );
            
            // Building validation incrementally
            var result = new ValidationResult { IsValid = true };
            if (string.IsNullOrEmpty(partId))
                result.AddError("Part ID is required");
            if (quantity &lt;= 0)
                result.AddWarning("Quantity should be positive");
                
            result.IsValid = result.Errors.Count == 0;
        </div>
    </div>

    <div class="nav-section">
        <h3>üîç Related Documentation</h3>
        <a href="../../../PlainEnglish/FileDefinitions/Models/CoreModels.html" class="nav-button">üìñ Plain English Documentation</a>
        <a href="../Services/InventoryService.html" class="nav-button">üîß Inventory Service Implementation</a>
        <a href="../Services/UserAndTransactionServices.html" class="nav-button">üë• User & Transaction Services</a>
        <a href="Result.html" class="nav-button">‚úÖ Result Pattern Documentation</a>
    </div>
</body>
</html>