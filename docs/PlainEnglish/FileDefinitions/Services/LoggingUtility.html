<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logging Utility - The Factory Record Archive</title>
    <link rel="stylesheet" href="../../../styles.css">
    <style>
        .archive-highlight { background: linear-gradient(135deg, #8B4513, #D2691E); padding: 2px 6px; border-radius: 3px; color: white; }
        .filing-highlight { background: linear-gradient(135deg, #4682B4, #87CEEB); padding: 2px 6px; border-radius: 3px; color: white; }
        .backup-system { background: #32CD32; color: white; padding: 8px; border-radius: 5px; margin: 10px 0; }
        .record-keeping { background: #FF8C00; color: white; padding: 8px; border-radius: 5px; margin: 10px 0; }
        .nav-button { display: inline-block; padding: 8px 16px; margin: 5px; background: linear-gradient(45deg, #1a1a1a, #333); color: #FFD700; text-decoration: none; border-radius: 5px; font-weight: bold; }
        .nav-button:hover { background: linear-gradient(45deg, #333, #555); }
        .csv-example { background: #f0f0f0; padding: 10px; border-radius: 5px; font-family: monospace; margin: 10px 0; }
        .dual-storage { background: linear-gradient(45deg, #FF69B4, #FF1493); color: white; padding: 8px; border-radius: 5px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-section">
            <h1>📚 Logging Utility</h1>
            <h2>The Factory Record Archive</h2>
            <p class="subtitle">Where every incident gets filed and never forgotten</p>
            
            <div class="navigation-section">
                <a href="../../../Technical/FileDefinitions/Services/LoggingUtility.html" class="nav-button">📋 Technical View (Alt+T)</a>
                <a href="../../index.html" class="nav-button">📂 Back to Services</a>
            </div>
        </div>

        <div class="content-section">
            <div class="summary-box">
                <h3>🎯 What This Does (In Plain English)</h3>
                <p>Think of this as your <strong>factory record archive</strong> - the place where every single incident, error, and problem gets carefully filed away. Just like a factory keeps detailed records of every safety incident or equipment failure, this system ensures every computer problem is documented in not one, but <em>two different places</em> so nothing ever gets lost.</p>
            </div>

            <div class="section">
                <h3>🏭 Real-World Manufacturing Example</h3>
                <p>In a real factory record-keeping system:</p>
                <ul>
                    <li><span class="archive-highlight">📁 File Cabinet Archive</span> - Physical filing cabinets with reports by employee and incident type</li>
                    <li><span class="filing-highlight">💾 Computer Database</span> - Digital records in the main computer system for searching and analysis</li>
                    <li><strong>📋 CSV Reports:</strong> Spreadsheet files that managers can open and analyze</li>
                    <li><strong>🔄 Backup System:</strong> Local filing when main systems are down</li>
                    <li><strong>👤 Personal Folders:</strong> Each employee has their own incident folder</li>
                </ul>
                <p>Our Logging Utility does exactly this for computer incidents!</p>
            </div>

            <div class="dual-storage">
                <strong>🏢 DUAL STORAGE RULE:</strong> Every incident gets stored in TWO places - the file server AND the database. If one fails, the other still has the records.
            </div>

            <div class="section">
                <h3>📁 File Server Archive System</h3>
                
                <h4>🗂️ How the Filing System Works:</h4>
                <ul>
                    <li><strong>Main File Server:</strong> Network location where all incident reports are stored</li>
                    <li><strong>User-Specific Folders:</strong> Each employee gets their own folder (like personal filing cabinets)</li>
                    <li><strong>Category-Specific Files:</strong> Different types of incidents go in different CSV files</li>
                    <li><strong>Automatic Organization:</strong> System creates folders and files as needed</li>
                </ul>

                <h4>📊 CSV File Categories:</h4>
                <ul>
                    <li><strong>ui_errors.csv:</strong> Screen and display problems</li>
                    <li><strong>business_logic_errors.csv:</strong> Process and workflow problems</li>
                    <li><strong>mysql_errors.csv:</strong> Database connection and data problems</li>
                    <li><strong>network_errors.csv:</strong> Internet and communication problems</li>
                    <li><strong>other_errors.csv:</strong> Everything else that doesn't fit above categories</li>
                </ul>

                <div class="csv-example">
<strong>Example CSV Record:</strong><br>
2024-01-15 14:30:22,JOHN_DOE,WORKSTATION-05,UI,Medium,"Button not responding","MainForm.cs","SaveButton_Click",125,"Stack trace...","SaveButton","RecordID=12345","ArgumentNullException"
                </div>

                <div class="backup-system">
                    <strong>🔄 BACKUP RULE:</strong> If the main file server is down, records automatically get saved to local computer until server comes back online.
                </div>
            </div>

            <div class="section">
                <h3>💽 Database Archive System</h3>

                <h4>🏗️ Database Table Structure:</h4>
                <ul>
                    <li><strong>Category-Specific Tables:</strong> Separate database tables for each error type</li>
                    <li><strong>Automatic Table Creation:</strong> System creates tables if they don't exist</li>
                    <li><strong>Indexed Searches:</strong> Fast searching by date, user, or severity</li>
                    <li><strong>Unlimited Storage:</strong> Database can hold millions of records</li>
                </ul>

                <h4>🔍 What Gets Stored in Database:</h4>
                <ul>
                    <li><strong>Complete Incident Details:</strong> Every field from the incident report</li>
                    <li><strong>Searchable Fields:</strong> Can quickly find all incidents by user or date</li>
                    <li><strong>Performance Indexes:</strong> Fast searching even with years of data</li>
                    <li><strong>Relational Data:</strong> Can connect incidents to users, machines, and timeframes</li>
                </ul>

                <div class="record-keeping">
                    <strong>📈 ANALYSIS READY:</strong> Database format allows managers to run reports and identify patterns in problems.
                </div>
            </div>

            <div class="section">
                <h3>🛡️ Smart Fallback Protection</h3>

                <h4>🔧 When Main Systems Fail:</h4>
                <ul>
                    <li><strong>File Server Down:</strong> Automatically switches to local computer storage</li>
                    <li><strong>Database Offline:</strong> File logging continues, database catches up later</li>
                    <li><strong>Network Issues:</strong> Local backup files ensure no data loss</li>
                    <li><strong>Complete System Failure:</strong> Minimal console logging as absolute last resort</li>
                </ul>

                <h4>📱 Escalating Fallback Strategy:</h4>
                <ol>
                    <li><strong>Primary:</strong> File server + Database (normal operation)</li>
                    <li><strong>Fallback 1:</strong> Local files + Database (file server down)</li>
                    <li><strong>Fallback 2:</strong> Local files only (database down)</li>
                    <li><strong>Emergency:</strong> Simple log file in user's personal folder</li>
                    <li><strong>Last Resort:</strong> Console display (all logging systems failed)</li>
                </ol>
            </div>

            <div class="section">
                <h3>⚡ Automatic Smart Features</h3>

                <h4>🤖 Self-Managing System:</h4>
                <ul>
                    <li><strong>Auto-Folder Creation:</strong> Creates user folders automatically when needed</li>
                    <li><strong>Auto-Table Creation:</strong> Creates database tables automatically when needed</li>
                    <li><strong>Thread-Safe Writing:</strong> Multiple people can log errors simultaneously</li>
                    <li><strong>CSV Header Management:</strong> Automatically adds headers to new CSV files</li>
                    <li><strong>Path Resolution:</strong> Handles network paths, local paths, and UNC paths</li>
                </ul>

                <h4>🔒 Data Protection Features:</h4>
                <ul>
                    <li><strong>CSV Escaping:</strong> Handles commas, quotes, and line breaks in error messages</li>
                    <li><strong>SQL Injection Prevention:</strong> Uses parameterized database queries</li>
                    <li><strong>File Locking:</strong> Prevents corruption when multiple processes write</li>
                    <li><strong>Exception Handling:</strong> Never crashes even if logging itself fails</li>
                </ul>
            </div>

            <div class="section">
                <h3>🎮 Business Stakeholder Scenarios</h3>
                
                <h4>Scenario 1: Daily Error Report Review</h4>
                <p>👔 <em>Manager Sarah wants to see yesterday's problems</em></p>
                <ul>
                    <li>Opens John's folder on file server: \\FileServer\Logs\JOHN_DOE\</li>
                    <li>Finds ui_errors.csv with 3 screen problems yesterday</li>
                    <li>Opens mysql_errors.csv - sees 1 database timeout at 2 PM</li>
                    <li>Cross-references with database queries for detailed analysis</li>
                    <li>Identifies pattern: All errors occurred during backup window</li>
                </ul>

                <h4>Scenario 2: System Administrator Investigation</h4>
                <p>🔧 <em>IT admin needs to troubleshoot recurring network issues</em></p>
                <ul>
                    <li>Queries database: "Show all network errors from last 30 days"</li>
                    <li>Groups by machine name to identify problematic workstations</li>
                    <li>Analyzes time patterns - most errors between 1-2 PM daily</li>
                    <li>Correlates with backup schedule - adjusts backup timing</li>
                    <li>Uses detailed stack traces to identify root cause</li>
                </ul>

                <h4>Scenario 3: File Server Maintenance Day</h4>
                <p>🛠️ <em>File server goes down for maintenance, but work continues</em></p>
                <ul>
                    <li>Logging Utility detects file server unavailable</li>
                    <li>Automatically switches to local fallback storage</li>
                    <li>All error reports saved to local user folders</li>
                    <li>Database logging continues normally</li>
                    <li>When server returns, administrators can consolidate local files</li>
                </ul>
            </div>

            <div class="section">
                <h3>📊 Record Formats & Standards</h3>

                <h4>CSV File Format:</h4>
                <ul>
                    <li><strong>Delimiter:</strong> Comma-separated values</li>
                    <li><strong>Encoding:</strong> UTF-8 for international characters</li>
                    <li><strong>Headers:</strong> First row contains column names</li>
                    <li><strong>Escaping:</strong> Quotes and commas properly escaped</li>
                    <li><strong>Timestamps:</strong> YYYY-MM-DD HH:MM:SS format</li>
                </ul>

                <h4>Database Schema:</h4>
                <ul>
                    <li><strong>Primary Key:</strong> Auto-incrementing ID field</li>
                    <li><strong>Indexes:</strong> Timestamp, UserId, and Severity indexed for fast searches</li>
                    <li><strong>Text Fields:</strong> Variable length for error messages and stack traces</li>
                    <li><strong>Data Types:</strong> Appropriate types for each field (DateTime, VARCHAR, TEXT)</li>
                </ul>
            </div>

            <div class="section">
                <h3>🔧 MTM Configuration & Setup</h3>
                <ul>
                    <li><strong>File Server Path:</strong> Configurable network location for log storage</li>
                    <li><strong>Database Connection:</strong> MySQL connection string from secure configuration</li>
                    <li><strong>Enable/Disable Flags:</strong> Can turn off file or database logging independently</li>
                    <li><strong>Development Mode:</strong> Special settings for testing environments</li>
                    <li><strong>Fallback Paths:</strong> Configurable local paths when network unavailable</li>
                </ul>
            </div>

            <div class="integration-section">
                <h3>🔗 How It Connects to Other Systems</h3>
                <ul>
                    <li><strong>Error Handler Service:</strong> Receives all error reports for filing</li>
                    <li><strong>Configuration Service:</strong> Gets file paths and database settings</li>
                    <li><strong>File System:</strong> Creates folders and files on network and local storage</li>
                    <li><strong>MySQL Database:</strong> Stores structured error data for analysis</li>
                    <li><strong>Application Context:</strong> Gets user information for folder organization</li>
                </ul>
            </div>

            <div class="keyboard-shortcuts">
                <h3>⌨️ Quick Navigation</h3>
                <ul>
                    <li><strong>Alt + T:</strong> Switch to Technical Documentation</li>
                    <li><strong>Alt + P:</strong> Back to Plain English View</li>
                    <li><strong>Ctrl + F:</strong> Search this page</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.altKey && e.key === 't') {
                e.preventDefault();
                window.location.href = '../../../Technical/FileDefinitions/Services/LoggingUtility.html';
            } else if (e.altKey && e.key === 'p') {
                e.preventDefault();
                // Already on Plain English view
            }
        });
    </script>
</body>
</html>