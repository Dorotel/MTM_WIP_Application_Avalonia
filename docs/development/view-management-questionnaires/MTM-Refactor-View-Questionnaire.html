<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MTM Refactor View Implementation Questionnaire</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D31 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .header {
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D31 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: -30px -30px 30px -30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 28px;
            font-weight: 300;
        }
        
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
        }
        
        .section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #E1DFDD;
            border-radius: 8px;
            background: #FAFAFA;
        }
        
        .section h2 {
            color: #2E7D31;
            margin-top: 0;
            font-size: 22px;
            font-weight: 600;
        }
        
        .question {
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 6px;
            border-left: 4px solid #4CAF50;
        }
        
        .question-label {
            font-weight: 600;
            color: #323130;
            margin-bottom: 10px;
            display: block;
        }
        
        .options {
            display: grid;
            gap: 8px;
            margin: 10px 0;
        }
        
        .option {
            display: flex;
            align-items: center;
            padding: 8px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        
        .option:hover {
            background-color: #F3F2F1;
        }
        
        .option input[type="radio"] {
            margin-right: 10px;
            accent-color: #4CAF50;
        }
        
        .option input[type="checkbox"] {
            margin-right: 10px;
            accent-color: #4CAF50;
        }
        
        .option label {
            cursor: pointer;
            flex: 1;
        }
        
        .other-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #E1DFDD;
            border-radius: 4px;
            margin-top: 10px;
            font-size: 14px;
            transition: border-color 0.2s;
        }
        
        .other-input:focus {
            outline: none;
            border-color: #4CAF50;
        }
        
        .text-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #E1DFDD;
            border-radius: 4px;
            font-size: 14px;
            min-height: 80px;
            resize: vertical;
            transition: border-color 0.2s;
        }
        
        .text-input:focus {
            outline: none;
            border-color: #4CAF50;
        }
        
        .actions {
            text-align: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #E1DFDD;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D31 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(76, 175, 80, 0.3);
        }
        
        .btn-secondary {
            background: #F3F2F1;
            color: #323130;
            border: 2px solid #E1DFDD;
        }
        
        .btn-secondary:hover {
            background: #E1DFDD;
        }
        
        .progress {
            width: 100%;
            height: 6px;
            background: #E1DFDD;
            border-radius: 3px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #2E7D31);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .validation-error {
            color: #D13438;
            font-size: 12px;
            margin-top: 5px;
        }
        
        .required {
            color: #D13438;
        }
        
        .success-message {
            background: #DFF6DD;
            border: 2px solid #4CAF50;
            color: #2E7D31;
            padding: 15px;
            border-radius: 6px;
            margin: 20px 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>MTM Refactor View Implementation</h1>
            <p>Planning Questionnaire for Refactoring Existing Views</p>
        </div>
        
        <div class="progress">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        
        <form id="refactorViewForm">
            <!-- Refactoring Analysis Section -->
            <div class="section">
                <h2>Refactoring Analysis</h2>
                
                <div class="question">
                    <label class="question-label">1. Which existing view(s) need refactoring? <span class="required">*</span></label>
                    <div class="options">
                        <div class="option">
                            <input type="radio" id="scope_single" name="refactorScope" value="single" required>
                            <label for="scope_single">Single view refactoring</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="scope_multiple" name="refactorScope" value="multiple">
                            <label for="scope_multiple">Multiple related views</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="scope_category" name="refactorScope" value="category">
                            <label for="scope_category">Entire view category (e.g., all MainForm views)</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="scope_cross" name="refactorScope" value="cross">
                            <label for="scope_cross">Cross-cutting refactoring affecting multiple areas</label>
                        </div>
                    </div>
                </div>
                
                <div class="question">
                    <label class="question-label">2. What is the primary refactoring goal? <span class="required">*</span></label>
                    <div class="options">
                        <div class="option">
                            <input type="radio" id="goal_architecture" name="refactorGoal" value="architecture" required>
                            <label for="goal_architecture">Code architecture improvement</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="goal_performance" name="refactorGoal" value="performance">
                            <label for="goal_performance">Performance optimization</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="goal_patterns" name="refactorGoal" value="patterns">
                            <label for="goal_patterns">Pattern modernization</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="goal_consolidation" name="refactorGoal" value="consolidation">
                            <label for="goal_consolidation">Code consolidation</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="goal_debt" name="refactorGoal" value="debt">
                            <label for="goal_debt">Technical debt reduction</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="goal_standards" name="refactorGoal" value="standards">
                            <label for="goal_standards">Compliance with new standards</label>
                        </div>
                    </div>
                </div>
                
                <div class="question">
                    <label class="question-label">3. What specific code issues are being addressed? (Select all that apply)</label>
                    <div class="options">
                        <div class="option">
                            <input type="checkbox" id="issue_patterns" name="codeIssues" value="patterns">
                            <label for="issue_patterns">Outdated patterns (e.g., legacy MVVM)</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="issue_duplication" name="codeIssues" value="duplication">
                            <label for="issue_duplication">Code duplication</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="issue_separation" name="codeIssues" value="separation">
                            <label for="issue_separation">Poor separation of concerns</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="issue_bottlenecks" name="codeIssues" value="bottlenecks">
                            <label for="issue_bottlenecks">Performance bottlenecks</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="issue_maintainability" name="codeIssues" value="maintainability">
                            <label for="issue_maintainability">Maintainability issues</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="issue_security" name="codeIssues" value="security">
                            <label for="issue_security">Security vulnerabilities</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Scope Definition Section -->
            <div class="section">
                <h2>Scope Definition</h2>
                
                <div class="question">
                    <label class="question-label">4. What is the refactoring scope? (Select all that apply)</label>
                    <div class="options">
                        <div class="option">
                            <input type="checkbox" id="scope_viewmodel" name="technicalScope" value="viewmodel">
                            <label for="scope_viewmodel">ViewModel refactoring only</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="scope_ui" name="technicalScope" value="ui">
                            <label for="scope_ui">AXAML/UI refactoring only</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="scope_service" name="technicalScope" value="service">
                            <label for="scope_service">Service layer refactoring</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="scope_database" name="technicalScope" value="database">
                            <label for="scope_database">Database integration refactoring</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="scope_fullstack" name="technicalScope" value="fullstack">
                            <label for="scope_fullstack">Full stack refactoring</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="scope_component" name="technicalScope" value="component">
                            <label for="scope_component">Cross-component refactoring</label>
                        </div>
                    </div>
                </div>
                
                <div class="question">
                    <label class="question-label">5. What patterns are being updated? (Select all that apply)</label>
                    <div class="options">
                        <div class="option">
                            <input type="checkbox" id="pattern_mvvm" name="patternUpdates" value="mvvm">
                            <label for="pattern_mvvm">MVVM Community Toolkit migration</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="pattern_theme" name="patternUpdates" value="theme">
                            <label for="pattern_theme">New theme system integration</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="pattern_database" name="patternUpdates" value="database">
                            <label for="pattern_database">Updated database patterns</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="pattern_error" name="patternUpdates" value="error">
                            <label for="pattern_error">Modern error handling</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="pattern_di" name="patternUpdates" value="di">
                            <label for="pattern_di">Dependency injection improvements</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="pattern_architectural" name="patternUpdates" value="architectural">
                            <label for="pattern_architectural">New architectural patterns</label>
                        </div>
                    </div>
                </div>
                
                <div class="question">
                    <label class="question-label">6. Will external functionality change? <span class="required">*</span></label>
                    <div class="options">
                        <div class="option">
                            <input type="radio" id="external_no" name="externalChanges" value="no" required>
                            <label for="external_no">No visible changes to users</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="external_minor" name="externalChanges" value="minor">
                            <label for="external_minor">Minor UI improvements only</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="external_performance" name="externalChanges" value="performance">
                            <label for="external_performance">Enhanced performance (same features)</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="external_internal" name="externalChanges" value="internal">
                            <label for="external_internal">Internal improvements only</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="external_enhancements" name="externalChanges" value="enhancements">
                            <label for="external_enhancements">Some functional enhancements</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Architecture Planning Section -->
            <div class="section">
                <h2>Architecture Planning</h2>
                
                <div class="question">
                    <label class="question-label">7. What architectural improvements are planned? (Select all that apply)</label>
                    <div class="options">
                        <div class="option">
                            <input type="checkbox" id="arch_separation" name="architecturalImprovements" value="separation">
                            <label for="arch_separation">Better separation of concerns</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="arch_di" name="architecturalImprovements" value="di">
                            <label for="arch_di">Improved dependency injection</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="arch_service" name="architecturalImprovements" value="service">
                            <label for="arch_service">Service layer consolidation</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="arch_reusability" name="architecturalImprovements" value="reusability">
                            <label for="arch_reusability">Code reusability improvements</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="arch_patterns" name="architecturalImprovements" value="patterns">
                            <label for="arch_patterns">Design pattern upgrades</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="arch_performance" name="architecturalImprovements" value="performance">
                            <label for="arch_performance">Performance optimizations</label>
                        </div>
                    </div>
                </div>
                
                <div class="question">
                    <label class="question-label">8. Are there any breaking changes in internal APIs? <span class="required">*</span></label>
                    <div class="options">
                        <div class="option">
                            <input type="radio" id="breaking_no" name="breakingChanges" value="no" required>
                            <label for="breaking_no">No breaking changes</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="breaking_internal" name="breakingChanges" value="internal">
                            <label for="breaking_internal">Internal API changes (coordinated)</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="breaking_service" name="breakingChanges" value="service">
                            <label for="breaking_service">Service interface updates</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="breaking_viewmodel" name="breakingChanges" value="viewmodel">
                            <label for="breaking_viewmodel">ViewModel contract changes</label>
                        </div>
                        <div class="option">
                            <input type="radio" id="breaking_database" name="breakingChanges" value="database">
                            <label for="breaking_database">Database operation changes</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Technical Modernization Section -->
            <div class="section">
                <h2>Technical Modernization</h2>
                
                <div class="question">
                    <label class="question-label">9. What modern patterns will be implemented? (Select all that apply)</label>
                    <div class="options">
                        <div class="option">
                            <input type="checkbox" id="modern_mvvm" name="modernPatterns" value="mvvm">
                            <label for="modern_mvvm">MVVM Community Toolkit source generators</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="modern_avalonia" name="modernPatterns" value="avalonia">
                            <label for="modern_avalonia">Latest Avalonia UI patterns</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="modern_theme" name="modernPatterns" value="theme">
                            <label for="modern_theme">Updated theme system usage</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="modern_async" name="modernPatterns" value="async">
                            <label for="modern_async">Modern async/await patterns</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="modern_error" name="modernPatterns" value="error">
                            <label for="modern_error">Improved error handling</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="modern_logging" name="modernPatterns" value="logging">
                            <label for="modern_logging">Enhanced logging</label>
                        </div>
                    </div>
                </div>
                
                <div class="question">
                    <label class="question-label">10. What code quality improvements are planned? (Select all that apply)</label>
                    <div class="options">
                        <div class="option">
                            <input type="checkbox" id="quality_organization" name="qualityImprovements" value="organization">
                            <label for="quality_organization">Better code organization</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="quality_naming" name="qualityImprovements" value="naming">
                            <label for="quality_naming">Improved naming conventions</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="quality_docs" name="qualityImprovements" value="docs">
                            <label for="quality_docs">Enhanced documentation</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="quality_tests" name="qualityImprovements" value="tests">
                            <label for="quality_tests">Better unit test coverage</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="quality_performance" name="qualityImprovements" value="performance">
                            <label for="quality_performance">Performance optimizations</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="quality_security" name="qualityImprovements" value="security">
                            <label for="quality_security">Security improvements</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Risk Management Section -->
            <div class="section">
                <h2>Risk Management</h2>
                
                <div class="question">
                    <label class="question-label">11. What are the main refactoring risks? (Select all that apply)</label>
                    <div class="options">
                        <div class="option">
                            <input type="checkbox" id="risk_functionality" name="refactoringRisks" value="functionality">
                            <label for="risk_functionality">Breaking existing functionality</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="risk_performance" name="refactoringRisks" value="performance">
                            <label for="risk_performance">Performance regression</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="risk_integration" name="refactoringRisks" value="integration">
                            <label for="risk_integration">Integration issues</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="risk_workflow" name="refactoringRisks" value="workflow">
                            <label for="risk_workflow">User workflow disruption</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="risk_database" name="refactoringRisks" value="database">
                            <label for="risk_database">Database compatibility issues</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="risk_dependencies" name="refactoringRisks" value="dependencies">
                            <label for="risk_dependencies">Other component dependencies</label>
                        </div>
                    </div>
                </div>
                
                <div class="question">
                    <label class="question-label">12. What is the rollback plan? (Select all that apply)</label>
                    <div class="options">
                        <div class="option">
                            <input type="checkbox" id="rollback_branch" name="rollbackPlan" value="branch">
                            <label for="rollback_branch">Feature branch with full backup</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="rollback_staged" name="rollbackPlan" value="staged">
                            <label for="rollback_staged">Staged deployment approach</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="rollback_testing" name="rollbackPlan" value="testing">
                            <label for="rollback_testing">Comprehensive testing before merge</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="rollback_database" name="rollbackPlan" value="database">
                            <label for="rollback_database">Database rollback procedures (if needed)</label>
                        </div>
                        <div class="option">
                            <input type="checkbox" id="rollback_communication" name="rollbackPlan" value="communication">
                            <label for="rollback_communication">User communication plan</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Detailed Planning Section -->
            <div class="section">
                <h2>Detailed Planning</h2>
                
                <div class="question">
                    <label class="question-label">13. Provide a detailed description of the current architecture and planned improvements:</label>
                    <textarea class="text-input" name="architectureDescription" placeholder="Describe the current architecture, identified issues, and the planned refactored architecture with specific improvements..."></textarea>
                </div>
                
                <div class="question">
                    <label class="question-label">14. List the specific views, ViewModels, and services that will be refactored:</label>
                    <textarea class="text-input" name="componentsToRefactor" placeholder="List all components that will be refactored, including file names and the specific changes planned for each..."></textarea>
                </div>
                
                <div class="question">
                    <label class="question-label">15. Describe the testing and validation strategy for this refactoring:</label>
                    <textarea class="text-input" name="testingStrategy" placeholder="Describe your testing approach, including unit tests, integration tests, performance benchmarks, and regression testing..."></textarea>
                </div>
                
                <div class="question">
                    <label class="question-label">16. Document any dependencies, coordination needs, or special deployment requirements:</label>
                    <textarea class="text-input" name="dependencies" placeholder="List any team coordination needs, database team involvement, external dependencies, or special deployment procedures..."></textarea>
                </div>
            </div>
            
            <div class="actions">
                <button type="button" class="btn btn-secondary" onclick="clearForm()">Clear Form</button>
                <button type="button" class="btn btn-secondary" onclick="validateForm()">Validate</button>
                <button type="button" class="btn btn-primary" onclick="saveAnswers()">Save Answers</button>
            </div>
            
            <div id="successMessage" class="success-message" style="display: none;">
                Answers saved successfully! JSON file created in docs/development/answers-json-files/
            </div>
        </form>
    </div>
    
    <script>
        // Show/hide other input fields based on radio selection
        document.addEventListener('change', function(e) {
            if (e.target.type === 'radio' && e.target.value === 'other') {
                const otherInput = document.getElementById(e.target.name + '_other_text');
                if (otherInput) {
                    otherInput.style.display = 'block';
                    otherInput.focus();
                }
                
                // Hide other inputs for the same question
                const allOtherInputs = document.querySelectorAll(`input[id*="${e.target.name}"][id*="_other_text"]`);
                allOtherInputs.forEach(input => {
                    if (input.id !== e.target.name + '_other_text') {
                        input.style.display = 'none';
                        input.value = '';
                    }
                });
            } else if (e.target.type === 'radio' && e.target.value !== 'other') {
                const otherInput = document.getElementById(e.target.name + '_other_text');
                if (otherInput) {
                    otherInput.style.display = 'none';
                    otherInput.value = '';
                }
            }
            
            updateProgress();
        });
        
        // Update progress bar
        function updateProgress() {
            const form = document.getElementById('refactorViewForm');
            const requiredFields = form.querySelectorAll('input[required], select[required]');
            let completedFields = 0;
            
            requiredFields.forEach(field => {
                if (field.type === 'radio') {
                    const radioGroup = form.querySelectorAll(`input[name="${field.name}"]`);
                    const isChecked = Array.from(radioGroup).some(radio => radio.checked);
                    if (isChecked) completedFields++;
                } else if (field.value.trim()) {
                    completedFields++;
                }
            });
            
            const progress = (completedFields / requiredFields.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }
        
        function validateForm() {
            const form = document.getElementById('refactorViewForm');
            const requiredFields = form.querySelectorAll('input[required], select[required]');
            let isValid = true;
            let firstInvalidField = null;
            
            // Clear previous validation errors
            document.querySelectorAll('.validation-error').forEach(error => error.remove());
            
            requiredFields.forEach(field => {
                let fieldValid = false;
                
                if (field.type === 'radio') {
                    const radioGroup = form.querySelectorAll(`input[name="${field.name}"]`);
                    fieldValid = Array.from(radioGroup).some(radio => radio.checked);
                } else {
                    fieldValid = field.value.trim() !== '';
                }
                
                if (!fieldValid) {
                    isValid = false;
                    if (!firstInvalidField) {
                        firstInvalidField = field;
                    }
                    
                    // Add validation error message
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'validation-error';
                    errorDiv.textContent = 'This field is required';
                    
                    const questionDiv = field.closest('.question');
                    if (questionDiv && !questionDiv.querySelector('.validation-error')) {
                        questionDiv.appendChild(errorDiv);
                    }
                }
            });
            
            if (isValid) {
                alert('Form is valid! All required fields are completed.');
            } else {
                alert('Please complete all required fields marked with *');
                if (firstInvalidField) {
                    firstInvalidField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
            
            return isValid;
        }
        
        function collectFormData() {
            const formData = {
                timestamp: new Date().toISOString(),
                scenario: 'refactor-view',
                refactoringAnalysis: {},
                scopeDefinition: {},
                architecturePlanning: {},
                technicalModernization: {},
                riskManagement: {},
                detailedPlanning: {}
            };
            
            const form = document.getElementById('refactorViewForm');
            
            // Refactoring Analysis
            formData.refactoringAnalysis.refactorScope = getRadioValue('refactorScope');
            formData.refactoringAnalysis.refactorGoal = getRadioValue('refactorGoal');
            formData.refactoringAnalysis.codeIssues = getCheckboxValues('codeIssues');
            
            // Scope Definition
            formData.scopeDefinition.technicalScope = getCheckboxValues('technicalScope');
            formData.scopeDefinition.patternUpdates = getCheckboxValues('patternUpdates');
            formData.scopeDefinition.externalChanges = getRadioValue('externalChanges');
            
            // Architecture Planning
            formData.architecturePlanning.architecturalImprovements = getCheckboxValues('architecturalImprovements');
            formData.architecturePlanning.breakingChanges = getRadioValue('breakingChanges');
            
            // Technical Modernization
            formData.technicalModernization.modernPatterns = getCheckboxValues('modernPatterns');
            formData.technicalModernization.qualityImprovements = getCheckboxValues('qualityImprovements');
            
            // Risk Management
            formData.riskManagement.refactoringRisks = getCheckboxValues('refactoringRisks');
            formData.riskManagement.rollbackPlan = getCheckboxValues('rollbackPlan');
            
            // Detailed Planning
            formData.detailedPlanning.architectureDescription = form.elements.architectureDescription.value;
            formData.detailedPlanning.componentsToRefactor = form.elements.componentsToRefactor.value;
            formData.detailedPlanning.testingStrategy = form.elements.testingStrategy.value;
            formData.detailedPlanning.dependencies = form.elements.dependencies.value;
            
            return formData;
        }
        
        function getRadioValue(name) {
            const radio = document.querySelector(`input[name="${name}"]:checked`);
            return radio ? radio.value : '';
        }
        
        function getCheckboxValues(name) {
            const checkboxes = document.querySelectorAll(`input[name="${name}"]:checked`);
            return Array.from(checkboxes).map(cb => cb.value);
        }
        
        function saveAnswers() {
            if (!validateForm()) {
                return;
            }
            
            const formData = collectFormData();
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            const filename = `refactor-view-answers-${timestamp}.json`;
            
            // Create and download JSON file
            const dataStr = JSON.stringify(formData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            link.click();
            URL.revokeObjectURL(url);
            
            // Show success message
            document.getElementById('successMessage').style.display = 'block';
            setTimeout(() => {
                document.getElementById('successMessage').style.display = 'none';
            }, 5000);
        }
        
        function clearForm() {
            if (confirm('Are you sure you want to clear all form data? This action cannot be undone.')) {
                document.getElementById('refactorViewForm').reset();
                
                // Hide all other input fields
                document.querySelectorAll('.other-input').forEach(input => {
                    input.style.display = 'none';
                    input.value = '';
                });
                
                // Clear validation errors
                document.querySelectorAll('.validation-error').forEach(error => error.remove());
                
                updateProgress();
            }
        }
        
        // Initialize progress on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateProgress();
        });
        
        // Update progress on any form change
        document.getElementById('refactorViewForm').addEventListener('input', updateProgress);
        document.getElementById('refactorViewForm').addEventListener('change', updateProgress);
    </script>
</body>
</html>
