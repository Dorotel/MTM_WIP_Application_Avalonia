name: "TransferTabView Complete Implementation"
description: "Complete implementation of TransferTabView.axaml with dual-panel layout and quantity management"
title: "[FEATURE] Complete TransferTabView Implementation with Location Transfer and Quantity Controls"
labels: ["feature", "enhancement", "ui", "inventory-management", "transfer-operations", "priority-high"]
projects: ["MTM-Development"]
assignees: []
body:
  - type: markdown
    attributes:
      value: |
        ## üéØ TransferTabView Implementation Request
        
        **Priority Level**: High (Implementation Order: 2nd)
        **View Type**: Dual-Panel Transfer Interface with Quantity Management
        **Based on**: WinForms Control_TransferTab with Avalonia MVVM patterns
        **ViewModel**: TransferItemViewModel (908 lines - comprehensive business logic available)
        
        **Key Requirements**:
        - DataGrid-focused layout with transfer configuration above
        - Dual-panel design: Source selection + Destination configuration
        - NO ComboBoxes - replace with TextBoxes + SuggestionOverlay
        - NumericUpDown for precise quantity transfer control
        - CollapsiblePanel integration for input area
        - Auto-collapse input panel on Search, auto-expand on Reset
        - Full QuickButtons integration (populate fields + history logging)
        - SuccessOverlay for all successful transfers (From ‚Üí To location info)
        - ALL transfers create "TRANSFER" transactions (regardless of operation numbers)
        - Comprehensive transaction logging (Yellow = TRANSFER operations)

  - type: input
    id: feature_title
    attributes:
      label: "Feature Title"
      value: "Complete TransferTabView Implementation with Location Transfer and Quantity Controls"
    validations:
      required: true

  - type: dropdown
    id: implementation_priority
    attributes:
      label: "Implementation Priority Level"
      description: "Business priority for this feature"
      options:
        - "High - Core Transfer Operations (TransferTabView - 2nd priority)"
        - "Critical - Foundation Feature"
        - "Medium - Enhancement"
        - "Low - Future Considerations"
      default: 0
    validations:
      required: true

  - type: checkboxes
    id: core_ui_structure
    attributes:
      label: "üñºÔ∏è Core UI Structure Requirements"
      description: "Essential UI layout and component requirements"
      options:
        - label: "Dual-panel layout: Source search/filter + Destination configuration"
          required: true
        - label: "DataGrid-centric display (primary focus on inventory transfer candidates)"
          required: true
        - label: "Transfer configuration fields positioned ABOVE DataGrid"
          required: true
        - label: "CollapsiblePanel for input area with auto-collapse/expand behavior"
          required: true
        - label: "Replace ALL ComboBoxes with TextBoxes + SuggestionOverlay"
          required: true
        - label: "NumericUpDown control for precise quantity transfer specification"
          required: true
        - label: "Follow InventoryTabView styling patterns exactly (no exceptions)"
          required: true
        - label: "ScrollViewer > Grid[RowDefinitions='*,Auto'] > Border structure"
          required: true

  - type: dropdown
    id: layout_structure
    attributes:
      label: "üìê Transfer Layout Structure"
      description: "Primary layout organization for transfer operations"
      options:
        - "CollapsiblePanel(Search+Transfer Config) + DataGrid + ActionButtons (Recommended)"
        - "Split layout: SearchPanel | TransferConfigPanel + DataGrid + Actions"
        - "Tabbed interface: Search/Configure/Transfer separation"
        - "Custom layout based on WinForms screenshots"
      default: 0
    validations:
      required: true

  - type: checkboxes
    id: input_field_requirements
    attributes:
      label: "üìù Input Field Implementation"
      description: "Specific requirements for search/filter and transfer configuration inputs"
      options:
        - label: "Part ID TextBox with SuggestionOverlay (fuzzy matching for source)"
          required: true
        - label: "Operation TextBox with SuggestionOverlay (workflow step filtering)"
          required: true
        - label: "To Location TextBox with SuggestionOverlay (destination selection)"
          required: true
        - label: "NumericUpDown for transfer quantity (min=1, max=available inventory)"
          required: true
        - label: "All TextBoxes use TextBoxFuzzyValidationBehavior pattern"
          required: true
        - label: "Watermark text for user guidance on all inputs"
          required: true
        - label: "Real-time validation feedback for transfer configuration"
          required: true

  - type: checkboxes
    id: quantity_management
    attributes:
      label: "üî¢ Quantity Management Requirements"
      description: "NumericUpDown and quantity transfer logic"
      options:
        - label: "NumericUpDown control with increment/decrement buttons"
          required: true
        - label: "Automatic maximum limit based on selected inventory item quantity"
          required: true
        - label: "Minimum value = 1 (prevent zero or negative transfers)"
          required: true
        - label: "Keyboard input support for direct quantity entry"
          required: true
        - label: "Visual feedback for quantity validation (invalid quantities highlighted)"
          required: true
        - label: "Support for partial quantity transfers (source quantity reduced)"
          required: true
        - label: "Support for complete item transfers (entire quantity moved)"
          required: true

  - type: checkboxes
    id: datagrid_functionality
    attributes:
      label: "üìä DataGrid Requirements"
      description: "DataGrid display and interaction for transfer source selection"
      options:
        - label: "Single and multi-row selection for batch transfer operations"
          required: true
        - label: "Display columns: Location, PartID, Operation, Available Quantity, Notes"
          required: true
        - label: "Sortable columns with proper data binding"
          required: true
        - label: "Row selection highlighting with MTM theme colors"
          required: true
        - label: "'Nothing Found' visual indicator when no transfer candidates"
          required: true
        - label: "Loading state indication during data retrieval"
          required: true
        - label: "Available quantity display for transfer planning"
          required: true

  - type: checkboxes
    id: transfer_operations
    attributes:
      label: "üîÑ Transfer Operation Types"
      description: "Types of transfer operations and business logic"
      options:
        - label: "Partial quantity transfers (reduces source, creates destination entry)"
          required: true
        - label: "Complete item transfers (moves entire inventory record)"
          required: true
        - label: "Batch transfer operations (multiple items to same destination)"
          required: true
        - label: "Location-to-location transfers with complete audit trail"
          required: true
        - label: "Quantity validation against available inventory"
          required: true
        - label: "Atomic transaction handling (rollback on failures)"
          required: true
        - label: "Real-time inventory updates after successful transfers"
          required: true

  - type: checkboxes
    id: critical_transaction_logic
    attributes:
      label: "‚ö†Ô∏è CRITICAL: Transaction Type Logic"
      description: "Essential business rules for transfer transaction classification"
      options:
        - label: "ALL transfers create 'TRANSFER' transactions (regardless of operation number)"
          required: true
        - label: "Operation numbers ('90', '100', '110') are workflow steps ONLY"
          required: true
        - label: "Transaction type determined by user action, NOT operation number"
          required: true
        - label: "From Location and To Location both recorded in transaction history"
          required: true
        - label: "Complete audit trail: User, Timestamp, Part ID, Operation, From‚ÜíTo, Quantity"
          required: true
        - label: "Yellow color coding in QuickButtons history for TRANSFER operations"
          required: true

  - type: checkboxes
    id: search_reset_behavior
    attributes:
      label: "üîç Search & Reset Panel Behavior"
      description: "Auto-collapse/expand functionality for input panel"
      options:
        - label: "Search button: Execute search + Auto-collapse input panel"
          required: true
        - label: "Reset button: Clear all inputs + Auto-expand input panel"
          required: true
        - label: "Panel collapse preserves user manual expand state"
          required: true
        - label: "Smooth animation transitions for panel state changes"
          required: true
        - label: "Visual indicators for collapsed/expanded states"
          required: true
        - label: "Keyboard shortcuts: F5 (Search), Escape (Reset)"
          required: true

  - type: checkboxes
    id: suggestion_overlay_integration
    attributes:
      label: "üí° SuggestionOverlay Integration"
      description: "Implementation requirements for SuggestionOverlay.cs integration"
      options:
        - label: "Part ID field - fuzzy matching against master parts data"
          required: true
        - label: "Operation field - exact matching against operation numbers"
          required: true
        - label: "To Location field - exact matching against valid locations"
          required: true
        - label: "Same activation logic as InventoryTabView (focus + typing)"
          required: true
        - label: "Keyboard navigation (Arrow keys, Enter, Escape)"
          required: true
        - label: "Auto-population from selected suggestion"
          required: true
        - label: "Validation against destination location (prevent same-location transfers)"
          required: true

  - type: checkboxes
    id: quickbuttons_integration
    attributes:
      label: "‚ö° QuickButtons Integration"
      description: "Integration with QuickButtonsView.axaml and QuickButtons.cs"
      options:
        - label: "Clicking QuickButton populates source fields (Part ID, Operation, Location)"
          required: true
        - label: "Toggle QuickButtons panel visibility (same as InventoryTabView)"
          required: true
        - label: "All successful transfers logged to QuickButtons history"
          required: true
        - label: "History entries show YELLOW color coding (TRANSFER transactions)"
          required: true
        - label: "Failed operations NOT logged to history"
          required: true
        - label: "Integration with QuickButtonsViewModel events"
          required: true
        - label: "Consistent panel toggle behavior across all views"
          required: true

  - type: checkboxes
    id: success_overlay_requirements
    attributes:
      label: "‚úÖ SuccessOverlay Integration"
      description: "SuccessOverlayView.axaml integration for transfer confirmations"
      options:
        - label: "Show success overlay for ALL successful transfer operations"
          required: true
        - label: "Display information: Part ID, Operation, From Location, To Location"
          required: true
        - label: "Quantity transferred information in success message"
          required: true
        - label: "Auto-dismiss after configurable timeout"
          required: true
        - label: "Manual dismiss with close button"
          required: true
        - label: "Support for batch transfer success messages"
          required: true
        - label: "Integration with SuccessOverlayViewModel"
          required: true

  - type: checkboxes
    id: progress_reporting
    attributes:
      label: "‚è≥ Progress Reporting Requirements"
      description: "Progress indication in MainView.axaml status bar"
      options:
        - label: "Database operation progress (data retrieval, transfer execution)"
          required: true
        - label: "Batch transfer progress with item count updates"
          required: true
        - label: "MainView status bar integration"
          required: true
        - label: "Detailed status messages during transfer operations"
          required: true
        - label: "Error state indication in progress system"
          required: true
        - label: "Transfer completion notifications with summary"
          required: true

  - type: textarea
    id: current_implementation_gaps
    attributes:
      label: "üìã Current Implementation Status Analysis"
      description: "Analysis of current TransferTabView.axaml state and missing functionality"
      value: |
        **Current State Analysis**:
        
        **Existing Components** (from TransferTabView.axaml):
        - ‚úÖ Basic AXAML structure with UserControl inheritance
        - ‚úÖ MTM theme styling framework (DynamicResource bindings)
        - ‚úÖ ScrollViewer > Grid layout foundation
        - ‚úÖ Material Icons integration (xmlns:materialIcons)
        - ‚úÖ Behaviors integration (xmlns:behaviors)
        - ‚úÖ ViewModel binding (x:DataType="vm:TransferItemViewModel")
        
        **Missing Critical Components**:
        - ‚ùå Complete form field implementation (currently empty placeholders)
        - ‚ùå NumericUpDown control for quantity transfer specification
        - ‚ùå DataGrid implementation for transfer source selection
        - ‚ùå To Location input field with SuggestionOverlay
        - ‚ùå Search/Reset button functionality with panel behavior
        - ‚ùå CollapsiblePanel integration for input area
        - ‚ùå Transfer execution button with batch operation support
        - ‚ùå QuickButtons panel toggle integration
        - ‚ùå Success overlay integration for transfer confirmations
        - ‚ùå Progress reporting integration
        
        **ViewModel Status** (TransferItemViewModel.cs - 908 lines):
        - ‚úÖ Comprehensive business logic implemented
        - ‚úÖ Observable collections for Part, Operation, Location data
        - ‚úÖ Transfer command implementations with quantity management
        - ‚úÖ Database service integration with transfer procedures
        - ‚úÖ Transaction logging capabilities (TRANSFER type)
        - ‚úÖ Validation and error handling for transfer operations
        - ‚úÖ Support for both partial and complete transfers
        
        **Integration Requirements**:
        - Connect existing TransferItemViewModel to new UI implementation
        - Implement dual-panel layout for source selection + destination configuration
        - Add NumericUpDown control with proper quantity management
        - Integrate CollapsiblePanel with auto-collapse/expand behavior
        - Connect all overlay systems and progress reporting
    validations:
      required: true

  - type: textarea
    id: winforms_comparison
    attributes:
      label: "üñºÔ∏è WinForms Reference Implementation"
      description: "Key features from WinForms Control_TransferTab to preserve in Avalonia version"
      value: |
        **From Control_TransferTab.instructions.md & UI Screenshots**:
        
        **Layout Structure**:
        - Search controls row (Part ID, Operation, Search, Reset buttons)
        - Transfer configuration row (To Location ComboBox, Quantity NumericUpDown)
        - Large DataGridView for transfer source selection
        - Transfer execution and action buttons
        - "Nothing Found" image indicator for empty search results
        
        **Transfer Operations**:
        - Dynamic search: Part only OR Part + Operation filtering
        - Quantity specification with NumericUpDown control
        - Location-to-location transfers with validation
        - Support for partial and complete quantity transfers
        - Batch transfer operations
        
        **Business Logic**:
        - ALL transfers create "TRANSFER" transactions
        - Operation numbers are workflow step identifiers only
        - Complete audit trail with from/to location tracking
        - Automatic quantity validation against available inventory
        - Atomic transaction handling with rollback capability
        
        **UI Features**:
        - Progressive loading with status updates
        - Theme integration for professional appearance
        - Keyboard shortcuts (F5=Search, Enter=Transfer, Ctrl+P=Print)
        - Visual feedback for all transfer operations
        - Integration with quick actions panel
    validations:
      required: false

  - type: checkboxes
    id: validation_requirements
    attributes:
      label: "‚úÖ Transfer Validation Requirements"
      description: "Input validation and business rule enforcement"
      options:
        - label: "Destination location validation (must exist, cannot be same as source)"
          required: true
        - label: "Quantity validation (must be > 0, cannot exceed available)"
          required: true
        - label: "Part ID validation against master parts database"
          required: true
        - label: "Operation validation against valid operation numbers"
          required: true
        - label: "Real-time validation feedback with visual indicators"
          required: true
        - label: "Pre-transfer validation before database operations"
          required: true
        - label: "Error prevention through UI constraints"
          required: true

  - type: dropdown
    id: error_handling_strategy
    attributes:
      label: "üö® Error Handling Strategy"
      description: "How transfer errors should be handled and displayed"
      options:
        - "Centralized ErrorHandling service (required)"
        - "Local error handling with notifications"
        - "Silent error handling with logging only"
        - "User-defined error handling approach"
      default: 0
    validations:
      required: true

  - type: checkboxes
    id: keyboard_shortcuts
    attributes:
      label: "‚å®Ô∏è Keyboard Shortcuts Implementation"
      description: "Keyboard navigation and shortcut requirements"
      options:
        - label: "F5 - Execute search operation"
          required: true
        - label: "Enter - Execute transfer operation"
          required: true
        - label: "Escape - Cancel current operation/Reset"
          required: true
        - label: "Ctrl+P - Print current transfer candidates view"
          required: false
        - label: "Tab navigation through all interactive elements"
          required: true
        - label: "Arrow keys for NumericUpDown quantity adjustment"
          required: true

  - type: checkboxes
    id: accessibility_features
    attributes:
      label: "‚ôø Accessibility Features"
      description: "Accessibility and usability enhancements"
      options:
        - label: "ToolTip.Tip attributes on all interactive elements"
          required: true
        - label: "Proper focus management and visual focus indicators"
          required: true
        - label: "Screen reader support with appropriate labels"
          required: true
        - label: "Keyboard-only navigation capability"
          required: true
        - label: "High contrast theme compatibility"
          required: true
        - label: "Logical tab order for transfer workflow"
          required: true

  - type: textarea
    id: acceptance_criteria
    attributes:
      label: "üéØ Detailed Acceptance Criteria"
      description: "Specific, testable requirements for implementation completion"
      value: |
        **UI Implementation**:
        - [ ] TransferTabView.axaml fully implemented with dual-panel transfer layout
        - [ ] All ComboBoxes replaced with TextBoxes + SuggestionOverlay integration
        - [ ] NumericUpDown control implemented for precise quantity specification
        - [ ] CollapsiblePanel implemented for input area with auto-collapse/expand
        - [ ] Search/Reset buttons positioned above DataGrid with proper functionality
        - [ ] Consistent styling with InventoryTabView (MTM theme compliance)
        
        **DataGrid Functionality**:
        - [ ] Single and multi-row selection enabled for batch transfers
        - [ ] Proper column display: Location, PartID, Operation, Available Quantity, Notes
        - [ ] Sortable columns with data binding
        - [ ] "Nothing Found" indicator for empty search results
        - [ ] Loading state indication during data retrieval
        
        **Transfer Configuration**:
        - [ ] Part ID search with SuggestionOverlay (fuzzy matching)
        - [ ] Operation search with SuggestionOverlay (exact matching)
        - [ ] To Location field with SuggestionOverlay (destination selection)
        - [ ] NumericUpDown with automatic max limit based on available quantity
        - [ ] Real-time validation feedback for all transfer inputs
        
        **Transfer Operations**:
        - [ ] Partial quantity transfers (source reduced, destination created)
        - [ ] Complete item transfers (entire record moved to new location)
        - [ ] Batch transfer operations with progress indication
        - [ ] Atomic transaction handling with rollback on failures
        - [ ] Location validation (prevent same-location transfers)
        
        **Business Logic Compliance**:
        - [ ] ALL transfers create "TRANSFER" transactions (not IN/OUT)
        - [ ] Operation numbers treated as workflow steps only
        - [ ] Complete audit trail: From Location ‚Üí To Location tracking
        - [ ] Yellow color coding in QuickButtons history
        
        **Integration Requirements**:
        - [ ] QuickButtons integration (field population + history logging)
        - [ ] SuccessOverlay for transfers (Part ID, Operation, From‚ÜíTo Location)
        - [ ] Progress reporting in MainView status bar
        - [ ] ErrorHandling service integration for all error scenarios
        - [ ] CollapsiblePanel auto-behavior (Search=collapse, Reset=expand)
        
        **Performance Requirements**:
        - [ ] Responsive UI during database operations (async patterns)
        - [ ] Efficient DataGrid rendering for large datasets
        - [ ] Smooth panel collapse/expand animations
        - [ ] Real-time quantity validation without performance impact
    validations:
      required: true

  - type: dropdown
    id: testing_requirements
    attributes:
      label: "üß™ Testing Requirements"
      description: "Testing scope and requirements for this feature"
      options:
        - "Integration tests + Manual testing (Recommended for transfers)"
        - "Unit tests + Integration tests + UI automation tests"
        - "Manual testing only"
        - "Unit tests only"
      default: 0
    validations:
      required: true

  - type: textarea
    id: implementation_notes
    attributes:
      label: "üìù Implementation Notes & Considerations"
      description: "Additional technical considerations and implementation guidance"
      value: |
        **Technical Considerations**:
        
        **NumericUpDown Implementation**:
        - Use Avalonia NumericUpDown control with proper styling
        - Implement automatic maximum value based on selected inventory item
        - Real-time validation with visual feedback for invalid quantities
        - Support keyboard input and increment/decrement buttons
        
        **Transfer Business Logic**:
        - Partial transfers: Create new destination record, reduce source quantity
        - Complete transfers: Update location field of existing record
        - Batch transfers: Process multiple items to same destination efficiently
        - Quantity management: Prevent over-transfer scenarios
        
        **ViewModel Integration**:
        - TransferItemViewModel (908 lines) contains complete business logic
        - Connect existing transfer commands to new UI elements
        - Ensure proper data binding for all collections and properties
        - Implement proper disposal patterns for view cleanup
        
        **CollapsiblePanel Behavior**:
        - Auto-collapse on Search: Hide input panel to maximize DataGrid view
        - Auto-expand on Reset: Show input panel for new search configuration
        - Preserve manual user expand state (don't override user preferences)
        - Smooth animations for professional user experience
        
        **Database Operations**:
        - Use existing stored procedures from TransferItemViewModel
        - Ensure proper async patterns to prevent UI blocking
        - Implement progress callbacks for long-running operations
        - Handle database errors gracefully with transaction rollback
        
        **Transaction Type Logic**:
        - CRITICAL: ALL location-to-location moves = "TRANSFER" transactions
        - Operation numbers ("90", "100", "110") are NOT transaction indicators
        - User action (transfer between locations) determines transaction type
        - Complete audit trail with from/to location tracking
        
        **Performance Optimization**:
        - Cache location and part data for SuggestionOverlay responsiveness
        - Implement efficient batch transfer processing
        - Use proper data binding patterns to minimize UI updates
        - Optimize DataGrid rendering for large transfer candidate lists
    validations:
      required: false

  - type: checkboxes
    id: dependencies_integration
    attributes:
      label: "üîó Dependencies & Integration Points"
      description: "Required integrations with existing system components"
      options:
        - label: "TransferItemViewModel (existing 908-line implementation)"
          required: true
        - label: "SuggestionOverlay.cs service integration"
          required: true
        - label: "SuccessOverlayView.axaml display integration"
          required: true
        - label: "QuickButtonsView.axaml panel and history integration"
          required: true
        - label: "MainView.axaml progress bar integration"
          required: true
        - label: "CollapsiblePanel.axaml for input area"
          required: true
        - label: "ErrorHandling service for error management"
          required: true
        - label: "MTM Theme system (19 themes compatibility)"
          required: true

  - type: dropdown
    id: implementation_timeline
    attributes:
      label: "‚è±Ô∏è Estimated Implementation Timeline"
      description: "Expected timeline for complete implementation"
      options:
        - "2-3 weeks (Priority: High - 2nd implementation)"
        - "1-2 weeks"
        - "3-4 weeks"
        - "1-2 months"
      default: 0
    validations:
      required: true

  - type: textarea
    id: additional_requirements
    attributes:
      label: "üìã Additional Requirements or Considerations"
      description: "Any additional requirements, constraints, or implementation considerations"
      placeholder: |
        - Specific transfer workflow requirements
        - Location hierarchy or validation rules
        - Integration with external systems
        - Audit compliance requirements
        - Future enhancement plans for transfer operations
    validations:
      required: false

  - type: checkboxes
    id: final_confirmation
    attributes:
      label: "‚úÖ Implementation Confirmation"
      description: "Final confirmation of requirements understanding"
      options:
        - label: "I confirm this is for TransferTabView (Priority 2nd - High)"
          required: true
        - label: "Dual-panel layout with NumericUpDown quantity control confirmed"
          required: true
        - label: "ALL transfers create 'TRANSFER' transactions confirmed"
          required: true
        - label: "NO ComboBoxes - TextBoxes + SuggestionOverlay confirmed"
          required: true
        - label: "CollapsiblePanel auto-behavior confirmed"
          required: true
        - label: "All integration requirements confirmed"
          required: true
